(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";exports.byteLength=byteLength;exports.toByteArray=toByteArray;exports.fromByteArray=fromByteArray;var lookup=[];var revLookup=[];var Arr=typeof Uint8Array!=="undefined"?Uint8Array:Array;var code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i=0,len=code.length;i<len;++i){lookup[i]=code[i];revLookup[code.charCodeAt(i)]=i}revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function getLens(b64){var len=b64.length;if(len%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var validLen=b64.indexOf("=");if(validLen===-1)validLen=len;var placeHoldersLen=validLen===len?0:4-validLen%4;return[validLen,placeHoldersLen]}function byteLength(b64){var lens=getLens(b64);var validLen=lens[0];var placeHoldersLen=lens[1];return(validLen+placeHoldersLen)*3/4-placeHoldersLen}function _byteLength(b64,validLen,placeHoldersLen){return(validLen+placeHoldersLen)*3/4-placeHoldersLen}function toByteArray(b64){var tmp;var lens=getLens(b64);var validLen=lens[0];var placeHoldersLen=lens[1];var arr=new Arr(_byteLength(b64,validLen,placeHoldersLen));var curByte=0;var len=placeHoldersLen>0?validLen-4:validLen;var i;for(i=0;i<len;i+=4){tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)];arr[curByte++]=tmp>>16&255;arr[curByte++]=tmp>>8&255;arr[curByte++]=tmp&255}if(placeHoldersLen===2){tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4;arr[curByte++]=tmp&255}if(placeHoldersLen===1){tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2;arr[curByte++]=tmp>>8&255;arr[curByte++]=tmp&255}return arr}function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[num&63]}function encodeChunk(uint8,start,end){var tmp;var output=[];for(var i=start;i<end;i+=3){tmp=(uint8[i]<<16&16711680)+(uint8[i+1]<<8&65280)+(uint8[i+2]&255);output.push(tripletToBase64(tmp))}return output.join("")}function fromByteArray(uint8){var tmp;var len=uint8.length;var extraBytes=len%3;var parts=[];var maxChunkLength=16383;for(var i=0,len2=len-extraBytes;i<len2;i+=maxChunkLength){parts.push(encodeChunk(uint8,i,i+maxChunkLength>len2?len2:i+maxChunkLength))}if(extraBytes===1){tmp=uint8[len-1];parts.push(lookup[tmp>>2]+lookup[tmp<<4&63]+"==")}else if(extraBytes===2){tmp=(uint8[len-2]<<8)+uint8[len-1];parts.push(lookup[tmp>>10]+lookup[tmp>>4&63]+lookup[tmp<<2&63]+"=")}return parts.join("")}},{}],2:[function(require,module,exports){(function(Buffer){(function(){"use strict";var base64=require("base64-js");var ieee754=require("ieee754");exports.Buffer=Buffer;exports.SlowBuffer=SlowBuffer;exports.INSPECT_MAX_BYTES=50;var K_MAX_LENGTH=2147483647;exports.kMaxLength=K_MAX_LENGTH;Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport();if(!Buffer.TYPED_ARRAY_SUPPORT&&typeof console!=="undefined"&&typeof console.error==="function"){console.error("This browser lacks typed array (Uint8Array) support which is required by "+"`buffer` v5.x. Use `buffer` v4.x if you require old browser support.")}function typedArraySupport(){try{var arr=new Uint8Array(1);arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return arr.foo()===42}catch(e){return false}}Object.defineProperty(Buffer.prototype,"parent",{enumerable:true,get:function(){if(!Buffer.isBuffer(this))return undefined;return this.buffer}});Object.defineProperty(Buffer.prototype,"offset",{enumerable:true,get:function(){if(!Buffer.isBuffer(this))return undefined;return this.byteOffset}});function createBuffer(length){if(length>K_MAX_LENGTH){throw new RangeError('The value "'+length+'" is invalid for option "size"')}var buf=new Uint8Array(length);buf.__proto__=Buffer.prototype;return buf}function Buffer(arg,encodingOrOffset,length){if(typeof arg==="number"){if(typeof encodingOrOffset==="string"){throw new TypeError('The "string" argument must be of type string. Received type number')}return allocUnsafe(arg)}return from(arg,encodingOrOffset,length)}if(typeof Symbol!=="undefined"&&Symbol.species!=null&&Buffer[Symbol.species]===Buffer){Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:true,enumerable:false,writable:false})}Buffer.poolSize=8192;function from(value,encodingOrOffset,length){if(typeof value==="string"){return fromString(value,encodingOrOffset)}if(ArrayBuffer.isView(value)){return fromArrayLike(value)}if(value==null){throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof value)}if(isInstance(value,ArrayBuffer)||value&&isInstance(value.buffer,ArrayBuffer)){return fromArrayBuffer(value,encodingOrOffset,length)}if(typeof value==="number"){throw new TypeError('The "value" argument must not be of type number. Received type number')}var valueOf=value.valueOf&&value.valueOf();if(valueOf!=null&&valueOf!==value){return Buffer.from(valueOf,encodingOrOffset,length)}var b=fromObject(value);if(b)return b;if(typeof Symbol!=="undefined"&&Symbol.toPrimitive!=null&&typeof value[Symbol.toPrimitive]==="function"){return Buffer.from(value[Symbol.toPrimitive]("string"),encodingOrOffset,length)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, "+"or Array-like Object. Received type "+typeof value)}Buffer.from=function(value,encodingOrOffset,length){return from(value,encodingOrOffset,length)};Buffer.prototype.__proto__=Uint8Array.prototype;Buffer.__proto__=Uint8Array;function assertSize(size){if(typeof size!=="number"){throw new TypeError('"size" argument must be of type number')}else if(size<0){throw new RangeError('The value "'+size+'" is invalid for option "size"')}}function alloc(size,fill,encoding){assertSize(size);if(size<=0){return createBuffer(size)}if(fill!==undefined){return typeof encoding==="string"?createBuffer(size).fill(fill,encoding):createBuffer(size).fill(fill)}return createBuffer(size)}Buffer.alloc=function(size,fill,encoding){return alloc(size,fill,encoding)};function allocUnsafe(size){assertSize(size);return createBuffer(size<0?0:checked(size)|0)}Buffer.allocUnsafe=function(size){return allocUnsafe(size)};Buffer.allocUnsafeSlow=function(size){return allocUnsafe(size)};function fromString(string,encoding){if(typeof encoding!=="string"||encoding===""){encoding="utf8"}if(!Buffer.isEncoding(encoding)){throw new TypeError("Unknown encoding: "+encoding)}var length=byteLength(string,encoding)|0;var buf=createBuffer(length);var actual=buf.write(string,encoding);if(actual!==length){buf=buf.slice(0,actual)}return buf}function fromArrayLike(array){var length=array.length<0?0:checked(array.length)|0;var buf=createBuffer(length);for(var i=0;i<length;i+=1){buf[i]=array[i]&255}return buf}function fromArrayBuffer(array,byteOffset,length){if(byteOffset<0||array.byteLength<byteOffset){throw new RangeError('"offset" is outside of buffer bounds')}if(array.byteLength<byteOffset+(length||0)){throw new RangeError('"length" is outside of buffer bounds')}var buf;if(byteOffset===undefined&&length===undefined){buf=new Uint8Array(array)}else if(length===undefined){buf=new Uint8Array(array,byteOffset)}else{buf=new Uint8Array(array,byteOffset,length)}buf.__proto__=Buffer.prototype;return buf}function fromObject(obj){if(Buffer.isBuffer(obj)){var len=checked(obj.length)|0;var buf=createBuffer(len);if(buf.length===0){return buf}obj.copy(buf,0,0,len);return buf}if(obj.length!==undefined){if(typeof obj.length!=="number"||numberIsNaN(obj.length)){return createBuffer(0)}return fromArrayLike(obj)}if(obj.type==="Buffer"&&Array.isArray(obj.data)){return fromArrayLike(obj.data)}}function checked(length){if(length>=K_MAX_LENGTH){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+K_MAX_LENGTH.toString(16)+" bytes")}return length|0}function SlowBuffer(length){if(+length!=length){length=0}return Buffer.alloc(+length)}Buffer.isBuffer=function isBuffer(b){return b!=null&&b._isBuffer===true&&b!==Buffer.prototype};Buffer.compare=function compare(a,b){if(isInstance(a,Uint8Array))a=Buffer.from(a,a.offset,a.byteLength);if(isInstance(b,Uint8Array))b=Buffer.from(b,b.offset,b.byteLength);if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b)){throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array')}if(a===b)return 0;var x=a.length;var y=b.length;for(var i=0,len=Math.min(x,y);i<len;++i){if(a[i]!==b[i]){x=a[i];y=b[i];break}}if(x<y)return-1;if(y<x)return 1;return 0};Buffer.isEncoding=function isEncoding(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};Buffer.concat=function concat(list,length){if(!Array.isArray(list)){throw new TypeError('"list" argument must be an Array of Buffers')}if(list.length===0){return Buffer.alloc(0)}var i;if(length===undefined){length=0;for(i=0;i<list.length;++i){length+=list[i].length}}var buffer=Buffer.allocUnsafe(length);var pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(isInstance(buf,Uint8Array)){buf=Buffer.from(buf)}if(!Buffer.isBuffer(buf)){throw new TypeError('"list" argument must be an Array of Buffers')}buf.copy(buffer,pos);pos+=buf.length}return buffer};function byteLength(string,encoding){if(Buffer.isBuffer(string)){return string.length}if(ArrayBuffer.isView(string)||isInstance(string,ArrayBuffer)){return string.byteLength}if(typeof string!=="string"){throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. '+"Received type "+typeof string)}var len=string.length;var mustMatch=arguments.length>2&&arguments[2]===true;if(!mustMatch&&len===0)return 0;var loweredCase=false;for(;;){switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return len*2;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase){return mustMatch?-1:utf8ToBytes(string).length}encoding=(""+encoding).toLowerCase();loweredCase=true}}}Buffer.byteLength=byteLength;function slowToString(encoding,start,end){var loweredCase=false;if(start===undefined||start<0){start=0}if(start>this.length){return""}if(end===undefined||end>this.length){end=this.length}if(end<=0){return""}end>>>=0;start>>>=0;if(end<=start){return""}if(!encoding)encoding="utf8";while(true){switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase();loweredCase=true}}}Buffer.prototype._isBuffer=true;function swap(b,n,m){var i=b[n];b[n]=b[m];b[m]=i}Buffer.prototype.swap16=function swap16(){var len=this.length;if(len%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var i=0;i<len;i+=2){swap(this,i,i+1)}return this};Buffer.prototype.swap32=function swap32(){var len=this.length;if(len%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var i=0;i<len;i+=4){swap(this,i,i+3);swap(this,i+1,i+2)}return this};Buffer.prototype.swap64=function swap64(){var len=this.length;if(len%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var i=0;i<len;i+=8){swap(this,i,i+7);swap(this,i+1,i+6);swap(this,i+2,i+5);swap(this,i+3,i+4)}return this};Buffer.prototype.toString=function toString(){var length=this.length;if(length===0)return"";if(arguments.length===0)return utf8Slice(this,0,length);return slowToString.apply(this,arguments)};Buffer.prototype.toLocaleString=Buffer.prototype.toString;Buffer.prototype.equals=function equals(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");if(this===b)return true;return Buffer.compare(this,b)===0};Buffer.prototype.inspect=function inspect(){var str="";var max=exports.INSPECT_MAX_BYTES;str=this.toString("hex",0,max).replace(/(.{2})/g,"$1 ").trim();if(this.length>max)str+=" ... ";return"<Buffer "+str+">"};Buffer.prototype.compare=function compare(target,start,end,thisStart,thisEnd){if(isInstance(target,Uint8Array)){target=Buffer.from(target,target.offset,target.byteLength)}if(!Buffer.isBuffer(target)){throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. '+"Received type "+typeof target)}if(start===undefined){start=0}if(end===undefined){end=target?target.length:0}if(thisStart===undefined){thisStart=0}if(thisEnd===undefined){thisEnd=this.length}if(start<0||end>target.length||thisStart<0||thisEnd>this.length){throw new RangeError("out of range index")}if(thisStart>=thisEnd&&start>=end){return 0}if(thisStart>=thisEnd){return-1}if(start>=end){return 1}start>>>=0;end>>>=0;thisStart>>>=0;thisEnd>>>=0;if(this===target)return 0;var x=thisEnd-thisStart;var y=end-start;var len=Math.min(x,y);var thisCopy=this.slice(thisStart,thisEnd);var targetCopy=target.slice(start,end);for(var i=0;i<len;++i){if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i];y=targetCopy[i];break}}if(x<y)return-1;if(y<x)return 1;return 0};function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(buffer.length===0)return-1;if(typeof byteOffset==="string"){encoding=byteOffset;byteOffset=0}else if(byteOffset>2147483647){byteOffset=2147483647}else if(byteOffset<-2147483648){byteOffset=-2147483648}byteOffset=+byteOffset;if(numberIsNaN(byteOffset)){byteOffset=dir?0:buffer.length-1}if(byteOffset<0)byteOffset=buffer.length+byteOffset;if(byteOffset>=buffer.length){if(dir)return-1;else byteOffset=buffer.length-1}else if(byteOffset<0){if(dir)byteOffset=0;else return-1}if(typeof val==="string"){val=Buffer.from(val,encoding)}if(Buffer.isBuffer(val)){if(val.length===0){return-1}return arrayIndexOf(buffer,val,byteOffset,encoding,dir)}else if(typeof val==="number"){val=val&255;if(typeof Uint8Array.prototype.indexOf==="function"){if(dir){return Uint8Array.prototype.indexOf.call(buffer,val,byteOffset)}else{return Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset)}}return arrayIndexOf(buffer,[val],byteOffset,encoding,dir)}throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){var indexSize=1;var arrLength=arr.length;var valLength=val.length;if(encoding!==undefined){encoding=String(encoding).toLowerCase();if(encoding==="ucs2"||encoding==="ucs-2"||encoding==="utf16le"||encoding==="utf-16le"){if(arr.length<2||val.length<2){return-1}indexSize=2;arrLength/=2;valLength/=2;byteOffset/=2}}function read(buf,i){if(indexSize===1){return buf[i]}else{return buf.readUInt16BE(i*indexSize)}}var i;if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++){if(read(arr,i)===read(val,foundIndex===-1?0:i-foundIndex)){if(foundIndex===-1)foundIndex=i;if(i-foundIndex+1===valLength)return foundIndex*indexSize}else{if(foundIndex!==-1)i-=i-foundIndex;foundIndex=-1}}}else{if(byteOffset+valLength>arrLength)byteOffset=arrLength-valLength;for(i=byteOffset;i>=0;i--){var found=true;for(var j=0;j<valLength;j++){if(read(arr,i+j)!==read(val,j)){found=false;break}}if(found)return i}}return-1}Buffer.prototype.includes=function includes(val,byteOffset,encoding){return this.indexOf(val,byteOffset,encoding)!==-1};Buffer.prototype.indexOf=function indexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,true)};Buffer.prototype.lastIndexOf=function lastIndexOf(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,false)};function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;if(!length){length=remaining}else{length=Number(length);if(length>remaining){length=remaining}}var strLen=string.length;if(length>strLen/2){length=strLen/2}for(var i=0;i<length;++i){var parsed=parseInt(string.substr(i*2,2),16);if(numberIsNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}Buffer.prototype.write=function write(string,offset,length,encoding){if(offset===undefined){encoding="utf8";length=this.length;offset=0}else if(length===undefined&&typeof offset==="string"){encoding=offset;length=this.length;offset=0}else if(isFinite(offset)){offset=offset>>>0;if(isFinite(length)){length=length>>>0;if(encoding===undefined)encoding="utf8"}else{encoding=length;length=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var remaining=this.length-offset;if(length===undefined||length>remaining)length=remaining;if(string.length>0&&(length<0||offset<0)||offset>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!encoding)encoding="utf8";var loweredCase=false;for(;;){switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase();loweredCase=true}}};Buffer.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function base64Slice(buf,start,end){if(start===0&&end===buf.length){return base64.fromByteArray(buf)}else{return base64.fromByteArray(buf.slice(start,end))}}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);var res=[];var i=start;while(i<end){var firstByte=buf[i];var codePoint=null;var bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:if(firstByte<128){codePoint=firstByte}break;case 2:secondByte=buf[i+1];if((secondByte&192)===128){tempCodePoint=(firstByte&31)<<6|secondByte&63;if(tempCodePoint>127){codePoint=tempCodePoint}}break;case 3:secondByte=buf[i+1];thirdByte=buf[i+2];if((secondByte&192)===128&&(thirdByte&192)===128){tempCodePoint=(firstByte&15)<<12|(secondByte&63)<<6|thirdByte&63;if(tempCodePoint>2047&&(tempCodePoint<55296||tempCodePoint>57343)){codePoint=tempCodePoint}}break;case 4:secondByte=buf[i+1];thirdByte=buf[i+2];fourthByte=buf[i+3];if((secondByte&192)===128&&(thirdByte&192)===128&&(fourthByte&192)===128){tempCodePoint=(firstByte&15)<<18|(secondByte&63)<<12|(thirdByte&63)<<6|fourthByte&63;if(tempCodePoint>65535&&tempCodePoint<1114112){codePoint=tempCodePoint}}}}if(codePoint===null){codePoint=65533;bytesPerSequence=1}else if(codePoint>65535){codePoint-=65536;res.push(codePoint>>>10&1023|55296);codePoint=56320|codePoint&1023}res.push(codePoint);i+=bytesPerSequence}return decodeCodePointsArray(res)}var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH){return String.fromCharCode.apply(String,codePoints)}var res="";var i=0;while(i<len){res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH))}return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i]&127)}return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i){ret+=String.fromCharCode(buf[i])}return ret}function hexSlice(buf,start,end){var len=buf.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i=start;i<end;++i){out+=toHex(buf[i])}return out}function utf16leSlice(buf,start,end){var bytes=buf.slice(start,end);var res="";for(var i=0;i<bytes.length;i+=2){res+=String.fromCharCode(bytes[i]+bytes[i+1]*256)}return res}Buffer.prototype.slice=function slice(start,end){var len=this.length;start=~~start;end=end===undefined?len:~~end;if(start<0){start+=len;if(start<0)start=0}else if(start>len){start=len}if(end<0){end+=len;if(end<0)end=0}else if(end>len){end=len}if(end<start)end=start;var newBuf=this.subarray(start,end);newBuf.__proto__=Buffer.prototype;return newBuf};function checkOffset(offset,ext,length){if(offset%1!==0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}Buffer.prototype.readUIntLE=function readUIntLE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}return val};Buffer.prototype.readUIntBE=function readUIntBE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){checkOffset(offset,byteLength,this.length)}var val=this[offset+--byteLength];var mul=1;while(byteLength>0&&(mul*=256)){val+=this[offset+--byteLength]*mul}return val};Buffer.prototype.readUInt8=function readUInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);return this[offset]};Buffer.prototype.readUInt16LE=function readUInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]|this[offset+1]<<8};Buffer.prototype.readUInt16BE=function readUInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);return this[offset]<<8|this[offset+1]};Buffer.prototype.readUInt32LE=function readUInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+this[offset+3]*16777216};Buffer.prototype.readUInt32BE=function readUInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]*16777216+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])};Buffer.prototype.readIntLE=function readIntLE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256)){val+=this[offset+i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readIntBE=function readIntBE(offset,byteLength,noAssert){offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert)checkOffset(offset,byteLength,this.length);var i=byteLength;var mul=1;var val=this[offset+--i];while(i>0&&(mul*=256)){val+=this[offset+--i]*mul}mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readInt8=function readInt8(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,1,this.length);if(!(this[offset]&128))return this[offset];return(255-this[offset]+1)*-1};Buffer.prototype.readInt16LE=function readInt16LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt16BE=function readInt16BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt32LE=function readInt32LE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24};Buffer.prototype.readInt32BE=function readInt32BE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]};Buffer.prototype.readFloatLE=function readFloatLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,true,23,4)};Buffer.prototype.readFloatBE=function readFloatBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,false,23,4)};Buffer.prototype.readDoubleLE=function readDoubleLE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,true,52,8)};Buffer.prototype.readDoubleBE=function readDoubleBE(offset,noAssert){offset=offset>>>0;if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,false,52,8)};function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}Buffer.prototype.writeUIntLE=function writeUIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0)}var mul=1;var i=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUIntBE=function writeUIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;byteLength=byteLength>>>0;if(!noAssert){var maxBytes=Math.pow(2,8*byteLength)-1;checkInt(this,value,offset,byteLength,maxBytes,0)}var i=byteLength-1;var mul=1;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){this[offset+i]=value/mul&255}return offset+byteLength};Buffer.prototype.writeUInt8=function writeUInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,255,0);this[offset]=value&255;return offset+1};Buffer.prototype.writeUInt16LE=function writeUInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2};Buffer.prototype.writeUInt16BE=function writeUInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,65535,0);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2};Buffer.prototype.writeUInt32LE=function writeUInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset+3]=value>>>24;this[offset+2]=value>>>16;this[offset+1]=value>>>8;this[offset]=value&255;return offset+4};Buffer.prototype.writeUInt32BE=function writeUInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4};Buffer.prototype.writeIntLE=function writeIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0;var mul=1;var sub=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256)){if(value<0&&sub===0&&this[offset+i-1]!==0){sub=1}this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeIntBE=function writeIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset>>>0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1;var mul=1;var sub=0;this[offset+i]=value&255;while(--i>=0&&(mul*=256)){if(value<0&&sub===0&&this[offset+i+1]!==0){sub=1}this[offset+i]=(value/mul>>0)-sub&255}return offset+byteLength};Buffer.prototype.writeInt8=function writeInt8(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,1,127,-128);if(value<0)value=255+value+1;this[offset]=value&255;return offset+1};Buffer.prototype.writeInt16LE=function writeInt16LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value&255;this[offset+1]=value>>>8;return offset+2};Buffer.prototype.writeInt16BE=function writeInt16BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);this[offset]=value>>>8;this[offset+1]=value&255;return offset+2};Buffer.prototype.writeInt32LE=function writeInt32LE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);this[offset]=value&255;this[offset+1]=value>>>8;this[offset+2]=value>>>16;this[offset+3]=value>>>24;return offset+4};Buffer.prototype.writeInt32BE=function writeInt32BE(value,offset,noAssert){value=+value;offset=offset>>>0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(value<0)value=4294967295+value+1;this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255;return offset+4};function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,4,34028234663852886e22,-34028234663852886e22)}ieee754.write(buf,value,offset,littleEndian,23,4);return offset+4}Buffer.prototype.writeFloatLE=function writeFloatLE(value,offset,noAssert){return writeFloat(this,value,offset,true,noAssert)};Buffer.prototype.writeFloatBE=function writeFloatBE(value,offset,noAssert){return writeFloat(this,value,offset,false,noAssert)};function writeDouble(buf,value,offset,littleEndian,noAssert){value=+value;offset=offset>>>0;if(!noAssert){checkIEEE754(buf,value,offset,8,17976931348623157e292,-17976931348623157e292)}ieee754.write(buf,value,offset,littleEndian,52,8);return offset+8}Buffer.prototype.writeDoubleLE=function writeDoubleLE(value,offset,noAssert){return writeDouble(this,value,offset,true,noAssert)};Buffer.prototype.writeDoubleBE=function writeDoubleBE(value,offset,noAssert){return writeDouble(this,value,offset,false,noAssert)};Buffer.prototype.copy=function copy(target,targetStart,start,end){if(!Buffer.isBuffer(target))throw new TypeError("argument should be a Buffer");if(!start)start=0;if(!end&&end!==0)end=this.length;if(targetStart>=target.length)targetStart=target.length;if(!targetStart)targetStart=0;if(end>0&&end<start)end=start;if(end===start)return 0;if(target.length===0||this.length===0)return 0;if(targetStart<0){throw new RangeError("targetStart out of bounds")}if(start<0||start>=this.length)throw new RangeError("Index out of range");if(end<0)throw new RangeError("sourceEnd out of bounds");if(end>this.length)end=this.length;if(target.length-targetStart<end-start){end=target.length-targetStart+start}var len=end-start;if(this===target&&typeof Uint8Array.prototype.copyWithin==="function"){this.copyWithin(targetStart,start,end)}else if(this===target&&start<targetStart&&targetStart<end){for(var i=len-1;i>=0;--i){target[i+targetStart]=this[i+start]}}else{Uint8Array.prototype.set.call(target,this.subarray(start,end),targetStart)}return len};Buffer.prototype.fill=function fill(val,start,end,encoding){if(typeof val==="string"){if(typeof start==="string"){encoding=start;start=0;end=this.length}else if(typeof end==="string"){encoding=end;end=this.length}if(encoding!==undefined&&typeof encoding!=="string"){throw new TypeError("encoding must be a string")}if(typeof encoding==="string"&&!Buffer.isEncoding(encoding)){throw new TypeError("Unknown encoding: "+encoding)}if(val.length===1){var code=val.charCodeAt(0);if(encoding==="utf8"&&code<128||encoding==="latin1"){val=code}}}else if(typeof val==="number"){val=val&255}if(start<0||this.length<start||this.length<end){throw new RangeError("Out of range index")}if(end<=start){return this}start=start>>>0;end=end===undefined?this.length:end>>>0;if(!val)val=0;var i;if(typeof val==="number"){for(i=start;i<end;++i){this[i]=val}}else{var bytes=Buffer.isBuffer(val)?val:Buffer.from(val,encoding);var len=bytes.length;if(len===0){throw new TypeError('The value "'+val+'" is invalid for argument "value"')}for(i=0;i<end-start;++i){this[i+start]=bytes[i%len]}}return this};var INVALID_BASE64_RE=/[^+/0-9A-Za-z-_]/g;function base64clean(str){str=str.split("=")[0];str=str.trim().replace(INVALID_BASE64_RE,"");if(str.length<2)return"";while(str.length%4!==0){str=str+"="}return str}function toHex(n){if(n<16)return"0"+n.toString(16);return n.toString(16)}function utf8ToBytes(string,units){units=units||Infinity;var codePoint;var length=string.length;var leadSurrogate=null;var bytes=[];for(var i=0;i<length;++i){codePoint=string.charCodeAt(i);if(codePoint>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){if((units-=3)>-1)bytes.push(239,191,189);continue}else if(i+1===length){if((units-=3)>-1)bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){if((units-=3)>-1)bytes.push(239,191,189);leadSurrogate=codePoint;continue}codePoint=(leadSurrogate-55296<<10|codePoint-56320)+65536}else if(leadSurrogate){if((units-=3)>-1)bytes.push(239,191,189)}leadSurrogate=null;if(codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,codePoint&63|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,codePoint&63|128)}else if(codePoint<1114112){if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,codePoint&63|128)}else{throw new Error("Invalid code point")}}return bytes}function asciiToBytes(str){var byteArray=[];for(var i=0;i<str.length;++i){byteArray.push(str.charCodeAt(i)&255)}return byteArray}function utf16leToBytes(str,units){var c,hi,lo;var byteArray=[];for(var i=0;i<str.length;++i){if((units-=2)<0)break;c=str.charCodeAt(i);hi=c>>8;lo=c%256;byteArray.push(lo);byteArray.push(hi)}return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length;++i){if(i+offset>=dst.length||i>=src.length)break;dst[i+offset]=src[i]}return i}function isInstance(obj,type){return obj instanceof type||obj!=null&&obj.constructor!=null&&obj.constructor.name!=null&&obj.constructor.name===type.name}function numberIsNaN(obj){return obj!==obj}}).call(this)}).call(this,require("buffer").Buffer)},{"base64-js":1,buffer:2,ieee754:3}],3:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var nBits=-7;var i=isLE?nBytes-1:0;var d=isLE?-1:1;var s=buffer[offset+i];i+=d;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i],i+=d,nBits-=8){}m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+i],i+=d,nBits-=8){}if(e===0){e=1-eBias}else if(e===eMax){return m?NaN:(s?-1:1)*Infinity}else{m=m+Math.pow(2,mLen);e=e-eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)};exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0;var i=isLE?0:nBytes-1;var d=isLE?1:-1;var s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2}if(e+eBias>=1){value+=rt/c}else{value+=rt*Math.pow(2,1-eBias)}if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0}}for(;mLen>=8;buffer[offset+i]=m&255,i+=d,m/=256,mLen-=8){}e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i]=e&255,i+=d,e/=256,eLen-=8){}buffer[offset+i-d]|=s*128}},{}],4:[function(require,module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[]};process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},{}],5:[function(require,module,exports){const Uppy=require("@uppy/core");const Dashboard=require("@uppy/dashboard");const XHRUpload=require("@uppy/xhr-upload");window.Uppy={Core:Uppy,Dashboard:Dashboard,XHRUpload:XHRUpload}},{"@uppy/core":15,"@uppy/dashboard":34,"@uppy/xhr-upload":82}],6:[function(require,module,exports){module.exports=function prettierBytes(num){if(typeof num!=="number"||isNaN(num)){throw new TypeError("Expected a number, got "+typeof num)}var neg=num<0;var units=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(neg){num=-num}if(num<1){return(neg?"-":"")+num+" B"}var exponent=Math.min(Math.floor(Math.log(num)/Math.log(1024)),units.length-1);num=Number(num/Math.pow(1024,exponent));var unit=units[exponent];if(num>=10||num%1===0){return(neg?"-":"")+num.toFixed(0)+" "+unit}else{return(neg?"-":"")+num.toFixed(1)+" "+unit}}},{}],7:[function(require,module,exports){"use strict";function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}function _wrapNativeSuper(Class){var _cache=typeof Map==="function"?new Map:undefined;_wrapNativeSuper=function _wrapNativeSuper(Class){if(Class===null||!_isNativeFunction(Class))return Class;if(typeof Class!=="function"){throw new TypeError("Super expression must either be null or a function")}if(typeof _cache!=="undefined"){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:false,writable:true,configurable:true}});return _setPrototypeOf(Wrapper,Class)};return _wrapNativeSuper(Class)}function _construct(Parent,args,Class){if(_isNativeReflectConstruct()){_construct=Reflect.construct}else{_construct=function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var Constructor=Function.bind.apply(Parent,a);var instance=new Constructor;if(Class)_setPrototypeOf(instance,Class.prototype);return instance}}return _construct.apply(null,arguments)}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}function _isNativeFunction(fn){return Function.toString.call(fn).indexOf("[native code]")!==-1}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var AuthError=function(_Error){_inheritsLoose(AuthError,_Error);function AuthError(){var _this;_this=_Error.call(this,"Authorization required")||this;_this.name="AuthError";_this.isAuthError=true;return _this}return AuthError}(_wrapNativeSuper(Error));module.exports=AuthError},{}],8:[function(require,module,exports){"use strict";function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}var RequestClient=require("./RequestClient");var tokenStorage=require("./tokenStorage");var _getName=function _getName(id){return id.split("-").map(function(s){return s.charAt(0).toUpperCase()+s.slice(1)}).join(" ")};module.exports=function(_RequestClient){_inheritsLoose(Provider,_RequestClient);function Provider(uppy,opts){var _this;_this=_RequestClient.call(this,uppy,opts)||this;_this.provider=opts.provider;_this.id=_this.provider;_this.name=_this.opts.name||_getName(_this.id);_this.pluginId=_this.opts.pluginId;_this.tokenKey="companion-"+_this.pluginId+"-auth-token";return _this}var _proto=Provider.prototype;_proto.headers=function headers(){return Promise.all([_RequestClient.prototype.headers.call(this),this.getAuthToken()]).then(function(_ref){var headers=_ref[0],token=_ref[1];return _extends({},headers,{"uppy-auth-token":token})})};_proto.onReceiveResponse=function onReceiveResponse(response){response=_RequestClient.prototype.onReceiveResponse.call(this,response);var plugin=this.uppy.getPlugin(this.pluginId);var oldAuthenticated=plugin.getPluginState().authenticated;var authenticated=oldAuthenticated?response.status!==401:response.status<400;plugin.setPluginState({authenticated:authenticated});return response};_proto.setAuthToken=function setAuthToken(token){return this.uppy.getPlugin(this.pluginId).storage.setItem(this.tokenKey,token)};_proto.getAuthToken=function getAuthToken(){return this.uppy.getPlugin(this.pluginId).storage.getItem(this.tokenKey)};_proto.authUrl=function authUrl(){return this.hostname+"/"+this.id+"/connect"};_proto.fileUrl=function fileUrl(id){return this.hostname+"/"+this.id+"/get/"+id};_proto.list=function list(directory){return this.get(this.id+"/list/"+(directory||""))};_proto.logout=function logout(){var _this2=this;return this.get(this.id+"/logout").then(function(response){return Promise.all([response,_this2.uppy.getPlugin(_this2.pluginId).storage.removeItem(_this2.tokenKey)])}).then(function(_ref2){var response=_ref2[0];return response})};Provider.initPlugin=function initPlugin(plugin,opts,defaultOpts){plugin.type="acquirer";plugin.files=[];if(defaultOpts){plugin.opts=_extends({},defaultOpts,opts)}if(opts.serverUrl||opts.serverPattern){throw new Error("`serverUrl` and `serverPattern` have been renamed to `companionUrl` and `companionAllowedHosts` respectively in the 0.30.5 release. Please consult the docs (for example, https://uppy.io/docs/instagram/ for the Instagram plugin) and use the updated options.`")}if(opts.companionAllowedHosts){var pattern=opts.companionAllowedHosts;if(typeof pattern!=="string"&&!Array.isArray(pattern)&&!(pattern instanceof RegExp)){throw new TypeError(plugin.id+': the option "companionAllowedHosts" must be one of string, Array, RegExp')}plugin.opts.companionAllowedHosts=pattern}else{if(/^(?!https?:\/\/).*$/i.test(opts.companionUrl)){plugin.opts.companionAllowedHosts="https://"+opts.companionUrl.replace(/^\/\//,"")}else{plugin.opts.companionAllowedHosts=opts.companionUrl}}plugin.storage=plugin.opts.storage||tokenStorage};return Provider}(RequestClient)},{"./RequestClient":9,"./tokenStorage":13}],9:[function(require,module,exports){"use strict";var _class,_temp;function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var AuthError=require("./AuthError");var fetchWithNetworkError=require("@uppy/utils/lib/fetchWithNetworkError");function stripSlash(url){return url.replace(/\/$/,"")}module.exports=(_temp=_class=function(){function RequestClient(uppy,opts){this.uppy=uppy;this.opts=opts;this.onReceiveResponse=this.onReceiveResponse.bind(this);this.allowedHeaders=["accept","content-type","uppy-auth-token"];this.preflightDone=false}var _proto=RequestClient.prototype;_proto.headers=function headers(){var userHeaders=this.opts.companionHeaders||this.opts.serverHeaders||{};return Promise.resolve(_extends({},this.defaultHeaders,userHeaders))};_proto._getPostResponseFunc=function _getPostResponseFunc(skip){var _this=this;return function(response){if(!skip){return _this.onReceiveResponse(response)}return response}};_proto.onReceiveResponse=function onReceiveResponse(response){var state=this.uppy.getState();var companion=state.companion||{};var host=this.opts.companionUrl;var headers=response.headers;if(headers.has("i-am")&&headers.get("i-am")!==companion[host]){var _extends2;this.uppy.setState({companion:_extends({},companion,(_extends2={},_extends2[host]=headers.get("i-am"),_extends2))})}return response};_proto._getUrl=function _getUrl(url){if(/^(https?:|)\/\//.test(url)){return url}return this.hostname+"/"+url};_proto._json=function _json(res){if(res.status===401){throw new AuthError}if(res.status<200||res.status>300){var errMsg="Failed request with status: "+res.status+". "+res.statusText;return res.json().then(function(errData){errMsg=errData.message?errMsg+" message: "+errData.message:errMsg;errMsg=errData.requestId?errMsg+" request-Id: "+errData.requestId:errMsg;throw new Error(errMsg)}).catch(function(){throw new Error(errMsg)})}return res.json()};_proto.preflight=function preflight(path){var _this2=this;if(this.preflightDone){return Promise.resolve(this.allowedHeaders.slice())}return fetch(this._getUrl(path),{method:"OPTIONS"}).then(function(response){if(response.headers.has("access-control-allow-headers")){_this2.allowedHeaders=response.headers.get("access-control-allow-headers").split(",").map(function(headerName){return headerName.trim().toLowerCase()})}_this2.preflightDone=true;return _this2.allowedHeaders.slice()}).catch(function(err){_this2.uppy.log("[CompanionClient] unable to make preflight request "+err,"warning");_this2.preflightDone=true;return _this2.allowedHeaders.slice()})};_proto.preflightAndHeaders=function preflightAndHeaders(path){var _this3=this;return Promise.all([this.preflight(path),this.headers()]).then(function(_ref){var allowedHeaders=_ref[0],headers=_ref[1];Object.keys(headers).forEach(function(header){if(allowedHeaders.indexOf(header.toLowerCase())===-1){_this3.uppy.log("[CompanionClient] excluding unallowed header "+header);delete headers[header]}});return headers})};_proto.get=function get(path,skipPostResponse){var _this4=this;return this.preflightAndHeaders(path).then(function(headers){return fetchWithNetworkError(_this4._getUrl(path),{method:"get",headers:headers,credentials:"same-origin"})}).then(this._getPostResponseFunc(skipPostResponse)).then(function(res){return _this4._json(res)}).catch(function(err){err=err.isAuthError?err:new Error("Could not get "+_this4._getUrl(path)+". "+err);return Promise.reject(err)})};_proto.post=function post(path,data,skipPostResponse){var _this5=this;return this.preflightAndHeaders(path).then(function(headers){return fetchWithNetworkError(_this5._getUrl(path),{method:"post",headers:headers,credentials:"same-origin",body:JSON.stringify(data)})}).then(this._getPostResponseFunc(skipPostResponse)).then(function(res){return _this5._json(res)}).catch(function(err){err=err.isAuthError?err:new Error("Could not post "+_this5._getUrl(path)+". "+err);return Promise.reject(err)})};_proto.delete=function _delete(path,data,skipPostResponse){var _this6=this;return this.preflightAndHeaders(path).then(function(headers){return fetchWithNetworkError(_this6.hostname+"/"+path,{method:"delete",headers:headers,credentials:"same-origin",body:data?JSON.stringify(data):null})}).then(this._getPostResponseFunc(skipPostResponse)).then(function(res){return _this6._json(res)}).catch(function(err){err=err.isAuthError?err:new Error("Could not delete "+_this6._getUrl(path)+". "+err);return Promise.reject(err)})};_createClass(RequestClient,[{key:"hostname",get:function get(){var _this$uppy$getState=this.uppy.getState(),companion=_this$uppy$getState.companion;var host=this.opts.companionUrl;return stripSlash(companion&&companion[host]?companion[host]:host)}},{key:"defaultHeaders",get:function get(){return{Accept:"application/json","Content-Type":"application/json","Uppy-Versions":"@uppy/companion-client="+RequestClient.VERSION}}}]);return RequestClient}(),_class.VERSION="1.7.0",_temp)},{"./AuthError":7,"@uppy/utils/lib/fetchWithNetworkError":55}],10:[function(require,module,exports){"use strict";function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}var RequestClient=require("./RequestClient");var _getName=function _getName(id){return id.split("-").map(function(s){return s.charAt(0).toUpperCase()+s.slice(1)}).join(" ")};module.exports=function(_RequestClient){_inheritsLoose(SearchProvider,_RequestClient);function SearchProvider(uppy,opts){var _this;_this=_RequestClient.call(this,uppy,opts)||this;_this.provider=opts.provider;_this.id=_this.provider;_this.name=_this.opts.name||_getName(_this.id);_this.pluginId=_this.opts.pluginId;return _this}var _proto=SearchProvider.prototype;_proto.fileUrl=function fileUrl(id){return this.hostname+"/search/"+this.id+"/get/"+id};_proto.search=function search(text,queries){queries=queries?"&"+queries:"";return this.get("search/"+this.id+"/list?q="+encodeURIComponent(text)+queries)};return SearchProvider}(RequestClient)},{"./RequestClient":9}],11:[function(require,module,exports){var ee=require("namespace-emitter");module.exports=function(){function UppySocket(opts){this.opts=opts;this._queued=[];this.isOpen=false;this.emitter=ee();this._handleMessage=this._handleMessage.bind(this);this.close=this.close.bind(this);this.emit=this.emit.bind(this);this.on=this.on.bind(this);this.once=this.once.bind(this);this.send=this.send.bind(this);if(!opts||opts.autoOpen!==false){this.open()}}var _proto=UppySocket.prototype;_proto.open=function open(){var _this=this;this.socket=new WebSocket(this.opts.target);this.socket.onopen=function(e){_this.isOpen=true;while(_this._queued.length>0&&_this.isOpen){var first=_this._queued[0];_this.send(first.action,first.payload);_this._queued=_this._queued.slice(1)}};this.socket.onclose=function(e){_this.isOpen=false};this.socket.onmessage=this._handleMessage};_proto.close=function close(){if(this.socket){this.socket.close()}};_proto.send=function send(action,payload){if(!this.isOpen){this._queued.push({action:action,payload:payload});return}this.socket.send(JSON.stringify({action:action,payload:payload}))};_proto.on=function on(action,handler){this.emitter.on(action,handler)};_proto.emit=function emit(action,payload){this.emitter.emit(action,payload)};_proto.once=function once(action,handler){this.emitter.once(action,handler)};_proto._handleMessage=function _handleMessage(e){try{var message=JSON.parse(e.data);this.emit(message.action,message.payload)}catch(err){console.log(err)}};return UppySocket}()},{"namespace-emitter":95}],12:[function(require,module,exports){"use strict";var RequestClient=require("./RequestClient");var Provider=require("./Provider");var SearchProvider=require("./SearchProvider");var Socket=require("./Socket");module.exports={RequestClient:RequestClient,Provider:Provider,SearchProvider:SearchProvider,Socket:Socket}},{"./Provider":8,"./RequestClient":9,"./SearchProvider":10,"./Socket":11}],13:[function(require,module,exports){"use strict";module.exports.setItem=function(key,value){return new Promise(function(resolve){localStorage.setItem(key,value);resolve()})};module.exports.getItem=function(key){return Promise.resolve(localStorage.getItem(key))};module.exports.removeItem=function(key){return new Promise(function(resolve){localStorage.removeItem(key);resolve()})}},{}],14:[function(require,module,exports){function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var preact=require("preact");var findDOMElement=require("@uppy/utils/lib/findDOMElement");function debounce(fn){var calling=null;var latestArgs=null;return function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}latestArgs=args;if(!calling){calling=Promise.resolve().then(function(){calling=null;return fn.apply(void 0,latestArgs)})}return calling}}module.exports=function(){function Plugin(uppy,opts){this.uppy=uppy;this.opts=opts||{};this.update=this.update.bind(this);this.mount=this.mount.bind(this);this.install=this.install.bind(this);this.uninstall=this.uninstall.bind(this)}var _proto=Plugin.prototype;_proto.getPluginState=function getPluginState(){var _this$uppy$getState=this.uppy.getState(),plugins=_this$uppy$getState.plugins;return plugins[this.id]||{}};_proto.setPluginState=function setPluginState(update){var _extends2;var _this$uppy$getState2=this.uppy.getState(),plugins=_this$uppy$getState2.plugins;this.uppy.setState({plugins:_extends({},plugins,(_extends2={},_extends2[this.id]=_extends({},plugins[this.id],update),_extends2))})};_proto.setOptions=function setOptions(newOpts){this.opts=_extends({},this.opts,newOpts);this.setPluginState()};_proto.update=function update(state){if(typeof this.el==="undefined"){return}if(this._updateUI){this._updateUI(state)}};_proto.afterUpdate=function afterUpdate(){};_proto.onMount=function onMount(){};_proto.mount=function mount(target,plugin){var _this=this;var callerPluginName=plugin.id;var targetElement=findDOMElement(target);if(targetElement){this.isTargetDOMEl=true;this.rerender=function(state){if(!_this.uppy.getPlugin(_this.id))return;_this.el=preact.render(_this.render(state),targetElement,_this.el);_this.afterUpdate()};this._updateUI=debounce(this.rerender);this.uppy.log("Installing "+callerPluginName+" to a DOM element '"+target+"'");if(this.opts.replaceTargetContent){targetElement.innerHTML=""}this.el=preact.render(this.render(this.uppy.getState()),targetElement);this.onMount();return this.el}var targetPlugin;if(typeof target==="object"&&target instanceof Plugin){targetPlugin=target}else if(typeof target==="function"){var Target=target;this.uppy.iteratePlugins(function(plugin){if(plugin instanceof Target){targetPlugin=plugin;return false}})}if(targetPlugin){this.uppy.log("Installing "+callerPluginName+" to "+targetPlugin.id);this.parent=targetPlugin;this.el=targetPlugin.addTarget(plugin);this.onMount();return this.el}this.uppy.log("Not installing "+callerPluginName);var message="Invalid target option given to "+callerPluginName+".";if(typeof target==="function"){message+=" The given target is not a Plugin class. "+"Please check that you're not specifying a React Component instead of a plugin. "+"If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: "+"run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly."}else{message+="If you meant to target an HTML element, please make sure that the element exists. "+"Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. "+"(see https://github.com/transloadit/uppy/issues/1042)\n\n"+"If you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct."}throw new Error(message)};_proto.render=function render(state){throw new Error("Extend the render method to add your plugin to a DOM element")};_proto.addTarget=function addTarget(plugin){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")};_proto.unmount=function unmount(){if(this.isTargetDOMEl&&this.el&&this.el.parentNode){this.el.parentNode.removeChild(this.el)}};_proto.install=function install(){};_proto.uninstall=function uninstall(){this.unmount()};return Plugin}()},{"@uppy/utils/lib/findDOMElement":57,preact:96}],15:[function(require,module,exports){function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}function _wrapNativeSuper(Class){var _cache=typeof Map==="function"?new Map:undefined;_wrapNativeSuper=function _wrapNativeSuper(Class){if(Class===null||!_isNativeFunction(Class))return Class;if(typeof Class!=="function"){throw new TypeError("Super expression must either be null or a function")}if(typeof _cache!=="undefined"){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:false,writable:true,configurable:true}});return _setPrototypeOf(Wrapper,Class)};return _wrapNativeSuper(Class)}function _construct(Parent,args,Class){if(_isNativeReflectConstruct()){_construct=Reflect.construct}else{_construct=function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var Constructor=Function.bind.apply(Parent,a);var instance=new Constructor;if(Class)_setPrototypeOf(instance,Class.prototype);return instance}}return _construct.apply(null,arguments)}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}function _isNativeFunction(fn){return Function.toString.call(fn).indexOf("[native code]")!==-1}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var Translator=require("@uppy/utils/lib/Translator");var ee=require("namespace-emitter");var cuid=require("cuid");var throttle=require("lodash.throttle");var prettierBytes=require("@transloadit/prettier-bytes");var match=require("mime-match");var DefaultStore=require("@uppy/store-default");var getFileType=require("@uppy/utils/lib/getFileType");var getFileNameAndExtension=require("@uppy/utils/lib/getFileNameAndExtension");var generateFileID=require("@uppy/utils/lib/generateFileID");var supportsUploadProgress=require("./supportsUploadProgress");var _require=require("./loggers"),justErrorsLogger=_require.justErrorsLogger,debugLogger=_require.debugLogger;var Plugin=require("./Plugin");var RestrictionError=function(_Error){_inheritsLoose(RestrictionError,_Error);function RestrictionError(){var _this;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_Error.call.apply(_Error,[this].concat(args))||this;_this.isRestriction=true;return _this}return RestrictionError}(_wrapNativeSuper(Error));var Uppy=function(){function Uppy(opts){var _this2=this;this.defaultLocale={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},exceedsSize2:"%{backwardsCompat} %{size}",exceedsSize:"This file exceeds maximum allowed size of",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noNewAlreadyUploading:"Cannot add new files: already uploading",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},selectAllFilesFromFolderNamed:"Select all files from folder %{name}",unselectAllFilesFromFolderNamed:"Unselect all files from folder %{name}",selectFileNamed:"Select file %{name}",unselectFileNamed:"Unselect file %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",backToSearch:"Back to Search",emptyFolderAdded:"No files were added from empty folder",folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"}}};var defaultOptions={id:"uppy",autoProceed:false,allowMultipleUploads:true,debug:false,restrictions:{maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null},meta:{},onBeforeFileAdded:function onBeforeFileAdded(currentFile,files){return currentFile},onBeforeUpload:function onBeforeUpload(files){return files},store:DefaultStore(),logger:justErrorsLogger,infoTimeout:5e3};this.opts=_extends({},defaultOptions,opts,{restrictions:_extends({},defaultOptions.restrictions,opts&&opts.restrictions)});if(opts&&opts.logger&&opts.debug){this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning")}else if(opts&&opts.debug){this.opts.logger=debugLogger}this.log("Using Core v"+this.constructor.VERSION);if(this.opts.restrictions.allowedFileTypes&&this.opts.restrictions.allowedFileTypes!==null&&!Array.isArray(this.opts.restrictions.allowedFileTypes)){throw new TypeError("`restrictions.allowedFileTypes` must be an array")}this.i18nInit();this.plugins={};this.getState=this.getState.bind(this);this.getPlugin=this.getPlugin.bind(this);this.setFileMeta=this.setFileMeta.bind(this);this.setFileState=this.setFileState.bind(this);this.log=this.log.bind(this);this.info=this.info.bind(this);this.hideInfo=this.hideInfo.bind(this);this.addFile=this.addFile.bind(this);this.removeFile=this.removeFile.bind(this);this.pauseResume=this.pauseResume.bind(this);this.validateRestrictions=this.validateRestrictions.bind(this);this._calculateProgress=throttle(this._calculateProgress.bind(this),500,{leading:true,trailing:true});this.updateOnlineStatus=this.updateOnlineStatus.bind(this);this.resetProgress=this.resetProgress.bind(this);this.pauseAll=this.pauseAll.bind(this);this.resumeAll=this.resumeAll.bind(this);this.retryAll=this.retryAll.bind(this);this.cancelAll=this.cancelAll.bind(this);this.retryUpload=this.retryUpload.bind(this);this.upload=this.upload.bind(this);this.emitter=ee();this.on=this.on.bind(this);this.off=this.off.bind(this);this.once=this.emitter.once.bind(this.emitter);this.emit=this.emitter.emit.bind(this.emitter);this.preProcessors=[];this.uploaders=[];this.postProcessors=[];this.store=this.opts.store;this.setState({plugins:{},files:{},currentUploads:{},allowNewUpload:true,capabilities:{uploadProgress:supportsUploadProgress(),individualCancellation:true,resumableUploads:false},totalProgress:0,meta:_extends({},this.opts.meta),info:{isHidden:true,type:"info",message:""}});this._storeUnsubscribe=this.store.subscribe(function(prevState,nextState,patch){_this2.emit("state-update",prevState,nextState,patch);_this2.updateAll(nextState)});if(this.opts.debug&&typeof window!=="undefined"){window[this.opts.id]=this}this._addListeners()}var _proto=Uppy.prototype;_proto.on=function on(event,callback){this.emitter.on(event,callback);return this};_proto.off=function off(event,callback){this.emitter.off(event,callback);return this};_proto.updateAll=function updateAll(state){this.iteratePlugins(function(plugin){plugin.update(state)})};_proto.setState=function setState(patch){this.store.setState(patch)};_proto.getState=function getState(){return this.store.getState()};_proto.setFileState=function setFileState(fileID,state){var _extends2;if(!this.getState().files[fileID]){throw new Error("Can’t set state for "+fileID+" (the file could have been removed)")}this.setState({files:_extends({},this.getState().files,(_extends2={},_extends2[fileID]=_extends({},this.getState().files[fileID],state),_extends2))})};_proto.i18nInit=function i18nInit(){this.translator=new Translator([this.defaultLocale,this.opts.locale]);this.locale=this.translator.locale;this.i18n=this.translator.translate.bind(this.translator);this.i18nArray=this.translator.translateArray.bind(this.translator)};_proto.setOptions=function setOptions(newOpts){this.opts=_extends({},this.opts,newOpts,{restrictions:_extends({},this.opts.restrictions,newOpts&&newOpts.restrictions)});if(newOpts.meta){this.setMeta(newOpts.meta)}this.i18nInit();if(newOpts.locale){this.iteratePlugins(function(plugin){plugin.setOptions()})}this.setState()};_proto.resetProgress=function resetProgress(){var defaultProgress={percentage:0,bytesUploaded:0,uploadComplete:false,uploadStarted:null};var files=_extends({},this.getState().files);var updatedFiles={};Object.keys(files).forEach(function(fileID){var updatedFile=_extends({},files[fileID]);updatedFile.progress=_extends({},updatedFile.progress,defaultProgress);updatedFiles[fileID]=updatedFile});this.setState({files:updatedFiles,totalProgress:0});this.emit("reset-progress")};_proto.addPreProcessor=function addPreProcessor(fn){this.preProcessors.push(fn)};_proto.removePreProcessor=function removePreProcessor(fn){var i=this.preProcessors.indexOf(fn);if(i!==-1){this.preProcessors.splice(i,1)}};_proto.addPostProcessor=function addPostProcessor(fn){this.postProcessors.push(fn)};_proto.removePostProcessor=function removePostProcessor(fn){var i=this.postProcessors.indexOf(fn);if(i!==-1){this.postProcessors.splice(i,1)}};_proto.addUploader=function addUploader(fn){this.uploaders.push(fn)};_proto.removeUploader=function removeUploader(fn){var i=this.uploaders.indexOf(fn);if(i!==-1){this.uploaders.splice(i,1)}};_proto.setMeta=function setMeta(data){var updatedMeta=_extends({},this.getState().meta,data);var updatedFiles=_extends({},this.getState().files);Object.keys(updatedFiles).forEach(function(fileID){updatedFiles[fileID]=_extends({},updatedFiles[fileID],{meta:_extends({},updatedFiles[fileID].meta,data)})});this.log("Adding metadata:");this.log(data);this.setState({meta:updatedMeta,files:updatedFiles})};_proto.setFileMeta=function setFileMeta(fileID,data){var updatedFiles=_extends({},this.getState().files);if(!updatedFiles[fileID]){this.log("Was trying to set metadata for a file that has been removed: ",fileID);return}var newMeta=_extends({},updatedFiles[fileID].meta,data);updatedFiles[fileID]=_extends({},updatedFiles[fileID],{meta:newMeta});this.setState({files:updatedFiles})};_proto.getFile=function getFile(fileID){return this.getState().files[fileID]};_proto.getFiles=function getFiles(){var _this$getState=this.getState(),files=_this$getState.files;return Object.keys(files).map(function(fileID){return files[fileID]})};_proto.validateRestrictions=function validateRestrictions(file,files){try{this._checkRestrictions(file,files);return{result:true}}catch(err){return{result:false,reason:err.message}}};_proto._checkRestrictions=function _checkRestrictions(file,files){if(files===void 0){files=this.getFiles()}var _this$opts$restrictio=this.opts.restrictions,maxFileSize=_this$opts$restrictio.maxFileSize,minFileSize=_this$opts$restrictio.minFileSize,maxTotalFileSize=_this$opts$restrictio.maxTotalFileSize,maxNumberOfFiles=_this$opts$restrictio.maxNumberOfFiles,allowedFileTypes=_this$opts$restrictio.allowedFileTypes;if(maxNumberOfFiles){if(files.length+1>maxNumberOfFiles){throw new RestrictionError(""+this.i18n("youCanOnlyUploadX",{smart_count:maxNumberOfFiles}))}}if(allowedFileTypes){var isCorrectFileType=allowedFileTypes.some(function(type){if(type.indexOf("/")>-1){if(!file.type)return false;return match(file.type.replace(/;.*?$/,""),type)}if(type[0]==="."&&file.extension){return file.extension.toLowerCase()===type.substr(1).toLowerCase()}return false});if(!isCorrectFileType){var allowedFileTypesString=allowedFileTypes.join(", ");throw new RestrictionError(this.i18n("youCanOnlyUploadFileTypes",{types:allowedFileTypesString}))}}if(maxTotalFileSize&&file.size!=null){var totalFilesSize=0;totalFilesSize+=file.size;files.forEach(function(file){totalFilesSize+=file.size});if(totalFilesSize>maxTotalFileSize){throw new RestrictionError(this.i18n("exceedsSize2",{backwardsCompat:this.i18n("exceedsSize"),size:prettierBytes(maxTotalFileSize)}))}}if(maxFileSize&&file.size!=null){if(file.size>maxFileSize){throw new RestrictionError(this.i18n("exceedsSize2",{backwardsCompat:this.i18n("exceedsSize"),size:prettierBytes(maxFileSize)}))}}if(minFileSize&&file.size!=null){if(file.size<minFileSize){throw new RestrictionError(this.i18n("inferiorSize",{size:prettierBytes(minFileSize)}))}}};_proto._checkMinNumberOfFiles=function _checkMinNumberOfFiles(files){var minNumberOfFiles=this.opts.restrictions.minNumberOfFiles;if(Object.keys(files).length<minNumberOfFiles){throw new RestrictionError(""+this.i18n("youHaveToAtLeastSelectX",{smart_count:minNumberOfFiles}))}};_proto._showOrLogErrorAndThrow=function _showOrLogErrorAndThrow(err,_temp){var _ref=_temp===void 0?{}:_temp,_ref$showInformer=_ref.showInformer,showInformer=_ref$showInformer===void 0?true:_ref$showInformer,_ref$file=_ref.file,file=_ref$file===void 0?null:_ref$file,_ref$throwErr=_ref.throwErr,throwErr=_ref$throwErr===void 0?true:_ref$throwErr;var message=typeof err==="object"?err.message:err;var details=typeof err==="object"&&err.details?err.details:"";var logMessageWithDetails=message;if(details){logMessageWithDetails+=" "+details}if(err.isRestriction){this.log(logMessageWithDetails);this.emit("restriction-failed",file,err)}else{this.log(logMessageWithDetails,"error")}if(showInformer){this.info({message:message,details:details},"error",this.opts.infoTimeout)}if(throwErr){throw typeof err==="object"?err:new Error(err)}};_proto._assertNewUploadAllowed=function _assertNewUploadAllowed(file){var _this$getState2=this.getState(),allowNewUpload=_this$getState2.allowNewUpload;if(allowNewUpload===false){this._showOrLogErrorAndThrow(new RestrictionError(this.i18n("noNewAlreadyUploading")),{file:file})}};_proto._checkAndCreateFileStateObject=function _checkAndCreateFileStateObject(files,file){var fileType=getFileType(file);file.type=fileType;var onBeforeFileAddedResult=this.opts.onBeforeFileAdded(file,files);if(onBeforeFileAddedResult===false){this._showOrLogErrorAndThrow(new RestrictionError("Cannot add the file because onBeforeFileAdded returned false."),{showInformer:false,file:file})}if(typeof onBeforeFileAddedResult==="object"&&onBeforeFileAddedResult){file=onBeforeFileAddedResult}var fileName;if(file.name){fileName=file.name}else if(fileType.split("/")[0]==="image"){fileName=fileType.split("/")[0]+"."+fileType.split("/")[1]}else{fileName="noname"}var fileExtension=getFileNameAndExtension(fileName).extension;var isRemote=file.isRemote||false;var fileID=generateFileID(file);if(files[fileID]){this._showOrLogErrorAndThrow(new RestrictionError(this.i18n("noDuplicates",{fileName:fileName})),{file:file})}var meta=file.meta||{};meta.name=fileName;meta.type=fileType;var size=isFinite(file.data.size)?file.data.size:null;var newFile={source:file.source||"",id:fileID,name:fileName,extension:fileExtension||"",meta:_extends({},this.getState().meta,meta),type:fileType,data:file.data,progress:{percentage:0,bytesUploaded:0,bytesTotal:size,uploadComplete:false,uploadStarted:null},size:size,isRemote:isRemote,remote:file.remote||"",preview:file.preview};try{var filesArray=Object.keys(files).map(function(i){return files[i]});this._checkRestrictions(newFile,filesArray)}catch(err){this._showOrLogErrorAndThrow(err,{file:newFile})}return newFile};_proto._startIfAutoProceed=function _startIfAutoProceed(){var _this3=this;if(this.opts.autoProceed&&!this.scheduledAutoProceed){this.scheduledAutoProceed=setTimeout(function(){_this3.scheduledAutoProceed=null;_this3.upload().catch(function(err){if(!err.isRestriction){_this3.log(err.stack||err.message||err)}})},4)}};_proto.addFile=function addFile(file){var _extends3;this._assertNewUploadAllowed(file);var _this$getState3=this.getState(),files=_this$getState3.files;var newFile=this._checkAndCreateFileStateObject(files,file);this.setState({files:_extends({},files,(_extends3={},_extends3[newFile.id]=newFile,_extends3))});this.emit("file-added",newFile);this.emit("files-added",[newFile]);this.log("Added file: "+newFile.name+", "+newFile.id+", mime type: "+newFile.type);this._startIfAutoProceed();return newFile.id};_proto.addFiles=function addFiles(fileDescriptors){var _this4=this;this._assertNewUploadAllowed();var files=_extends({},this.getState().files);var newFiles=[];var errors=[];for(var i=0;i<fileDescriptors.length;i++){try{var newFile=this._checkAndCreateFileStateObject(files,fileDescriptors[i]);newFiles.push(newFile);files[newFile.id]=newFile}catch(err){if(!err.isRestriction){errors.push(err)}}}this.setState({files:files});newFiles.forEach(function(newFile){_this4.emit("file-added",newFile)});this.emit("files-added",newFiles);if(newFiles.length>5){this.log("Added batch of "+newFiles.length+" files")}else{Object.keys(newFiles).forEach(function(fileID){_this4.log("Added file: "+newFiles[fileID].name+"\n id: "+newFiles[fileID].id+"\n type: "+newFiles[fileID].type)})}if(newFiles.length>0){this._startIfAutoProceed()}if(errors.length>0){var message="Multiple errors occurred while adding files:\n";errors.forEach(function(subError){message+="\n * "+subError.message});this.info({message:this.i18n("addBulkFilesFailed",{smart_count:errors.length}),details:message},"error",this.opts.infoTimeout);var err=new Error(message);err.errors=errors;throw err}};_proto.removeFiles=function removeFiles(fileIDs,reason){var _this5=this;var _this$getState4=this.getState(),files=_this$getState4.files,currentUploads=_this$getState4.currentUploads;var updatedFiles=_extends({},files);var updatedUploads=_extends({},currentUploads);var removedFiles=Object.create(null);fileIDs.forEach(function(fileID){if(files[fileID]){removedFiles[fileID]=files[fileID];delete updatedFiles[fileID]}});function fileIsNotRemoved(uploadFileID){return removedFiles[uploadFileID]===undefined}var uploadsToRemove=[];Object.keys(updatedUploads).forEach(function(uploadID){var newFileIDs=currentUploads[uploadID].fileIDs.filter(fileIsNotRemoved);if(newFileIDs.length===0){uploadsToRemove.push(uploadID);return}updatedUploads[uploadID]=_extends({},currentUploads[uploadID],{fileIDs:newFileIDs})});uploadsToRemove.forEach(function(uploadID){delete updatedUploads[uploadID]});var stateUpdate={currentUploads:updatedUploads,files:updatedFiles};if(Object.keys(updatedFiles).length===0){stateUpdate.allowNewUpload=true;stateUpdate.error=null}this.setState(stateUpdate);this._calculateTotalProgress();var removedFileIDs=Object.keys(removedFiles);removedFileIDs.forEach(function(fileID){_this5.emit("file-removed",removedFiles[fileID],reason)});if(removedFileIDs.length>5){this.log("Removed "+removedFileIDs.length+" files")}else{this.log("Removed files: "+removedFileIDs.join(", "))}};_proto.removeFile=function removeFile(fileID,reason){if(reason===void 0){reason=null}this.removeFiles([fileID],reason)};_proto.pauseResume=function pauseResume(fileID){if(!this.getState().capabilities.resumableUploads||this.getFile(fileID).uploadComplete){return}var wasPaused=this.getFile(fileID).isPaused||false;var isPaused=!wasPaused;this.setFileState(fileID,{isPaused:isPaused});this.emit("upload-pause",fileID,isPaused);return isPaused};_proto.pauseAll=function pauseAll(){var updatedFiles=_extends({},this.getState().files);var inProgressUpdatedFiles=Object.keys(updatedFiles).filter(function(file){return!updatedFiles[file].progress.uploadComplete&&updatedFiles[file].progress.uploadStarted});inProgressUpdatedFiles.forEach(function(file){var updatedFile=_extends({},updatedFiles[file],{isPaused:true});updatedFiles[file]=updatedFile});this.setState({files:updatedFiles});this.emit("pause-all")};_proto.resumeAll=function resumeAll(){var updatedFiles=_extends({},this.getState().files);var inProgressUpdatedFiles=Object.keys(updatedFiles).filter(function(file){return!updatedFiles[file].progress.uploadComplete&&updatedFiles[file].progress.uploadStarted});inProgressUpdatedFiles.forEach(function(file){var updatedFile=_extends({},updatedFiles[file],{isPaused:false,error:null});updatedFiles[file]=updatedFile});this.setState({files:updatedFiles});this.emit("resume-all")};_proto.retryAll=function retryAll(){var updatedFiles=_extends({},this.getState().files);var filesToRetry=Object.keys(updatedFiles).filter(function(file){return updatedFiles[file].error});filesToRetry.forEach(function(file){var updatedFile=_extends({},updatedFiles[file],{isPaused:false,error:null});updatedFiles[file]=updatedFile});this.setState({files:updatedFiles,error:null});this.emit("retry-all",filesToRetry);if(filesToRetry.length===0){return Promise.resolve({successful:[],failed:[]})}var uploadID=this._createUpload(filesToRetry,{forceAllowNewUpload:true});return this._runUpload(uploadID)};_proto.cancelAll=function cancelAll(){this.emit("cancel-all");var _this$getState5=this.getState(),files=_this$getState5.files;var fileIDs=Object.keys(files);if(fileIDs.length){this.removeFiles(fileIDs,"cancel-all")}this.setState({totalProgress:0,error:null})};_proto.retryUpload=function retryUpload(fileID){this.setFileState(fileID,{error:null,isPaused:false});this.emit("upload-retry",fileID);var uploadID=this._createUpload([fileID],{forceAllowNewUpload:true});return this._runUpload(uploadID)};_proto.reset=function reset(){this.cancelAll()};_proto._calculateProgress=function _calculateProgress(file,data){if(!this.getFile(file.id)){this.log("Not setting progress for a file that has been removed: "+file.id);return}var canHavePercentage=isFinite(data.bytesTotal)&&data.bytesTotal>0;this.setFileState(file.id,{progress:_extends({},this.getFile(file.id).progress,{bytesUploaded:data.bytesUploaded,bytesTotal:data.bytesTotal,percentage:canHavePercentage?Math.round(data.bytesUploaded/data.bytesTotal*100):0})});this._calculateTotalProgress()};_proto._calculateTotalProgress=function _calculateTotalProgress(){var files=this.getFiles();var inProgress=files.filter(function(file){return file.progress.uploadStarted||file.progress.preprocess||file.progress.postprocess});if(inProgress.length===0){this.emit("progress",0);this.setState({totalProgress:0});return}var sizedFiles=inProgress.filter(function(file){return file.progress.bytesTotal!=null});var unsizedFiles=inProgress.filter(function(file){return file.progress.bytesTotal==null});if(sizedFiles.length===0){var progressMax=inProgress.length*100;var currentProgress=unsizedFiles.reduce(function(acc,file){return acc+file.progress.percentage},0);var _totalProgress=Math.round(currentProgress/progressMax*100);this.setState({totalProgress:_totalProgress});return}var totalSize=sizedFiles.reduce(function(acc,file){return acc+file.progress.bytesTotal},0);var averageSize=totalSize/sizedFiles.length;totalSize+=averageSize*unsizedFiles.length;var uploadedSize=0;sizedFiles.forEach(function(file){uploadedSize+=file.progress.bytesUploaded});unsizedFiles.forEach(function(file){uploadedSize+=averageSize*(file.progress.percentage||0)/100});var totalProgress=totalSize===0?0:Math.round(uploadedSize/totalSize*100);if(totalProgress>100){totalProgress=100}this.setState({totalProgress:totalProgress});this.emit("progress",totalProgress)};_proto._addListeners=function _addListeners(){var _this6=this;this.on("error",function(error){var errorMsg="Unknown error";if(error.message){errorMsg=error.message}if(error.details){errorMsg+=" "+error.details}_this6.setState({error:errorMsg})});this.on("upload-error",function(file,error,response){var errorMsg="Unknown error";if(error.message){errorMsg=error.message}if(error.details){errorMsg+=" "+error.details}_this6.setFileState(file.id,{error:errorMsg,response:response});_this6.setState({error:error.message});if(typeof error==="object"&&error.message){var newError=new Error(error.message);newError.details=error.message;if(error.details){newError.details+=" "+error.details}newError.message=_this6.i18n("failedToUpload",{file:file.name});_this6._showOrLogErrorAndThrow(newError,{throwErr:false})}else{_this6._showOrLogErrorAndThrow(error,{throwErr:false})}});this.on("upload",function(){_this6.setState({error:null})});this.on("upload-started",function(file,upload){if(!_this6.getFile(file.id)){_this6.log("Not setting progress for a file that has been removed: "+file.id);return}_this6.setFileState(file.id,{progress:{uploadStarted:Date.now(),uploadComplete:false,percentage:0,bytesUploaded:0,bytesTotal:file.size}})});this.on("upload-progress",this._calculateProgress);this.on("upload-success",function(file,uploadResp){if(!_this6.getFile(file.id)){_this6.log("Not setting progress for a file that has been removed: "+file.id);return}var currentProgress=_this6.getFile(file.id).progress;_this6.setFileState(file.id,{progress:_extends({},currentProgress,{postprocess:_this6.postProcessors.length>0?{mode:"indeterminate"}:null,uploadComplete:true,percentage:100,bytesUploaded:currentProgress.bytesTotal}),response:uploadResp,uploadURL:uploadResp.uploadURL,isPaused:false});_this6._calculateTotalProgress()});this.on("preprocess-progress",function(file,progress){if(!_this6.getFile(file.id)){_this6.log("Not setting progress for a file that has been removed: "+file.id);return}_this6.setFileState(file.id,{progress:_extends({},_this6.getFile(file.id).progress,{preprocess:progress})})});this.on("preprocess-complete",function(file){if(!_this6.getFile(file.id)){_this6.log("Not setting progress for a file that has been removed: "+file.id);return}var files=_extends({},_this6.getState().files);files[file.id]=_extends({},files[file.id],{progress:_extends({},files[file.id].progress)});delete files[file.id].progress.preprocess;_this6.setState({files:files})});this.on("postprocess-progress",function(file,progress){if(!_this6.getFile(file.id)){_this6.log("Not setting progress for a file that has been removed: "+file.id);return}_this6.setFileState(file.id,{progress:_extends({},_this6.getState().files[file.id].progress,{postprocess:progress})})});this.on("postprocess-complete",function(file){if(!_this6.getFile(file.id)){_this6.log("Not setting progress for a file that has been removed: "+file.id);return}var files=_extends({},_this6.getState().files);files[file.id]=_extends({},files[file.id],{progress:_extends({},files[file.id].progress)});delete files[file.id].progress.postprocess;_this6.setState({files:files})});this.on("restored",function(){_this6._calculateTotalProgress()});if(typeof window!=="undefined"&&window.addEventListener){window.addEventListener("online",function(){return _this6.updateOnlineStatus()});window.addEventListener("offline",function(){return _this6.updateOnlineStatus()});setTimeout(function(){return _this6.updateOnlineStatus()},3e3)}};_proto.updateOnlineStatus=function updateOnlineStatus(){var online=typeof window.navigator.onLine!=="undefined"?window.navigator.onLine:true;if(!online){this.emit("is-offline");this.info(this.i18n("noInternetConnection"),"error",0);this.wasOffline=true}else{this.emit("is-online");if(this.wasOffline){this.emit("back-online");this.info(this.i18n("connectedToInternet"),"success",3e3);this.wasOffline=false}}};_proto.getID=function getID(){return this.opts.id};_proto.use=function use(Plugin,opts){if(typeof Plugin!=="function"){var msg="Expected a plugin class, but got "+(Plugin===null?"null":typeof Plugin)+"."+" Please verify that the plugin was imported and spelled correctly.";throw new TypeError(msg)}var plugin=new Plugin(this,opts);var pluginId=plugin.id;this.plugins[plugin.type]=this.plugins[plugin.type]||[];if(!pluginId){throw new Error("Your plugin must have an id")}if(!plugin.type){throw new Error("Your plugin must have a type")}var existsPluginAlready=this.getPlugin(pluginId);if(existsPluginAlready){var _msg="Already found a plugin named '"+existsPluginAlready.id+"'. "+("Tried to use: '"+pluginId+"'.\n")+"Uppy plugins must have unique `id` options. See https://uppy.io/docs/plugins/#id.";throw new Error(_msg)}if(Plugin.VERSION){this.log("Using "+pluginId+" v"+Plugin.VERSION)}this.plugins[plugin.type].push(plugin);plugin.install();return this};_proto.getPlugin=function getPlugin(id){var foundPlugin=null;this.iteratePlugins(function(plugin){if(plugin.id===id){foundPlugin=plugin;return false}});return foundPlugin};_proto.iteratePlugins=function iteratePlugins(method){var _this7=this;Object.keys(this.plugins).forEach(function(pluginType){_this7.plugins[pluginType].forEach(method)})};_proto.removePlugin=function removePlugin(instance){this.log("Removing plugin "+instance.id);this.emit("plugin-remove",instance);if(instance.uninstall){instance.uninstall()}var list=this.plugins[instance.type].slice();var index=list.indexOf(instance);if(index!==-1){list.splice(index,1);this.plugins[instance.type]=list}var updatedState=this.getState();delete updatedState.plugins[instance.id];this.setState(updatedState)};_proto.close=function close(){var _this8=this;this.log("Closing Uppy instance "+this.opts.id+": removing all files and uninstalling plugins");this.reset();this._storeUnsubscribe();this.iteratePlugins(function(plugin){_this8.removePlugin(plugin)})};_proto.info=function info(message,type,duration){if(type===void 0){type="info"}if(duration===void 0){duration=3e3}var isComplexMessage=typeof message==="object";this.setState({info:{isHidden:false,type:type,message:isComplexMessage?message.message:message,details:isComplexMessage?message.details:null}});this.emit("info-visible");clearTimeout(this.infoTimeoutID);if(duration===0){this.infoTimeoutID=undefined;return}this.infoTimeoutID=setTimeout(this.hideInfo,duration)};_proto.hideInfo=function hideInfo(){var newInfo=_extends({},this.getState().info,{isHidden:true});this.setState({info:newInfo});this.emit("info-hidden")};_proto.log=function log(message,type){var logger=this.opts.logger;switch(type){case"error":logger.error(message);break;case"warning":logger.warn(message);break;default:logger.debug(message);break}};_proto.run=function run(){this.log("Calling run() is no longer necessary.","warning");return this};_proto.restore=function restore(uploadID){this.log('Core: attempting to restore upload "'+uploadID+'"');if(!this.getState().currentUploads[uploadID]){this._removeUpload(uploadID);return Promise.reject(new Error("Nonexistent upload"))}return this._runUpload(uploadID)};_proto._createUpload=function _createUpload(fileIDs,opts){var _extends4;if(opts===void 0){opts={}}var _opts=opts,_opts$forceAllowNewUp=_opts.forceAllowNewUpload,forceAllowNewUpload=_opts$forceAllowNewUp===void 0?false:_opts$forceAllowNewUp;var _this$getState6=this.getState(),allowNewUpload=_this$getState6.allowNewUpload,currentUploads=_this$getState6.currentUploads;if(!allowNewUpload&&!forceAllowNewUpload){throw new Error("Cannot create a new upload: already uploading.")}var uploadID=cuid();this.emit("upload",{id:uploadID,fileIDs:fileIDs});this.setState({allowNewUpload:this.opts.allowMultipleUploads!==false,currentUploads:_extends({},currentUploads,(_extends4={},_extends4[uploadID]={fileIDs:fileIDs,step:0,result:{}},_extends4))});return uploadID};_proto._getUpload=function _getUpload(uploadID){var _this$getState7=this.getState(),currentUploads=_this$getState7.currentUploads;return currentUploads[uploadID]};_proto.addResultData=function addResultData(uploadID,data){var _extends5;if(!this._getUpload(uploadID)){this.log("Not setting result for an upload that has been removed: "+uploadID);return}var currentUploads=this.getState().currentUploads;var currentUpload=_extends({},currentUploads[uploadID],{result:_extends({},currentUploads[uploadID].result,data)});this.setState({currentUploads:_extends({},currentUploads,(_extends5={},_extends5[uploadID]=currentUpload,_extends5))})};_proto._removeUpload=function _removeUpload(uploadID){var currentUploads=_extends({},this.getState().currentUploads);delete currentUploads[uploadID];this.setState({currentUploads:currentUploads})};_proto._runUpload=function _runUpload(uploadID){var _this9=this;var uploadData=this.getState().currentUploads[uploadID];var restoreStep=uploadData.step;var steps=[].concat(this.preProcessors,this.uploaders,this.postProcessors);var lastStep=Promise.resolve();steps.forEach(function(fn,step){if(step<restoreStep){return}lastStep=lastStep.then(function(){var _extends6;var _this9$getState=_this9.getState(),currentUploads=_this9$getState.currentUploads;var currentUpload=currentUploads[uploadID];if(!currentUpload){return}var updatedUpload=_extends({},currentUpload,{step:step});_this9.setState({currentUploads:_extends({},currentUploads,(_extends6={},_extends6[uploadID]=updatedUpload,_extends6))});return fn(updatedUpload.fileIDs,uploadID)}).then(function(result){return null})});lastStep.catch(function(err){_this9.emit("error",err,uploadID);_this9._removeUpload(uploadID)});return lastStep.then(function(){var _this9$getState2=_this9.getState(),currentUploads=_this9$getState2.currentUploads;var currentUpload=currentUploads[uploadID];if(!currentUpload){return}var files=currentUpload.fileIDs.map(function(fileID){return _this9.getFile(fileID)});var successful=files.filter(function(file){return!file.error});var failed=files.filter(function(file){return file.error});_this9.addResultData(uploadID,{successful:successful,failed:failed,uploadID:uploadID})}).then(function(){var _this9$getState3=_this9.getState(),currentUploads=_this9$getState3.currentUploads;if(!currentUploads[uploadID]){return}var currentUpload=currentUploads[uploadID];var result=currentUpload.result;_this9.emit("complete",result);_this9._removeUpload(uploadID);return result}).then(function(result){if(result==null){_this9.log("Not setting result for an upload that has been removed: "+uploadID)}return result})};_proto.upload=function upload(){var _this10=this;if(!this.plugins.uploader){this.log("No uploader type plugins are used","warning")}var files=this.getState().files;var onBeforeUploadResult=this.opts.onBeforeUpload(files);if(onBeforeUploadResult===false){return Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false"))}if(onBeforeUploadResult&&typeof onBeforeUploadResult==="object"){files=onBeforeUploadResult;this.setState({files:files})}return Promise.resolve().then(function(){return _this10._checkMinNumberOfFiles(files)}).catch(function(err){_this10._showOrLogErrorAndThrow(err)}).then(function(){var _this10$getState=_this10.getState(),currentUploads=_this10$getState.currentUploads;var currentlyUploadingFiles=Object.keys(currentUploads).reduce(function(prev,curr){return prev.concat(currentUploads[curr].fileIDs)},[]);var waitingFileIDs=[];Object.keys(files).forEach(function(fileID){var file=_this10.getFile(fileID);if(!file.progress.uploadStarted&&currentlyUploadingFiles.indexOf(fileID)===-1){waitingFileIDs.push(file.id)}});var uploadID=_this10._createUpload(waitingFileIDs);return _this10._runUpload(uploadID)}).catch(function(err){_this10._showOrLogErrorAndThrow(err,{showInformer:false})})};_createClass(Uppy,[{key:"state",get:function get(){return this.getState()}}]);return Uppy}();Uppy.VERSION="1.15.0";module.exports=function(opts){return new Uppy(opts)};module.exports.Uppy=Uppy;module.exports.Plugin=Plugin;module.exports.debugLogger=debugLogger},{"./Plugin":14,"./loggers":16,"./supportsUploadProgress":17,"@transloadit/prettier-bytes":6,"@uppy/store-default":45,"@uppy/utils/lib/Translator":52,"@uppy/utils/lib/generateFileID":58,"@uppy/utils/lib/getFileNameAndExtension":65,"@uppy/utils/lib/getFileType":66,cuid:84,"lodash.throttle":91,"mime-match":94,"namespace-emitter":95}],16:[function(require,module,exports){var getTimeStamp=require("@uppy/utils/lib/getTimeStamp");var justErrorsLogger={debug:function debug(){},warn:function warn(){},error:function error(){var _console;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return(_console=console).error.apply(_console,["[Uppy] ["+getTimeStamp()+"]"].concat(args))}};var debugLogger={debug:function debug(){var debug=console.debug||console.log;for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++){args[_key2]=arguments[_key2]}debug.call.apply(debug,[console,"[Uppy] ["+getTimeStamp()+"]"].concat(args))},warn:function warn(){var _console2;for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++){args[_key3]=arguments[_key3]}return(_console2=console).warn.apply(_console2,["[Uppy] ["+getTimeStamp()+"]"].concat(args))},error:function error(){var _console3;for(var _len4=arguments.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++){args[_key4]=arguments[_key4]}return(_console3=console).error.apply(_console3,["[Uppy] ["+getTimeStamp()+"]"].concat(args))}};module.exports={justErrorsLogger:justErrorsLogger,debugLogger:debugLogger}},{"@uppy/utils/lib/getTimeStamp":69}],17:[function(require,module,exports){module.exports=function supportsUploadProgress(userAgent){if(userAgent==null){userAgent=typeof navigator!=="undefined"?navigator.userAgent:null}if(!userAgent)return true;var m=/Edge\/(\d+\.\d+)/.exec(userAgent);if(!m)return true;var edgeVersion=m[1];var _edgeVersion$split=edgeVersion.split("."),major=_edgeVersion$split[0],minor=_edgeVersion$split[1];major=parseInt(major,10);minor=parseInt(minor,10);if(major<15||major===15&&minor<15063){return true}if(major>18||major===18&&minor>=18218){return true}return false}},{}],18:[function(require,module,exports){function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}var _require=require("preact"),h=_require.h,Component=_require.Component;var AddFiles=function(_Component){_inheritsLoose(AddFiles,_Component);function AddFiles(){var _this;for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}_this=_Component.call.apply(_Component,[this].concat(args))||this;_this.triggerFileInputClick=function(){_this.fileInput.click()};_this.triggerFolderInputClick=function(){_this.folderInput.click()};_this.onFileInputChange=function(event){_this.props.handleInputChange(event);event.target.value=null};_this.renderHiddenInput=function(isFolder,refCallback){return h("input",{class:"uppy-Dashboard-input",hidden:true,"aria-hidden":"true",tabindex:-1,webkitdirectory:isFolder,type:"file",name:"files[]",multiple:_this.props.maxNumberOfFiles!==1,onchange:_this.onFileInputChange,accept:_this.props.allowedFileTypes,ref:refCallback})};_this.renderMyDeviceAcquirer=function(){return h("div",{class:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":"MyDevice"},h("button",{type:"button",class:"uppy-DashboardTab-btn",role:"tab",tabindex:0,"data-uppy-super-focusable":true,onclick:_this.triggerFileInputClick},h("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},h("g",{fill:"none","fill-rule":"evenodd"},h("rect",{width:"32",height:"32",rx:"16",fill:"#2275D7"}),h("path",{d:"M21.973 21.152H9.863l-1.108-5.087h14.464l-1.246 5.087zM9.935 11.37h3.958l.886 1.444a.673.673 0 0 0 .585.316h6.506v1.37H9.935v-3.13zm14.898 3.44a.793.793 0 0 0-.616-.31h-.978v-2.126c0-.379-.275-.613-.653-.613H15.75l-.886-1.445a.673.673 0 0 0-.585-.316H9.232c-.378 0-.667.209-.667.587V14.5h-.782a.793.793 0 0 0-.61.303.795.795 0 0 0-.155.663l1.45 6.633c.078.36.396.618.764.618h13.354c.36 0 .674-.246.76-.595l1.631-6.636a.795.795 0 0 0-.144-.675z",fill:"#FFF"}))),h("div",{class:"uppy-DashboardTab-name"},_this.props.i18n("myDevice"))))};_this.renderBrowseButton=function(text,onClickFn){var numberOfAcquirers=_this.props.acquirers.length;return h("button",{type:"button",class:"uppy-u-reset uppy-Dashboard-browse",onclick:onClickFn,"data-uppy-super-focusable":numberOfAcquirers===0},text)};_this.renderDropPasteBrowseTagline=function(){var numberOfAcquirers=_this.props.acquirers.length;var lowerFMSelectionType=_this.props.fileManagerSelectionType;var camelFMSelectionType=lowerFMSelectionType.charAt(0).toUpperCase()+lowerFMSelectionType.slice(1);var browseText="browse";var browseFilesText="browse";var browseFoldersText="browse";if(lowerFMSelectionType==="files"){try{browseText=_this.props.i18n("browse");browseFilesText=_this.props.i18n("browse");browseFoldersText=_this.props.i18n("browse")}catch(_unused){}}try{browseFilesText=_this.props.i18n("browseFiles");browseFoldersText=_this.props.i18n("browseFolders")}catch(_unused2){}var browse=_this.renderBrowseButton(browseText,_this.triggerFileInputClick);var browseFiles=_this.renderBrowseButton(browseFilesText,_this.triggerFileInputClick);var browseFolders=_this.renderBrowseButton(browseFoldersText,_this.triggerFolderInputClick);var titleText;if(numberOfAcquirers>0){titleText=_this.props.i18nArray("dropPasteImport"+camelFMSelectionType,{browseFiles:browseFiles,browseFolders:browseFolders,browse:browse})}else{titleText=_this.props.i18nArray("dropPaste"+camelFMSelectionType,{browseFiles:browseFiles,browseFolders:browseFolders,browse:browse})}if(lowerFMSelectionType==="files"){try{if(numberOfAcquirers>0){titleText=_this.props.i18nArray("dropPasteImport",{browse:browse})}else{titleText=_this.props.i18nArray("dropPaste",{browse:browse})}}catch(_unused3){}}return h("div",{class:"uppy-Dashboard-AddFiles-title"},titleText)};_this.renderAcquirer=function(acquirer){return h("div",{class:"uppy-DashboardTab",role:"presentation","data-uppy-acquirer-id":acquirer.id},h("button",{type:"button",class:"uppy-DashboardTab-btn",role:"tab",tabindex:0,"aria-controls":"uppy-DashboardContent-panel--"+acquirer.id,"aria-selected":_this.props.activePickerPanel.id===acquirer.id,"data-uppy-super-focusable":true,onclick:function onclick(){return _this.props.showPanel(acquirer.id)}},acquirer.icon(),h("div",{class:"uppy-DashboardTab-name"},acquirer.name)))};_this.renderAcquirers=function(acquirers){var acquirersWithoutLastTwo=[].concat(acquirers);var lastTwoAcquirers=acquirersWithoutLastTwo.splice(acquirers.length-2,acquirers.length);return h("div",{class:"uppy-Dashboard-AddFiles-list",role:"tablist"},_this.renderMyDeviceAcquirer(),acquirersWithoutLastTwo.map(function(acquirer){return _this.renderAcquirer(acquirer)}),h("span",{role:"presentation",style:"white-space: nowrap;"},lastTwoAcquirers.map(function(acquirer){return _this.renderAcquirer(acquirer)})))};return _this}var _proto=AddFiles.prototype;_proto.renderPoweredByUppy=function renderPoweredByUppy(){var uppyBranding=h("span",null,h("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon uppy-Dashboard-poweredByIcon",width:"11",height:"11",viewBox:"0 0 11 11"},h("path",{d:"M7.365 10.5l-.01-4.045h2.612L5.5.806l-4.467 5.65h2.604l.01 4.044h3.718z","fill-rule":"evenodd"})),h("span",{class:"uppy-Dashboard-poweredByUppy"},"Uppy"));var linkText=this.props.i18nArray("poweredBy2",{backwardsCompat:this.props.i18n("poweredBy"),uppy:uppyBranding});return h("a",{tabindex:"-1",href:"https://uppy.io",rel:"noreferrer noopener",target:"_blank",class:"uppy-Dashboard-poweredBy"},linkText)};_proto.render=function render(){var _this2=this;return h("div",{class:"uppy-Dashboard-AddFiles"},this.renderHiddenInput(false,function(ref){_this2.fileInput=ref}),this.renderHiddenInput(true,function(ref){_this2.folderInput=ref}),this.renderDropPasteBrowseTagline(),this.props.acquirers.length>0&&this.renderAcquirers(this.props.acquirers),h("div",{class:"uppy-Dashboard-AddFiles-info"},this.props.note&&h("div",{class:"uppy-Dashboard-note"},this.props.note),this.props.proudlyDisplayPoweredByUppy&&this.renderPoweredByUppy(this.props)))};return AddFiles}(Component);module.exports=AddFiles},{preact:96}],19:[function(require,module,exports){var _require=require("preact"),h=_require.h;var classNames=require("classnames");var AddFiles=require("./AddFiles");var AddFilesPanel=function AddFilesPanel(props){return h("div",{class:classNames("uppy-Dashboard-AddFilesPanel",props.className),"data-uppy-panelType":"AddFiles","aria-hidden":props.showAddFilesPanel},h("div",{class:"uppy-DashboardContent-bar"},h("div",{class:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},props.i18n("addingMoreFiles")),h("button",{class:"uppy-DashboardContent-back",type:"button",onclick:function onclick(ev){return props.toggleAddFilesPanel(false)}},props.i18n("back"))),h(AddFiles,props))};module.exports=AddFilesPanel},{"./AddFiles":18,classnames:83,preact:96}],20:[function(require,module,exports){function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var FileList=require("./FileList");var AddFiles=require("./AddFiles");var AddFilesPanel=require("./AddFilesPanel");var PickerPanelContent=require("./PickerPanelContent");var EditorPanel=require("./EditorPanel");var PanelTopBar=require("./PickerPanelTopBar");var FileCard=require("./FileCard");var Slide=require("./Slide");var classNames=require("classnames");var isDragDropSupported=require("@uppy/utils/lib/isDragDropSupported");var _require=require("preact"),h=_require.h;var WIDTH_XL=900;var WIDTH_LG=700;var WIDTH_MD=576;var HEIGHT_MD=400;module.exports=function Dashboard(props){var noFiles=props.totalFileCount===0;var isSizeMD=props.containerWidth>WIDTH_MD;var dashboardClassName=classNames({"uppy-Root":props.isTargetDOMEl,"uppy-Dashboard":true,"uppy-Dashboard--animateOpenClose":props.animateOpenClose,"uppy-Dashboard--isClosing":props.isClosing,"uppy-Dashboard--isDraggingOver":props.isDraggingOver,"uppy-Dashboard--modal":!props.inline,"uppy-size--md":props.containerWidth>WIDTH_MD,"uppy-size--lg":props.containerWidth>WIDTH_LG,"uppy-size--xl":props.containerWidth>WIDTH_XL,"uppy-size--height-md":props.containerHeight>HEIGHT_MD,"uppy-Dashboard--isAddFilesPanelVisible":props.showAddFilesPanel,"uppy-Dashboard--isInnerWrapVisible":props.areInsidesReadyToBeVisible});var itemsPerRow=1;if(props.containerWidth>WIDTH_XL){itemsPerRow=5}else if(props.containerWidth>WIDTH_LG){itemsPerRow=4}else if(props.containerWidth>WIDTH_MD){itemsPerRow=3}var showFileList=props.showSelectedFiles&&!noFiles;return h("div",{class:dashboardClassName,"data-uppy-theme":props.theme,"data-uppy-num-acquirers":props.acquirers.length,"data-uppy-drag-drop-supported":isDragDropSupported(),"aria-hidden":props.inline?"false":props.isHidden,"aria-label":!props.inline?props.i18n("dashboardWindowTitle"):props.i18n("dashboardTitle"),onpaste:props.handlePaste,onDragOver:props.handleDragOver,onDragLeave:props.handleDragLeave,onDrop:props.handleDrop},h("div",{class:"uppy-Dashboard-overlay",tabindex:-1,onclick:props.handleClickOutside}),h("div",{class:"uppy-Dashboard-inner","aria-modal":!props.inline&&"true",role:!props.inline&&"dialog",style:{width:props.inline&&props.width?props.width:"",height:props.inline&&props.height?props.height:""}},!props.inline?h("button",{class:"uppy-u-reset uppy-Dashboard-close",type:"button","aria-label":props.i18n("closeModal"),title:props.i18n("closeModal"),onclick:props.closeModal},h("span",{"aria-hidden":"true"},"×")):null,h("div",{class:"uppy-Dashboard-innerWrap"},h("div",{class:"uppy-Dashboard-dropFilesHereHint"},props.i18n("dropHint")),showFileList&&h(PanelTopBar,props),showFileList?h(FileList,_extends({},props,{itemsPerRow:itemsPerRow})):h(AddFiles,_extends({},props,{isSizeMD:isSizeMD})),h(Slide,null,props.showAddFilesPanel?h(AddFilesPanel,_extends({key:"AddFiles"},props,{isSizeMD:isSizeMD})):null),h(Slide,null,props.fileCardFor?h(FileCard,_extends({key:"FileCard"},props)):null),h(Slide,null,props.activePickerPanel?h(PickerPanelContent,_extends({key:"Picker"},props)):null),h(Slide,null,props.showFileEditor?h(EditorPanel,_extends({key:"Editor"},props)):null),h("div",{class:"uppy-Dashboard-progressindicators"},props.progressindicators.map(function(target){return props.getPlugin(target.id).render(props.state)})))))}},{"./AddFiles":18,"./AddFilesPanel":19,"./EditorPanel":21,"./FileCard":22,"./FileList":28,"./PickerPanelContent":30,"./PickerPanelTopBar":31,"./Slide":32,"@uppy/utils/lib/isDragDropSupported":72,classnames:83,preact:96}],21:[function(require,module,exports){var _require=require("preact"),h=_require.h;var classNames=require("classnames");function EditorPanel(props){var file=this.props.files[this.props.fileCardFor];return h("div",{class:classNames("uppy-DashboardContent-panel",props.className),role:"tabpanel","data-uppy-panelType":"FileEditor",id:"uppy-DashboardContent-panel--editor"},h("div",{class:"uppy-DashboardContent-bar"},h("div",{class:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},props.i18nArray("editing",{file:h("span",{class:"uppy-DashboardContent-titleFile"},file.meta?file.meta.name:file.name)})),h("button",{class:"uppy-DashboardContent-back",type:"button",onclick:props.hideAllPanels},props.i18n("done"))),h("div",{class:"uppy-DashboardContent-panelBody"},props.editors.map(function(target){return props.getPlugin(target.id).render(props.state)})))}module.exports=EditorPanel},{classnames:83,preact:96}],22:[function(require,module,exports){function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}var _require=require("preact"),h=_require.h,Component=_require.Component;var classNames=require("classnames");var getFileTypeIcon=require("../../utils/getFileTypeIcon");var ignoreEvent=require("../../utils/ignoreEvent.js");var FilePreview=require("../FilePreview");var FileCard=function(_Component){_inheritsLoose(FileCard,_Component);function FileCard(props){var _this;_this=_Component.call(this,props)||this;_this.saveOnEnter=function(ev){if(ev.keyCode===13){ev.stopPropagation();ev.preventDefault();var file=_this.props.files[_this.props.fileCardFor];_this.props.saveFileCard(_this.state.formState,file.id)}};_this.updateMeta=function(newVal,name){var _extends2;_this.setState({formState:_extends({},_this.state.formState,(_extends2={},_extends2[name]=newVal,_extends2))})};_this.handleSave=function(){var fileID=_this.props.fileCardFor;_this.props.saveFileCard(_this.state.formState,fileID)};_this.handleCancel=function(){_this.props.toggleFileCard()};_this.renderMetaFields=function(){var metaFields=_this.props.metaFields||[];var fieldCSSClasses={text:"uppy-u-reset uppy-c-textInput uppy-Dashboard-FileCard-input"};return metaFields.map(function(field){var id="uppy-Dashboard-FileCard-input-"+field.id;return h("fieldset",{key:field.id,class:"uppy-Dashboard-FileCard-fieldset"},h("label",{class:"uppy-Dashboard-FileCard-label",for:id},field.name),field.render!==undefined?field.render({value:_this.state.formState[field.id],onChange:function onChange(newVal){return _this.updateMeta(newVal,field.id)},fieldCSSClasses:fieldCSSClasses},h):h("input",{class:fieldCSSClasses.text,id:id,type:field.type||"text",value:_this.state.formState[field.id],placeholder:field.placeholder,onkeyup:_this.saveOnEnter,onkeydown:_this.saveOnEnter,onkeypress:_this.saveOnEnter,oninput:function oninput(ev){return _this.updateMeta(ev.target.value,field.id)},"data-uppy-super-focusable":true}))})};var _file=_this.props.files[_this.props.fileCardFor];var _metaFields=_this.props.metaFields||[];var storedMetaData={};_metaFields.forEach(function(field){storedMetaData[field.id]=_file.meta[field.id]||""});_this.state={formState:storedMetaData};return _this}var _proto=FileCard.prototype;_proto.render=function render(){var _this2=this;var file=this.props.files[this.props.fileCardFor];var showEditButton=this.props.canEditFile(file);return h("div",{class:classNames("uppy-Dashboard-FileCard",this.props.className),"data-uppy-panelType":"FileCard",onDragOver:ignoreEvent,onDragLeave:ignoreEvent,onDrop:ignoreEvent,onPaste:ignoreEvent},h("div",{class:"uppy-DashboardContent-bar"},h("div",{class:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},this.props.i18nArray("editing",{file:h("span",{class:"uppy-DashboardContent-titleFile"},file.meta?file.meta.name:file.name)})),h("button",{class:"uppy-DashboardContent-back",type:"button",title:this.props.i18n("finishEditingFile"),onclick:this.handleSave},this.props.i18n("done"))),h("div",{class:"uppy-Dashboard-FileCard-inner"},h("div",{class:"uppy-Dashboard-FileCard-preview",style:{backgroundColor:getFileTypeIcon(file.type).color}},h(FilePreview,{file:file}),showEditButton&&h("button",{type:"button",class:"uppy-u-reset uppy-c-btn uppy-Dashboard-FileCard-edit",onClick:function onClick(){return _this2.props.openFileEditor(file)}},this.props.i18n("editFile"))),h("div",{class:"uppy-Dashboard-FileCard-info"},this.renderMetaFields()),h("div",{class:"uppy-Dashboard-FileCard-actions"},h("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-FileCard-actionsBtn",type:"button",onclick:this.handleSave},this.props.i18n("saveChanges")),h("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-FileCard-actionsBtn",type:"button",onclick:this.handleCancel},this.props.i18n("cancel")))))};return FileCard}(Component);module.exports=FileCard},{"../../utils/getFileTypeIcon":38,"../../utils/ignoreEvent.js":39,"../FilePreview":29,classnames:83,preact:96}],23:[function(require,module,exports){var _require=require("preact"),h=_require.h;var copyToClipboard=require("../../../utils/copyToClipboard");function EditButton(_ref){var file=_ref.file,uploadInProgressOrComplete=_ref.uploadInProgressOrComplete,metaFields=_ref.metaFields,canEditFile=_ref.canEditFile,i18n=_ref.i18n,onClick=_ref.onClick;if(!uploadInProgressOrComplete&&metaFields&&metaFields.length>0||!uploadInProgressOrComplete&&canEditFile(file)){return h("button",{class:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--edit",type:"button","aria-label":i18n("editFile")+" "+file.meta.name,title:i18n("editFile"),onclick:function onclick(){return onClick()}},h("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 14"},h("g",{"fill-rule":"evenodd"},h("path",{d:"M1.5 10.793h2.793A1 1 0 0 0 5 10.5L11.5 4a1 1 0 0 0 0-1.414L9.707.793a1 1 0 0 0-1.414 0l-6.5 6.5A1 1 0 0 0 1.5 8v2.793zm1-1V8L9 1.5l1.793 1.793-6.5 6.5H2.5z","fill-rule":"nonzero"}),h("rect",{x:"1",y:"12.293",width:"11",height:"1",rx:".5"}),h("path",{"fill-rule":"nonzero",d:"M6.793 2.5L9.5 5.207l.707-.707L7.5 1.793z"}))))}return null}function RemoveButton(_ref2){var i18n=_ref2.i18n,onClick=_ref2.onClick;return h("button",{class:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--remove",type:"button","aria-label":i18n("removeFile"),title:i18n("removeFile"),onclick:function onclick(){return onClick()}},h("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"18",height:"18",viewBox:"0 0 18 18"},h("path",{d:"M9 0C4.034 0 0 4.034 0 9s4.034 9 9 9 9-4.034 9-9-4.034-9-9-9z"}),h("path",{fill:"#FFF",d:"M13 12.222l-.778.778L9 9.778 5.778 13 5 12.222 8.222 9 5 5.778 5.778 5 9 8.222 12.222 5l.778.778L9.778 9z"})))}var copyLinkToClipboard=function copyLinkToClipboard(event,props){copyToClipboard(props.file.uploadURL,props.i18n("copyLinkToClipboardFallback")).then(function(){props.log("Link copied to clipboard.");props.info(props.i18n("copyLinkToClipboardSuccess"),"info",3e3)}).catch(props.log).then(function(){return event.target.focus({preventScroll:true})})};function CopyLinkButton(props){return h("button",{class:"uppy-u-reset uppy-Dashboard-Item-action uppy-Dashboard-Item-action--copyLink",type:"button","aria-label":props.i18n("copyLink"),title:props.i18n("copyLink"),onclick:function onclick(event){return copyLinkToClipboard(event,props)}},h("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"14",height:"14",viewBox:"0 0 14 12"},h("path",{d:"M7.94 7.703a2.613 2.613 0 0 1-.626 2.681l-.852.851a2.597 2.597 0 0 1-1.849.766A2.616 2.616 0 0 1 2.764 7.54l.852-.852a2.596 2.596 0 0 1 2.69-.625L5.267 7.099a1.44 1.44 0 0 0-.833.407l-.852.851a1.458 1.458 0 0 0 1.03 2.486c.39 0 .755-.152 1.03-.426l.852-.852c.231-.231.363-.522.406-.824l1.04-1.038zm4.295-5.937A2.596 2.596 0 0 0 10.387 1c-.698 0-1.355.272-1.849.766l-.852.851a2.614 2.614 0 0 0-.624 2.688l1.036-1.036c.041-.304.173-.6.407-.833l.852-.852c.275-.275.64-.426 1.03-.426a1.458 1.458 0 0 1 1.03 2.486l-.852.851a1.442 1.442 0 0 1-.824.406l-1.04 1.04a2.596 2.596 0 0 0 2.683-.628l.851-.85a2.616 2.616 0 0 0 0-3.697zm-6.88 6.883a.577.577 0 0 0 .82 0l3.474-3.474a.579.579 0 1 0-.819-.82L5.355 7.83a.579.579 0 0 0 0 .819z"})))}module.exports=function Buttons(props){var file=props.file,uploadInProgressOrComplete=props.uploadInProgressOrComplete,canEditFile=props.canEditFile,metaFields=props.metaFields,showLinkToFileUploadResult=props.showLinkToFileUploadResult,showRemoveButton=props.showRemoveButton,i18n=props.i18n,removeFile=props.removeFile,toggleFileCard=props.toggleFileCard,openFileEditor=props.openFileEditor,log=props.log,info=props.info;var editAction=function editAction(){if(metaFields&&metaFields.length>0){toggleFileCard(file.id)}else{openFileEditor(file)}};return h("div",{className:"uppy-Dashboard-Item-actionWrapper"},h(EditButton,{i18n:i18n,file:file,uploadInProgressOrComplete:uploadInProgressOrComplete,canEditFile:canEditFile,metaFields:metaFields,onClick:editAction}),showLinkToFileUploadResult&&file.uploadURL?h(CopyLinkButton,{file:file,i18n:i18n,info:info,log:log}):null,showRemoveButton?h(RemoveButton,{i18n:i18n,info:props.info,log:props.log,onClick:function onClick(){return removeFile(file.id,"removed-by-user")}}):null)}},{"../../../utils/copyToClipboard":35,preact:96}],24:[function(require,module,exports){var _require=require("preact"),h=_require.h;var prettierBytes=require("@transloadit/prettier-bytes");var truncateString=require("@uppy/utils/lib/truncateString");var renderAcquirerIcon=function renderAcquirerIcon(acquirer,props){return h("span",{title:props.i18n("fileSource",{name:acquirer.name})},acquirer.icon())};var renderFileSource=function renderFileSource(props){return props.file.source&&props.file.source!==props.id&&h("div",{class:"uppy-Dashboard-Item-sourceIcon"},props.acquirers.map(function(acquirer){if(acquirer.id===props.file.source){return renderAcquirerIcon(acquirer,props)}}))};var renderFileName=function renderFileName(props){var maxNameLength;if(props.containerWidth<=352){maxNameLength=35}else if(props.containerWidth<=576){maxNameLength=60}else{maxNameLength=30}return h("div",{class:"uppy-Dashboard-Item-name",title:props.file.meta.name},truncateString(props.file.meta.name,maxNameLength))};var renderFileSize=function renderFileSize(props){return props.file.data.size&&h("div",{class:"uppy-Dashboard-Item-statusSize"},prettierBytes(props.file.data.size))};var ErrorButton=function ErrorButton(_ref){var file=_ref.file,onClick=_ref.onClick;if(file.error){return h("span",{class:"uppy-Dashboard-Item-errorDetails","aria-label":file.error,"data-microtip-position":"bottom","data-microtip-size":"medium",role:"tooltip",onclick:onClick},"?")}return null};module.exports=function FileInfo(props){return h("div",{class:"uppy-Dashboard-Item-fileInfo","data-uppy-file-source":props.file.source},renderFileName(props),h("div",{class:"uppy-Dashboard-Item-status"},renderFileSize(props),renderFileSource(props),h(ErrorButton,{file:props.file,onClick:function onClick(){alert(props.file.error)}})))}},{"@transloadit/prettier-bytes":6,"@uppy/utils/lib/truncateString":81,preact:96}],25:[function(require,module,exports){var _require=require("preact"),h=_require.h;var FilePreview=require("../../FilePreview");var getFileTypeIcon=require("../../../utils/getFileTypeIcon");module.exports=function FilePreviewAndLink(props){return h("div",{class:"uppy-Dashboard-Item-previewInnerWrap",style:{backgroundColor:getFileTypeIcon(props.file.type).color}},props.showLinkToFileUploadResult&&props.file.uploadURL&&h("a",{class:"uppy-Dashboard-Item-previewLink",href:props.file.uploadURL,rel:"noreferrer noopener",target:"_blank","aria-label":props.file.meta.name}),h(FilePreview,{file:props.file}))}},{"../../../utils/getFileTypeIcon":38,"../../FilePreview":29,preact:96}],26:[function(require,module,exports){var _require=require("preact"),h=_require.h;function onPauseResumeCancelRetry(props){if(props.isUploaded)return;if(props.error&&!props.hideRetryButton){props.retryUpload(props.file.id);return}if(props.resumableUploads&&!props.hidePauseResumeButton){props.pauseUpload(props.file.id)}else if(props.individualCancellation&&!props.hideCancelButton){props.cancelUpload(props.file.id)}}function progressIndicatorTitle(props){if(props.isUploaded){return props.i18n("uploadComplete")}if(props.error){return props.i18n("retryUpload")}if(props.resumableUploads){if(props.file.isPaused){return props.i18n("resumeUpload")}return props.i18n("pauseUpload")}else if(props.individualCancellation){return props.i18n("cancelUpload")}return""}function ProgressIndicatorButton(props){return h("div",{class:"uppy-Dashboard-Item-progress"},h("button",{class:"uppy-u-reset uppy-Dashboard-Item-progressIndicator",type:"button","aria-label":progressIndicatorTitle(props),title:progressIndicatorTitle(props),onclick:function onclick(){return onPauseResumeCancelRetry(props)}},props.children))}function ProgressCircleContainer(_ref){var children=_ref.children;return h("svg",{"aria-hidden":"true",focusable:"false",width:"70",height:"70",viewBox:"0 0 36 36",class:"uppy-c-icon uppy-Dashboard-Item-progressIcon--circle"},children)}function ProgressCircle(_ref2){var progress=_ref2.progress;var circleLength=2*Math.PI*15;return h("g",null,h("circle",{class:"uppy-Dashboard-Item-progressIcon--bg",r:"15",cx:"18",cy:"18","stroke-width":"2",fill:"none"}),h("circle",{class:"uppy-Dashboard-Item-progressIcon--progress",r:"15",cx:"18",cy:"18",transform:"rotate(-90, 18, 18)","stroke-width":"2",fill:"none","stroke-dasharray":circleLength,"stroke-dashoffset":circleLength-circleLength/100*progress}))}module.exports=function FileProgress(props){if(!props.file.progress.uploadStarted){return null}if(props.isUploaded){return h("div",{class:"uppy-Dashboard-Item-progress"},h("div",{class:"uppy-Dashboard-Item-progressIndicator"},h(ProgressCircleContainer,null,h("circle",{r:"15",cx:"18",cy:"18",fill:"#1bb240"}),h("polygon",{class:"uppy-Dashboard-Item-progressIcon--check",transform:"translate(2, 3)",points:"14 22.5 7 15.2457065 8.99985857 13.1732815 14 18.3547104 22.9729883 9 25 11.1005634"}))))}if(props.error&&!props.hideRetryButton){return h(ProgressIndicatorButton,props,h("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon uppy-Dashboard-Item-progressIcon--retry",width:"28",height:"31",viewBox:"0 0 16 19"},h("path",{d:"M16 11a8 8 0 1 1-8-8v2a6 6 0 1 0 6 6h2z"}),h("path",{d:"M7.9 3H10v2H7.9z"}),h("path",{d:"M8.536.5l3.535 3.536-1.414 1.414L7.12 1.914z"}),h("path",{d:"M10.657 2.621l1.414 1.415L8.536 7.57 7.12 6.157z"})))}if(props.resumableUploads&&!props.hidePauseResumeButton){return h(ProgressIndicatorButton,props,h(ProgressCircleContainer,null,h(ProgressCircle,{progress:props.file.progress.percentage}),props.file.isPaused?h("polygon",{class:"uppy-Dashboard-Item-progressIcon--play",transform:"translate(3, 3)",points:"12 20 12 10 20 15"}):h("g",{class:"uppy-Dashboard-Item-progressIcon--pause",transform:"translate(14.5, 13)"},h("rect",{x:"0",y:"0",width:"2",height:"10",rx:"0"}),h("rect",{x:"5",y:"0",width:"2",height:"10",rx:"0"}))))}if(!props.resumableUploads&&props.individualCancellation&&!props.hideCancelButton){return h(ProgressIndicatorButton,props,h(ProgressCircleContainer,null,h(ProgressCircle,{progress:props.file.progress.percentage}),h("polygon",{class:"cancel",transform:"translate(2, 2)",points:"19.8856516 11.0625 16 14.9481516 12.1019737 11.0625 11.0625 12.1143484 14.9481516 16 11.0625 19.8980263 12.1019737 20.9375 16 17.0518484 19.8856516 20.9375 20.9375 19.8980263 17.0518484 16 20.9375 12"})))}return h("div",{class:"uppy-Dashboard-Item-progress"},h("div",{class:"uppy-Dashboard-Item-progressIndicator"},h(ProgressCircleContainer,null,h(ProgressCircle,{progress:props.file.progress.percentage}))))}},{preact:96}],27:[function(require,module,exports){function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}var _require=require("preact"),h=_require.h,Component=_require.Component;var classNames=require("classnames");var shallowEqual=require("is-shallow-equal");var FilePreviewAndLink=require("./FilePreviewAndLink");var FileProgress=require("./FileProgress");var FileInfo=require("./FileInfo");var Buttons=require("./Buttons");module.exports=function(_Component){_inheritsLoose(FileItem,_Component);function FileItem(){return _Component.apply(this,arguments)||this}var _proto=FileItem.prototype;_proto.shouldComponentUpdate=function shouldComponentUpdate(nextProps){return!shallowEqual(this.props,nextProps)};_proto.componentDidMount=function componentDidMount(){var file=this.props.file;if(!file.preview){this.props.handleRequestThumbnail(file)}};_proto.componentWillUnmount=function componentWillUnmount(){var file=this.props.file;if(!file.preview){this.props.handleCancelThumbnail(file)}};_proto.render=function render(){var file=this.props.file;var isProcessing=file.progress.preprocess||file.progress.postprocess;var isUploaded=file.progress.uploadComplete&&!isProcessing&&!file.error;var uploadInProgressOrComplete=file.progress.uploadStarted||isProcessing;var uploadInProgress=file.progress.uploadStarted&&!file.progress.uploadComplete||isProcessing;var error=file.error||false;var showRemoveButton=this.props.individualCancellation?!isUploaded:!uploadInProgress&&!isUploaded;if(isUploaded&&this.props.showRemoveButtonAfterComplete){showRemoveButton=true}var dashboardItemClass=classNames({"uppy-Dashboard-Item":true,"is-inprogress":uploadInProgress,"is-processing":isProcessing,"is-complete":isUploaded,"is-error":!!error,"is-resumable":this.props.resumableUploads,"is-noIndividualCancellation":!this.props.individualCancellation});return h("div",{class:dashboardItemClass,id:"uppy_"+file.id,role:this.props.role},h("div",{class:"uppy-Dashboard-Item-preview"},h(FilePreviewAndLink,{file:file,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult}),h(FileProgress,{file:file,error:error,isUploaded:isUploaded,hideRetryButton:this.props.hideRetryButton,hideCancelButton:this.props.hideCancelButton,hidePauseResumeButton:this.props.hidePauseResumeButton,showRemoveButtonAfterComplete:this.props.showRemoveButtonAfterComplete,resumableUploads:this.props.resumableUploads,individualCancellation:this.props.individualCancellation,pauseUpload:this.props.pauseUpload,cancelUpload:this.props.cancelUpload,retryUpload:this.props.retryUpload,i18n:this.props.i18n})),h("div",{class:"uppy-Dashboard-Item-fileInfoAndButtons"},h(FileInfo,{file:file,id:this.props.id,acquirers:this.props.acquirers,containerWidth:this.props.containerWidth,i18n:this.props.i18n}),h(Buttons,{file:file,metaFields:this.props.metaFields,showLinkToFileUploadResult:this.props.showLinkToFileUploadResult,showRemoveButton:showRemoveButton,canEditFile:this.props.canEditFile,uploadInProgressOrComplete:uploadInProgressOrComplete,removeFile:this.props.removeFile,toggleFileCard:this.props.toggleFileCard,openFileEditor:this.props.openFileEditor,i18n:this.props.i18n,log:this.props.log,info:this.props.info})))};return FileItem}(Component)},{"./Buttons":23,"./FileInfo":24,"./FilePreviewAndLink":25,"./FileProgress":26,classnames:83,"is-shallow-equal":89,preact:96}],28:[function(require,module,exports){function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var FileItem=require("./FileItem/index.js");var VirtualList=require("./VirtualList");var classNames=require("classnames");var _require=require("preact"),h=_require.h;function chunks(list,size){var chunked=[];var currentChunk=[];list.forEach(function(item,i){if(currentChunk.length<size){currentChunk.push(item)}else{chunked.push(currentChunk);currentChunk=[item]}});if(currentChunk.length)chunked.push(currentChunk);return chunked}module.exports=function(props){var noFiles=props.totalFileCount===0;var dashboardFilesClass=classNames("uppy-Dashboard-files",{"uppy-Dashboard-files--noFiles":noFiles});var rowHeight=props.itemsPerRow===1?71:200;var fileProps={id:props.id,error:props.error,i18n:props.i18n,log:props.log,info:props.info,acquirers:props.acquirers,resumableUploads:props.resumableUploads,individualCancellation:props.individualCancellation,hideRetryButton:props.hideRetryButton,hidePauseResumeButton:props.hidePauseResumeButton,hideCancelButton:props.hideCancelButton,showLinkToFileUploadResult:props.showLinkToFileUploadResult,showRemoveButtonAfterComplete:props.showRemoveButtonAfterComplete,isWide:props.isWide,metaFields:props.metaFields,retryUpload:props.retryUpload,pauseUpload:props.pauseUpload,cancelUpload:props.cancelUpload,toggleFileCard:props.toggleFileCard,removeFile:props.removeFile,handleRequestThumbnail:props.handleRequestThumbnail,handleCancelThumbnail:props.handleCancelThumbnail};var rows=chunks(Object.keys(props.files),props.itemsPerRow);function renderRow(row){return h("div",{role:"presentation",key:row[0]},row.map(function(fileID){return h(FileItem,_extends({key:fileID},fileProps,{role:"listitem",openFileEditor:props.openFileEditor,canEditFile:props.canEditFile,file:props.files[fileID]}))}))}return h(VirtualList,{class:dashboardFilesClass,role:"list",data:rows,renderRow:renderRow,rowHeight:rowHeight})}},{"./FileItem/index.js":27,"./VirtualList":33,classnames:83,preact:96}],29:[function(require,module,exports){var getFileTypeIcon=require("../utils/getFileTypeIcon");var _require=require("preact"),h=_require.h;module.exports=function FilePreview(props){var file=props.file;if(file.preview){return h("img",{class:"uppy-Dashboard-Item-previewImg",alt:file.name,src:file.preview})}var _getFileTypeIcon=getFileTypeIcon(file.type),color=_getFileTypeIcon.color,icon=_getFileTypeIcon.icon;return h("div",{class:"uppy-Dashboard-Item-previewIconWrap"},h("span",{class:"uppy-Dashboard-Item-previewIcon",style:{color:color}},icon),h("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-Dashboard-Item-previewIconBg",width:"58",height:"76",viewBox:"0 0 58 76"},h("rect",{fill:"#FFF",width:"58",height:"76",rx:"3","fill-rule":"evenodd"})))}},{"../utils/getFileTypeIcon":38,preact:96}],30:[function(require,module,exports){var _require=require("preact"),h=_require.h;var classNames=require("classnames");var ignoreEvent=require("../utils/ignoreEvent.js");function PickerPanelContent(props){return h("div",{class:classNames("uppy-DashboardContent-panel",props.className),role:"tabpanel","data-uppy-panelType":"PickerPanel",id:"uppy-DashboardContent-panel--"+props.activePickerPanel.id,onDragOver:ignoreEvent,onDragLeave:ignoreEvent,onDrop:ignoreEvent,onPaste:ignoreEvent},h("div",{class:"uppy-DashboardContent-bar"},h("div",{class:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},props.i18n("importFrom",{name:props.activePickerPanel.name})),h("button",{class:"uppy-DashboardContent-back",type:"button",onclick:props.hideAllPanels},props.i18n("done"))),h("div",{class:"uppy-DashboardContent-panelBody"},props.getPlugin(props.activePickerPanel.id).render(props.state)))}module.exports=PickerPanelContent},{"../utils/ignoreEvent.js":39,classnames:83,preact:96}],31:[function(require,module,exports){var _require=require("preact"),h=_require.h;var uploadStates={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete",STATE_PAUSED:"paused"};function getUploadingState(isAllErrored,isAllComplete,isAllPaused,files){if(files===void 0){files={}}if(isAllErrored){return uploadStates.STATE_ERROR}if(isAllComplete){return uploadStates.STATE_COMPLETE}if(isAllPaused){return uploadStates.STATE_PAUSED}var state=uploadStates.STATE_WAITING;var fileIDs=Object.keys(files);for(var i=0;i<fileIDs.length;i++){var progress=files[fileIDs[i]].progress;if(progress.uploadStarted&&!progress.uploadComplete){return uploadStates.STATE_UPLOADING}if(progress.preprocess&&state!==uploadStates.STATE_UPLOADING){state=uploadStates.STATE_PREPROCESSING}if(progress.postprocess&&state!==uploadStates.STATE_UPLOADING&&state!==uploadStates.STATE_PREPROCESSING){state=uploadStates.STATE_POSTPROCESSING}}return state}function UploadStatus(props){var uploadingState=getUploadingState(props.isAllErrored,props.isAllComplete,props.isAllPaused,props.files);switch(uploadingState){case"uploading":return props.i18n("uploadingXFiles",{smart_count:props.inProgressNotPausedFiles.length});case"preprocessing":case"postprocessing":return props.i18n("processingXFiles",{smart_count:props.processingFiles.length});case"paused":return props.i18n("uploadPaused");case"waiting":return props.i18n("xFilesSelected",{smart_count:props.newFiles.length});case"complete":return props.i18n("uploadComplete")}}function PanelTopBar(props){var allowNewUpload=props.allowNewUpload;if(allowNewUpload&&props.maxNumberOfFiles){allowNewUpload=props.totalFileCount<props.maxNumberOfFiles}return h("div",{class:"uppy-DashboardContent-bar"},!props.isAllComplete&&!props.hideCancelButton?h("button",{class:"uppy-DashboardContent-back",type:"button",onclick:props.cancelAll},props.i18n("cancel")):h("div",null),h("div",{class:"uppy-DashboardContent-title",role:"heading","aria-level":"1"},h(UploadStatus,props)),allowNewUpload?h("button",{class:"uppy-DashboardContent-addMore",type:"button","aria-label":props.i18n("addMoreFiles"),title:props.i18n("addMoreFiles"),onclick:function onclick(){return props.toggleAddFilesPanel(true)}},h("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"15",height:"15",viewBox:"0 0 15 15"},h("path",{d:"M8 6.5h6a.5.5 0 0 1 .5.5v.5a.5.5 0 0 1-.5.5H8v6a.5.5 0 0 1-.5.5H7a.5.5 0 0 1-.5-.5V8h-6a.5.5 0 0 1-.5-.5V7a.5.5 0 0 1 .5-.5h6v-6A.5.5 0 0 1 7 0h.5a.5.5 0 0 1 .5.5v6z"})),h("span",{class:"uppy-DashboardContent-addMoreCaption"},props.i18n("addMore"))):h("div",null))}module.exports=PanelTopBar},{preact:96}],32:[function(require,module,exports){function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}var _require=require("preact"),cloneElement=_require.cloneElement,Component=_require.Component;var classNames=require("classnames");var transitionName="uppy-transition-slideDownUp";var duration=250;var Slide=function(_Component){_inheritsLoose(Slide,_Component);function Slide(props){var _this;_this=_Component.call(this,props)||this;_this.state={cachedChildren:null,className:""};return _this}var _proto=Slide.prototype;_proto.componentWillUpdate=function componentWillUpdate(nextProps){var _this2=this;var cachedChildren=this.state.cachedChildren;var child=nextProps.children[0];if(cachedChildren===child)return;var patch={cachedChildren:child};if(child&&!cachedChildren){patch.className=transitionName+"-enter";cancelAnimationFrame(this.animationFrame);clearTimeout(this.leaveTimeout);this.leaveTimeout=undefined;this.animationFrame=requestAnimationFrame(function(){_this2.base.getBoundingClientRect();_this2.setState({className:transitionName+"-enter "+transitionName+"-enter-active"});_this2.enterTimeout=setTimeout(function(){_this2.setState({className:""})},duration)})}if(cachedChildren&&!child&&this.leaveTimeout===undefined){patch.cachedChildren=cachedChildren;patch.className=transitionName+"-leave";cancelAnimationFrame(this.animationFrame);clearTimeout(this.enterTimeout);this.enterTimeout=undefined;this.animationFrame=requestAnimationFrame(function(){_this2.setState({className:transitionName+"-leave "+transitionName+"-leave-active"});_this2.leaveTimeout=setTimeout(function(){_this2.setState({cachedChildren:null,className:""})},duration)})}this.setState(patch)};_proto.render=function render(){var _this$state=this.state,cachedChildren=_this$state.cachedChildren,className=_this$state.className;if(!cachedChildren){return null}return cloneElement(cachedChildren,{className:classNames(className,cachedChildren.attributes.className)})};return Slide}(Component);module.exports=Slide},{classnames:83,preact:96}],33:[function(require,module,exports){function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _objectWithoutPropertiesLoose(source,excluded){if(source==null)return{};var target={};var sourceKeys=Object.keys(source);var key,i;for(i=0;i<sourceKeys.length;i++){key=sourceKeys[i];if(excluded.indexOf(key)>=0)continue;target[key]=source[key]}return target}function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}var _require=require("preact"),h=_require.h,Component=_require.Component;var STYLE_INNER={position:"relative",width:"100%",minHeight:"100%"};var STYLE_CONTENT={position:"absolute",top:0,left:0,width:"100%",overflow:"visible"};var VirtualList=function(_Component){_inheritsLoose(VirtualList,_Component);function VirtualList(props){var _this;_this=_Component.call(this,props)||this;_this.handleResize=function(){_this.resize()};_this.handleScroll=function(){_this.setState({offset:_this.base.scrollTop});if(_this.props.sync){_this.forceUpdate()}};_this.focusElement=null;_this.state={offset:0,height:0};return _this}var _proto=VirtualList.prototype;_proto.resize=function resize(){if(this.state.height!==this.base.offsetHeight){this.setState({height:this.base.offsetHeight})}};_proto.componentWillUpdate=function componentWillUpdate(){if(this.base.contains(document.activeElement)){this.focusElement=document.activeElement}};_proto.componentDidUpdate=function componentDidUpdate(){if(this.focusElement&&this.focusElement.parentNode&&document.activeElement!==this.focusElement){this.focusElement.focus()}this.focusElement=null;this.resize()};_proto.componentDidMount=function componentDidMount(){this.resize();window.addEventListener("resize",this.handleResize)};_proto.componentWillUnmount=function componentWillUnmount(){window.removeEventListener("resize",this.handleResize)};_proto.render=function render(_ref){var data=_ref.data,rowHeight=_ref.rowHeight,renderRow=_ref.renderRow,_ref$overscanCount=_ref.overscanCount,overscanCount=_ref$overscanCount===void 0?10:_ref$overscanCount,sync=_ref.sync,props=_objectWithoutPropertiesLoose(_ref,["data","rowHeight","renderRow","overscanCount","sync"]);var _this$state=this.state,offset=_this$state.offset,height=_this$state.height;var start=Math.floor(offset/rowHeight);var visibleRowCount=Math.floor(height/rowHeight);if(overscanCount){start=Math.max(0,start-start%overscanCount);visibleRowCount+=overscanCount}var end=start+visibleRowCount+4;var selection=data.slice(start,end);var styleInner=_extends({},STYLE_INNER,{height:data.length*rowHeight});var styleContent=_extends({},STYLE_CONTENT,{top:start*rowHeight});return h("div",_extends({onScroll:this.handleScroll},props),h("div",{role:"presentation",style:styleInner},h("div",{role:"presentation",style:styleContent},selection.map(renderRow))))};return VirtualList}(Component);module.exports=VirtualList},{preact:96}],34:[function(require,module,exports){var _class,_temp;function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}var _require=require("preact"),h=_require.h;var _require2=require("@uppy/core"),Plugin=_require2.Plugin;var Translator=require("@uppy/utils/lib/Translator");var DashboardUI=require("./components/Dashboard");var StatusBar=require("@uppy/status-bar");var Informer=require("@uppy/informer");var ThumbnailGenerator=require("@uppy/thumbnail-generator");var findAllDOMElements=require("@uppy/utils/lib/findAllDOMElements");var toArray=require("@uppy/utils/lib/toArray");var getDroppedFiles=require("@uppy/utils/lib/getDroppedFiles");var trapFocus=require("./utils/trapFocus");var cuid=require("cuid");var ResizeObserver=require("resize-observer-polyfill").default||require("resize-observer-polyfill");var createSuperFocus=require("./utils/createSuperFocus");var memoize=require("memoize-one").default||require("memoize-one");var TAB_KEY=9;var ESC_KEY=27;function createPromise(){var o={};o.promise=new Promise(function(resolve,reject){o.resolve=resolve;o.reject=reject});return o}function defaultPickerIcon(){return h("svg",{"aria-hidden":"true",focusable:"false",width:"30",height:"30",viewBox:"0 0 30 30"},h("path",{d:"M15 30c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C6.716 0 0 6.716 0 15c0 8.284 6.716 15 15 15zm4.258-12.676v6.846h-8.426v-6.846H5.204l9.82-12.364 9.82 12.364H19.26z"}))}module.exports=(_temp=_class=function(_Plugin){_inheritsLoose(Dashboard,_Plugin);function Dashboard(uppy,_opts){var _this;_this=_Plugin.call(this,uppy,_opts)||this;_this.setOptions=function(newOpts){_Plugin.prototype.setOptions.call(_assertThisInitialized(_this),newOpts);_this.i18nInit()};_this.i18nInit=function(){_this.translator=new Translator([_this.defaultLocale,_this.uppy.locale,_this.opts.locale]);_this.i18n=_this.translator.translate.bind(_this.translator);_this.i18nArray=_this.translator.translateArray.bind(_this.translator);_this.setPluginState()};_this.removeTarget=function(plugin){var pluginState=_this.getPluginState();var newTargets=pluginState.targets.filter(function(target){return target.id!==plugin.id});_this.setPluginState({targets:newTargets})};_this.addTarget=function(plugin){var callerPluginId=plugin.id||plugin.constructor.name;var callerPluginName=plugin.title||callerPluginId;var callerPluginType=plugin.type;if(callerPluginType!=="acquirer"&&callerPluginType!=="progressindicator"&&callerPluginType!=="editor"){var msg="Dashboard: can only be targeted by plugins of types: acquirer, progressindicator, editor";_this.uppy.log(msg,"error");return}var target={id:callerPluginId,name:callerPluginName,type:callerPluginType};var state=_this.getPluginState();var newTargets=state.targets.slice();newTargets.push(target);_this.setPluginState({targets:newTargets});return _this.el};_this.hideAllPanels=function(){var update={activePickerPanel:false,showAddFilesPanel:false,activeOverlayType:null,fileCardFor:null,showFileEditor:false};var current=_this.getPluginState();if(current.activePickerPanel===update.activePickerPanel&&current.showAddFilesPanel===update.showAddFilesPanel&&current.showFileEditor===update.showFileEditor&&current.activeOverlayType===update.activeOverlayType){return}_this.setPluginState(update)};_this.showPanel=function(id){var _this$getPluginState=_this.getPluginState(),targets=_this$getPluginState.targets;var activePickerPanel=targets.filter(function(target){return target.type==="acquirer"&&target.id===id})[0];_this.setPluginState({activePickerPanel:activePickerPanel,activeOverlayType:"PickerPanel"})};_this.canEditFile=function(file){var _this$getPluginState2=_this.getPluginState(),targets=_this$getPluginState2.targets;var editors=_this._getEditors(targets);return editors.some(function(target){return _this.uppy.getPlugin(target.id).canEditFile(file)})};_this.openFileEditor=function(file){var _this$getPluginState3=_this.getPluginState(),targets=_this$getPluginState3.targets;var editors=_this._getEditors(targets);_this.setPluginState({showFileEditor:true,fileCardFor:file.id||null,activeOverlayType:"FileEditor"});editors.forEach(function(editor){_this.uppy.getPlugin(editor.id).selectFile(file)})};_this.openModal=function(){var _createPromise=createPromise(),promise=_createPromise.promise,resolve=_createPromise.resolve;_this.savedScrollPosition=window.pageYOffset;_this.savedActiveElement=document.activeElement;if(_this.opts.disablePageScrollWhenModalOpen){document.body.classList.add("uppy-Dashboard-isFixed")}if(_this.opts.animateOpenClose&&_this.getPluginState().isClosing){var handler=function handler(){_this.setPluginState({isHidden:false});_this.el.removeEventListener("animationend",handler,false);resolve()};_this.el.addEventListener("animationend",handler,false)}else{_this.setPluginState({isHidden:false});resolve()}if(_this.opts.browserBackButtonClose){_this.updateBrowserHistory()}document.addEventListener("keydown",_this.handleKeyDownInModal);_this.uppy.emit("dashboard:modal-open");return promise};_this.closeModal=function(opts){if(opts===void 0){opts={}}var _opts2=opts,_opts2$manualClose=_opts2.manualClose,manualClose=_opts2$manualClose===void 0?true:_opts2$manualClose;var _this$getPluginState4=_this.getPluginState(),isHidden=_this$getPluginState4.isHidden,isClosing=_this$getPluginState4.isClosing;if(isHidden||isClosing){return}var _createPromise2=createPromise(),promise=_createPromise2.promise,resolve=_createPromise2.resolve;if(_this.opts.disablePageScrollWhenModalOpen){document.body.classList.remove("uppy-Dashboard-isFixed")}if(_this.opts.animateOpenClose){_this.setPluginState({isClosing:true});var handler=function handler(){_this.setPluginState({isHidden:true,isClosing:false});_this.superFocus.cancel();_this.savedActiveElement.focus();_this.el.removeEventListener("animationend",handler,false);resolve()};_this.el.addEventListener("animationend",handler,false)}else{_this.setPluginState({isHidden:true});_this.superFocus.cancel();_this.savedActiveElement.focus();resolve()}document.removeEventListener("keydown",_this.handleKeyDownInModal);if(manualClose){if(_this.opts.browserBackButtonClose){if(history.state&&history.state[_this.modalName]){history.go(-1)}}}_this.uppy.emit("dashboard:modal-closed");return promise};_this.isModalOpen=function(){return!_this.getPluginState().isHidden||false};_this.requestCloseModal=function(){if(_this.opts.onRequestCloseModal){return _this.opts.onRequestCloseModal()}return _this.closeModal()};_this.setDarkModeCapability=function(isDarkModeOn){var _this$uppy$getState=_this.uppy.getState(),capabilities=_this$uppy$getState.capabilities;_this.uppy.setState({capabilities:_extends({},capabilities,{darkMode:isDarkModeOn})})};_this.handleSystemDarkModeChange=function(event){var isDarkModeOnNow=event.matches;_this.uppy.log("[Dashboard] Dark mode is "+(isDarkModeOnNow?"on":"off"));_this.setDarkModeCapability(isDarkModeOnNow)};_this.toggleFileCard=function(fileId){if(fileId){_this.uppy.emit("dashboard:file-edit-start")}else{_this.uppy.emit("dashboard:file-edit-complete")}_this.setPluginState({fileCardFor:fileId||null,activeOverlayType:fileId?"FileCard":null})};_this.toggleAddFilesPanel=function(show){_this.setPluginState({showAddFilesPanel:show,activeOverlayType:show?"AddFiles":null})};_this.addFiles=function(files){var descriptors=files.map(function(file){return{source:_this.id,name:file.name,type:file.type,data:file,meta:{relativePath:file.relativePath||null}}});try{_this.uppy.addFiles(descriptors)}catch(err){_this.uppy.log(err)}};_this.startListeningToResize=function(){_this.resizeObserver=new ResizeObserver(function(entries,observer){var uppyDashboardInnerEl=entries[0];var _uppyDashboardInnerEl=uppyDashboardInnerEl.contentRect,width=_uppyDashboardInnerEl.width,height=_uppyDashboardInnerEl.height;_this.uppy.log("[Dashboard] resized: "+width+" / "+height,"debug");_this.setPluginState({containerWidth:width,containerHeight:height,areInsidesReadyToBeVisible:true})});_this.resizeObserver.observe(_this.el.querySelector(".uppy-Dashboard-inner"));_this.makeDashboardInsidesVisibleAnywayTimeout=setTimeout(function(){var pluginState=_this.getPluginState();var isModalAndClosed=!_this.opts.inline&&pluginState.isHidden;if(!pluginState.areInsidesReadyToBeVisible&&!isModalAndClosed){_this.uppy.log("[Dashboard] resize event didn't fire on time: defaulted to mobile layout","debug");_this.setPluginState({areInsidesReadyToBeVisible:true})}},1e3)};_this.stopListeningToResize=function(){_this.resizeObserver.disconnect();clearTimeout(_this.makeDashboardInsidesVisibleAnywayTimeout)};_this.recordIfFocusedOnUppyRecently=function(event){if(_this.el.contains(event.target)){_this.ifFocusedOnUppyRecently=true}else{_this.ifFocusedOnUppyRecently=false;_this.superFocus.cancel()}};_this.updateBrowserHistory=function(){if(!history.state||!history.state[_this.modalName]){var _extends2;history.pushState(_extends({},history.state,(_extends2={},_extends2[_this.modalName]=true,_extends2)),"")}window.addEventListener("popstate",_this.handlePopState,false)};_this.handlePopState=function(event){if(_this.isModalOpen()&&(!event.state||!event.state[_this.modalName])){_this.closeModal({manualClose:false})}if(!_this.isModalOpen()&&event.state&&event.state[_this.modalName]){history.go(-1)}};_this.handleKeyDownInModal=function(event){if(event.keyCode===ESC_KEY)_this.requestCloseModal(event);if(event.keyCode===TAB_KEY)trapFocus.forModal(event,_this.getPluginState().activeOverlayType,_this.el)};_this.handleClickOutside=function(){if(_this.opts.closeModalOnClickOutside)_this.requestCloseModal()};_this.handlePaste=function(event){_this.uppy.iteratePlugins(function(plugin){if(plugin.type==="acquirer"){plugin.handleRootPaste&&plugin.handleRootPaste(event)}});var files=toArray(event.clipboardData.files);_this.addFiles(files)};_this.handleInputChange=function(event){event.preventDefault();var files=toArray(event.target.files);_this.addFiles(files)};_this.handleDragOver=function(event){event.preventDefault();event.stopPropagation();event.dataTransfer.dropEffect="copy";clearTimeout(_this.removeDragOverClassTimeout);_this.setPluginState({isDraggingOver:true})};_this.handleDragLeave=function(event){event.preventDefault();event.stopPropagation();clearTimeout(_this.removeDragOverClassTimeout);_this.removeDragOverClassTimeout=setTimeout(function(){_this.setPluginState({isDraggingOver:false})},50)};_this.handleDrop=function(event,dropCategory){event.preventDefault();event.stopPropagation();clearTimeout(_this.removeDragOverClassTimeout);_this.setPluginState({isDraggingOver:false});_this.uppy.iteratePlugins(function(plugin){if(plugin.type==="acquirer"){plugin.handleRootDrop&&plugin.handleRootDrop(event)}});var executedDropErrorOnce=false;var logDropError=function logDropError(error){_this.uppy.log(error,"error");if(!executedDropErrorOnce){_this.uppy.info(error.message,"error");executedDropErrorOnce=true}};getDroppedFiles(event.dataTransfer,{logDropError:logDropError}).then(function(files){if(files.length>0){_this.uppy.log("[Dashboard] Files were dropped");_this.addFiles(files)}})};_this.handleRequestThumbnail=function(file){if(!_this.opts.waitForThumbnailsBeforeUpload){_this.uppy.emit("thumbnail:request",file)}};_this.handleCancelThumbnail=function(file){if(!_this.opts.waitForThumbnailsBeforeUpload){_this.uppy.emit("thumbnail:cancel",file)}};_this.handleKeyDownInInline=function(event){if(event.keyCode===TAB_KEY)trapFocus.forInline(event,_this.getPluginState().activeOverlayType,_this.el)};_this.handlePasteOnBody=function(event){var isFocusInOverlay=_this.el.contains(document.activeElement);if(isFocusInOverlay){_this.handlePaste(event)}};_this.handleComplete=function(_ref){var failed=_ref.failed;if(_this.opts.closeAfterFinish&&failed.length===0){_this.requestCloseModal()}};_this._openFileEditorWhenFilesAdded=function(files){var firstFile=files[0];if(_this.canEditFile(firstFile)){_this.openFileEditor(firstFile)}};_this.initEvents=function(){if(_this.opts.trigger&&!_this.opts.inline){var showModalTrigger=findAllDOMElements(_this.opts.trigger);if(showModalTrigger){showModalTrigger.forEach(function(trigger){return trigger.addEventListener("click",_this.openModal)})}else{_this.uppy.log("Dashboard modal trigger not found. Make sure `trigger` is set in Dashboard options, unless you are planning to call `dashboard.openModal()` method yourself","warning")}}_this.startListeningToResize();document.addEventListener("paste",_this.handlePasteOnBody);_this.uppy.on("plugin-remove",_this.removeTarget);_this.uppy.on("file-added",_this.hideAllPanels);_this.uppy.on("dashboard:modal-closed",_this.hideAllPanels);_this.uppy.on("file-editor:complete",_this.hideAllPanels);_this.uppy.on("complete",_this.handleComplete);document.addEventListener("focus",_this.recordIfFocusedOnUppyRecently,true);document.addEventListener("click",_this.recordIfFocusedOnUppyRecently,true);if(_this.opts.inline){_this.el.addEventListener("keydown",_this.handleKeyDownInInline)}if(_this.opts.autoOpenFileEditor){_this.uppy.on("files-added",_this._openFileEditorWhenFilesAdded)}};_this.removeEvents=function(){var showModalTrigger=findAllDOMElements(_this.opts.trigger);if(!_this.opts.inline&&showModalTrigger){showModalTrigger.forEach(function(trigger){return trigger.removeEventListener("click",_this.openModal)})}_this.stopListeningToResize();document.removeEventListener("paste",_this.handlePasteOnBody);window.removeEventListener("popstate",_this.handlePopState,false);_this.uppy.off("plugin-remove",_this.removeTarget);_this.uppy.off("file-added",_this.hideAllPanels);_this.uppy.off("dashboard:modal-closed",_this.hideAllPanels);_this.uppy.off("complete",_this.handleComplete);document.removeEventListener("focus",_this.recordIfFocusedOnUppyRecently);document.removeEventListener("click",_this.recordIfFocusedOnUppyRecently);if(_this.opts.inline){_this.el.removeEventListener("keydown",_this.handleKeyDownInInline)}if(_this.opts.autoOpenFileEditor){_this.uppy.off("files-added",_this._openFileEditorWhenFilesAdded)}};_this.superFocusOnEachUpdate=function(){var isFocusInUppy=_this.el.contains(document.activeElement);var isFocusNowhere=document.activeElement===document.body||document.activeElement===null;var isInformerHidden=_this.uppy.getState().info.isHidden;var isModal=!_this.opts.inline;if(isInformerHidden&&(isModal||isFocusInUppy||isFocusNowhere&&_this.ifFocusedOnUppyRecently)){_this.superFocus(_this.el,_this.getPluginState().activeOverlayType)}else{_this.superFocus.cancel()}};_this.afterUpdate=function(){_this.superFocusOnEachUpdate()};_this.cancelUpload=function(fileID){_this.uppy.removeFile(fileID)};_this.saveFileCard=function(meta,fileID){_this.uppy.setFileMeta(fileID,meta);_this.toggleFileCard()};_this._attachRenderFunctionToTarget=function(target){var plugin=_this.uppy.getPlugin(target.id);return _extends({},target,{icon:plugin.icon||_this.opts.defaultPickerIcon,render:plugin.render})};_this._isTargetSupported=function(target){var plugin=_this.uppy.getPlugin(target.id);if(typeof plugin.isSupported!=="function"){return true}return plugin.isSupported()};_this._getAcquirers=memoize(function(targets){return targets.filter(function(target){return target.type==="acquirer"&&_this._isTargetSupported(target)}).map(_this._attachRenderFunctionToTarget)});_this._getProgressIndicators=memoize(function(targets){return targets.filter(function(target){return target.type==="progressindicator"}).map(_this._attachRenderFunctionToTarget)});_this._getEditors=memoize(function(targets){return targets.filter(function(target){return target.type==="editor"}).map(_this._attachRenderFunctionToTarget)});_this.render=function(state){var pluginState=_this.getPluginState();var files=state.files,capabilities=state.capabilities,allowNewUpload=state.allowNewUpload;var newFiles=Object.keys(files).filter(function(file){return!files[file].progress.uploadStarted});var uploadStartedFiles=Object.keys(files).filter(function(file){return files[file].progress.uploadStarted});var pausedFiles=Object.keys(files).filter(function(file){return files[file].isPaused});var completeFiles=Object.keys(files).filter(function(file){return files[file].progress.uploadComplete});var erroredFiles=Object.keys(files).filter(function(file){return files[file].error});var inProgressFiles=Object.keys(files).filter(function(file){return!files[file].progress.uploadComplete&&files[file].progress.uploadStarted});var inProgressNotPausedFiles=inProgressFiles.filter(function(file){return!files[file].isPaused});var processingFiles=Object.keys(files).filter(function(file){return files[file].progress.preprocess||files[file].progress.postprocess});var isUploadStarted=uploadStartedFiles.length>0;var isAllComplete=state.totalProgress===100&&completeFiles.length===Object.keys(files).length&&processingFiles.length===0;var isAllErrored=isUploadStarted&&erroredFiles.length===uploadStartedFiles.length;var isAllPaused=inProgressFiles.length!==0&&pausedFiles.length===inProgressFiles.length;var acquirers=_this._getAcquirers(pluginState.targets);var progressindicators=_this._getProgressIndicators(pluginState.targets);var editors=_this._getEditors(pluginState.targets);var theme;if(_this.opts.theme==="auto"){theme=capabilities.darkMode?"dark":"light"}else{theme=_this.opts.theme}if(["files","folders","both"].indexOf(_this.opts.fileManagerSelectionType)<0){_this.opts.fileManagerSelectionType="files";console.error('Unsupported option for "fileManagerSelectionType". Using default of "'+_this.opts.fileManagerSelectionType+'".')}return DashboardUI({state:state,isHidden:pluginState.isHidden,files:files,newFiles:newFiles,uploadStartedFiles:uploadStartedFiles,completeFiles:completeFiles,erroredFiles:erroredFiles,inProgressFiles:inProgressFiles,inProgressNotPausedFiles:inProgressNotPausedFiles,processingFiles:processingFiles,isUploadStarted:isUploadStarted,isAllComplete:isAllComplete,isAllErrored:isAllErrored,isAllPaused:isAllPaused,totalFileCount:Object.keys(files).length,totalProgress:state.totalProgress,allowNewUpload:allowNewUpload,acquirers:acquirers,theme:theme,activePickerPanel:pluginState.activePickerPanel,showFileEditor:pluginState.showFileEditor,animateOpenClose:_this.opts.animateOpenClose,isClosing:pluginState.isClosing,getPlugin:_this.uppy.getPlugin,progressindicators:progressindicators,editors:editors,autoProceed:_this.uppy.opts.autoProceed,id:_this.id,closeModal:_this.requestCloseModal,handleClickOutside:_this.handleClickOutside,handleInputChange:_this.handleInputChange,handlePaste:_this.handlePaste,inline:_this.opts.inline,showPanel:_this.showPanel,hideAllPanels:_this.hideAllPanels,log:_this.uppy.log,i18n:_this.i18n,i18nArray:_this.i18nArray,removeFile:_this.uppy.removeFile,uppy:_this.uppy,info:_this.uppy.info,note:_this.opts.note,metaFields:pluginState.metaFields,resumableUploads:capabilities.resumableUploads||false,individualCancellation:capabilities.individualCancellation,isMobileDevice:capabilities.isMobileDevice,pauseUpload:_this.uppy.pauseResume,retryUpload:_this.uppy.retryUpload,cancelUpload:_this.cancelUpload,cancelAll:_this.uppy.cancelAll,fileCardFor:pluginState.fileCardFor,toggleFileCard:_this.toggleFileCard,toggleAddFilesPanel:_this.toggleAddFilesPanel,showAddFilesPanel:pluginState.showAddFilesPanel,saveFileCard:_this.saveFileCard,openFileEditor:_this.openFileEditor,canEditFile:_this.canEditFile,width:_this.opts.width,height:_this.opts.height,showLinkToFileUploadResult:_this.opts.showLinkToFileUploadResult,fileManagerSelectionType:_this.opts.fileManagerSelectionType,proudlyDisplayPoweredByUppy:_this.opts.proudlyDisplayPoweredByUppy,hideCancelButton:_this.opts.hideCancelButton,hideRetryButton:_this.opts.hideRetryButton,hidePauseResumeButton:_this.opts.hidePauseResumeButton,showRemoveButtonAfterComplete:_this.opts.showRemoveButtonAfterComplete,containerWidth:pluginState.containerWidth,containerHeight:pluginState.containerHeight,areInsidesReadyToBeVisible:pluginState.areInsidesReadyToBeVisible,isTargetDOMEl:_this.isTargetDOMEl,parentElement:_this.el,allowedFileTypes:_this.uppy.opts.restrictions.allowedFileTypes,maxNumberOfFiles:_this.uppy.opts.restrictions.maxNumberOfFiles,showSelectedFiles:_this.opts.showSelectedFiles,handleRequestThumbnail:_this.handleRequestThumbnail,handleCancelThumbnail:_this.handleCancelThumbnail,isDraggingOver:pluginState.isDraggingOver,handleDragOver:_this.handleDragOver,handleDragLeave:_this.handleDragLeave,handleDrop:_this.handleDrop})};_this.discoverProviderPlugins=function(){_this.uppy.iteratePlugins(function(plugin){if(plugin&&!plugin.target&&plugin.opts&&plugin.opts.target===_this.constructor){_this.addTarget(plugin)}})};_this.install=function(){_this.setPluginState({isHidden:true,fileCardFor:null,activeOverlayType:null,showAddFilesPanel:false,activePickerPanel:false,showFileEditor:false,metaFields:_this.opts.metaFields,targets:[],areInsidesReadyToBeVisible:false,isDraggingOver:false});var _this$opts=_this.opts,inline=_this$opts.inline,closeAfterFinish=_this$opts.closeAfterFinish;if(inline&&closeAfterFinish){throw new Error("[Dashboard] `closeAfterFinish: true` cannot be used on an inline Dashboard, because an inline Dashboard cannot be closed at all. Either set `inline: false`, or disable the `closeAfterFinish` option.")}var allowMultipleUploads=_this.uppy.opts.allowMultipleUploads;if(allowMultipleUploads&&closeAfterFinish){_this.uppy.log("[Dashboard] When using `closeAfterFinish`, we recommended setting the `allowMultipleUploads` option to `false` in the Uppy constructor. See https://uppy.io/docs/uppy/#allowMultipleUploads-true","warning")}var target=_this.opts.target;if(target){_this.mount(target,_assertThisInitialized(_this))}var plugins=_this.opts.plugins||[];plugins.forEach(function(pluginID){var plugin=_this.uppy.getPlugin(pluginID);if(plugin){plugin.mount(_assertThisInitialized(_this),plugin)}});if(!_this.opts.disableStatusBar){_this.uppy.use(StatusBar,{id:_this.id+":StatusBar",target:_assertThisInitialized(_this),hideUploadButton:_this.opts.hideUploadButton,hideRetryButton:_this.opts.hideRetryButton,hidePauseResumeButton:_this.opts.hidePauseResumeButton,hideCancelButton:_this.opts.hideCancelButton,showProgressDetails:_this.opts.showProgressDetails,hideAfterFinish:_this.opts.hideProgressAfterFinish,locale:_this.opts.locale,doneButtonHandler:_this.opts.doneButtonHandler})}if(!_this.opts.disableInformer){_this.uppy.use(Informer,{id:_this.id+":Informer",target:_assertThisInitialized(_this)})}if(!_this.opts.disableThumbnailGenerator){_this.uppy.use(ThumbnailGenerator,{id:_this.id+":ThumbnailGenerator",thumbnailWidth:_this.opts.thumbnailWidth,thumbnailType:_this.opts.thumbnailType,waitForThumbnailsBeforeUpload:_this.opts.waitForThumbnailsBeforeUpload,lazy:!_this.opts.waitForThumbnailsBeforeUpload})}_this.darkModeMediaQuery=typeof window!=="undefined"&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)"):null;var isDarkModeOnFromTheStart=_this.darkModeMediaQuery?_this.darkModeMediaQuery.matches:false;_this.uppy.log("[Dashboard] Dark mode is "+(isDarkModeOnFromTheStart?"on":"off"));_this.setDarkModeCapability(isDarkModeOnFromTheStart);if(_this.opts.theme==="auto"){_this.darkModeMediaQuery.addListener(_this.handleSystemDarkModeChange)}_this.discoverProviderPlugins();_this.initEvents()};_this.uninstall=function(){if(!_this.opts.disableInformer){var informer=_this.uppy.getPlugin(_this.id+":Informer");if(informer)_this.uppy.removePlugin(informer)}if(!_this.opts.disableStatusBar){var statusBar=_this.uppy.getPlugin(_this.id+":StatusBar");if(statusBar)_this.uppy.removePlugin(statusBar)}if(!_this.opts.disableThumbnailGenerator){var thumbnail=_this.uppy.getPlugin(_this.id+":ThumbnailGenerator");if(thumbnail)_this.uppy.removePlugin(thumbnail)}var plugins=_this.opts.plugins||[];plugins.forEach(function(pluginID){var plugin=_this.uppy.getPlugin(pluginID);if(plugin)plugin.unmount()});if(_this.opts.theme==="auto"){_this.darkModeMediaQuery.removeListener(_this.handleSystemDarkModeChange)}_this.unmount();_this.removeEvents()};_this.id=_this.opts.id||"Dashboard";_this.title="Dashboard";_this.type="orchestrator";_this.modalName="uppy-Dashboard-"+cuid();_this.defaultLocale={strings:{closeModal:"Close Modal",importFrom:"Import from %{name}",addingMoreFiles:"Adding more files",addMoreFiles:"Add more files",dashboardWindowTitle:"File Uploader Window (Press escape to close)",dashboardTitle:"File Uploader",copyLinkToClipboardSuccess:"Link copied to clipboard",copyLinkToClipboardFallback:"Copy the URL below",copyLink:"Copy link",fileSource:"File source: %{name}",done:"Done",back:"Back",addMore:"Add more",removeFile:"Remove file",editFile:"Edit file",editing:"Editing %{file}",finishEditingFile:"Finish editing file",saveChanges:"Save changes",cancel:"Cancel",myDevice:"My Device",dropPasteFiles:"Drop files here, paste or %{browseFiles}",dropPasteFolders:"Drop files here, paste or %{browseFolders}",dropPasteBoth:"Drop files here, paste, %{browseFiles} or %{browseFolders}",dropPasteImportFiles:"Drop files here, paste, %{browseFiles} or import from:",dropPasteImportFolders:"Drop files here, paste, %{browseFolders} or import from:",dropPasteImportBoth:"Drop files here, paste, %{browseFiles}, %{browseFolders} or import from:",dropHint:"Drop your files here",browseFiles:"browse files",browseFolders:"browse folders",uploadComplete:"Upload complete",uploadPaused:"Upload paused",resumeUpload:"Resume upload",pauseUpload:"Pause upload",retryUpload:"Retry upload",cancelUpload:"Cancel upload",xFilesSelected:{0:"%{smart_count} file selected",1:"%{smart_count} files selected"},uploadingXFiles:{0:"Uploading %{smart_count} file",1:"Uploading %{smart_count} files"},processingXFiles:{0:"Processing %{smart_count} file",1:"Processing %{smart_count} files"},poweredBy2:"%{backwardsCompat} %{uppy}",poweredBy:"Powered by"}};var defaultOptions={target:"body",metaFields:[],trigger:"#uppy-select-files",inline:false,width:750,height:550,thumbnailWidth:280,thumbnailType:"image/jpeg",waitForThumbnailsBeforeUpload:false,defaultPickerIcon:defaultPickerIcon,showLinkToFileUploadResult:true,showProgressDetails:false,hideUploadButton:false,hideCancelButton:false,hideRetryButton:false,hidePauseResumeButton:false,hideProgressAfterFinish:false,doneButtonHandler:function doneButtonHandler(){_this.uppy.reset();_this.requestCloseModal()},note:null,closeModalOnClickOutside:false,closeAfterFinish:false,disableStatusBar:false,disableInformer:false,disableThumbnailGenerator:false,disablePageScrollWhenModalOpen:true,animateOpenClose:true,fileManagerSelectionType:"files",proudlyDisplayPoweredByUppy:true,onRequestCloseModal:function onRequestCloseModal(){return _this.closeModal()},showSelectedFiles:true,showRemoveButtonAfterComplete:false,browserBackButtonClose:false,theme:"light",autoOpenFileEditor:false};_this.opts=_extends({},defaultOptions,_opts);_this.i18nInit();_this.superFocus=createSuperFocus();_this.ifFocusedOnUppyRecently=false;_this.makeDashboardInsidesVisibleAnywayTimeout=null;_this.removeDragOverClassTimeout=null;return _this}return Dashboard}(Plugin),_class.VERSION="1.14.0",_temp)},{"./components/Dashboard":20,"./utils/createSuperFocus":36,"./utils/trapFocus":40,"@uppy/core":15,"@uppy/informer":41,"@uppy/status-bar":44,"@uppy/thumbnail-generator":46,"@uppy/utils/lib/Translator":52,"@uppy/utils/lib/findAllDOMElements":56,"@uppy/utils/lib/getDroppedFiles":60,"@uppy/utils/lib/toArray":80,cuid:84,"memoize-one":93,preact:96,"resize-observer-polyfill":97}],35:[function(require,module,exports){module.exports=function copyToClipboard(textToCopy,fallbackString){fallbackString=fallbackString||"Copy the URL below";return new Promise(function(resolve){var textArea=document.createElement("textarea");textArea.setAttribute("style",{position:"fixed",top:0,left:0,width:"2em",height:"2em",padding:0,border:"none",outline:"none",boxShadow:"none",background:"transparent"});textArea.value=textToCopy;document.body.appendChild(textArea);textArea.select();var magicCopyFailed=function magicCopyFailed(){document.body.removeChild(textArea);window.prompt(fallbackString,textToCopy);resolve()};try{var successful=document.execCommand("copy");if(!successful){return magicCopyFailed("copy command unavailable")}document.body.removeChild(textArea);return resolve()}catch(err){document.body.removeChild(textArea);return magicCopyFailed(err)}})}},{}],36:[function(require,module,exports){var debounce=require("lodash.debounce");var FOCUSABLE_ELEMENTS=require("@uppy/utils/lib/FOCUSABLE_ELEMENTS");var getActiveOverlayEl=require("./getActiveOverlayEl");module.exports=function createSuperFocus(){var lastFocusWasOnSuperFocusableEl=false;var superFocus=function superFocus(dashboardEl,activeOverlayType){var overlayEl=getActiveOverlayEl(dashboardEl,activeOverlayType);var isFocusInOverlay=overlayEl.contains(document.activeElement);if(isFocusInOverlay&&lastFocusWasOnSuperFocusableEl)return;var superFocusableEl=overlayEl.querySelector("[data-uppy-super-focusable]");if(isFocusInOverlay&&!superFocusableEl)return;if(superFocusableEl){superFocusableEl.focus({preventScroll:true});lastFocusWasOnSuperFocusableEl=true}else{var firstEl=overlayEl.querySelector(FOCUSABLE_ELEMENTS);firstEl&&firstEl.focus({preventScroll:true});lastFocusWasOnSuperFocusableEl=false}};return debounce(superFocus,260)}},{"./getActiveOverlayEl":37,"@uppy/utils/lib/FOCUSABLE_ELEMENTS":48,"lodash.debounce":90}],37:[function(require,module,exports){module.exports=function getActiveOverlayEl(dashboardEl,activeOverlayType){if(activeOverlayType){var overlayEl=dashboardEl.querySelector('[data-uppy-paneltype="'+activeOverlayType+'"]');if(overlayEl)return overlayEl}return dashboardEl}},{}],38:[function(require,module,exports){var _require=require("preact"),h=_require.h;function iconImage(){return h("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25"},h("g",{fill:"#686DE0","fill-rule":"evenodd"},h("path",{d:"M5 7v10h15V7H5zm0-1h15a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1z","fill-rule":"nonzero"}),h("path",{d:"M6.35 17.172l4.994-5.026a.5.5 0 0 1 .707 0l2.16 2.16 3.505-3.505a.5.5 0 0 1 .707 0l2.336 2.31-.707.72-1.983-1.97-3.505 3.505a.5.5 0 0 1-.707 0l-2.16-2.159-3.938 3.939-1.409.026z","fill-rule":"nonzero"}),h("circle",{cx:"7.5",cy:"9.5",r:"1.5"})))}function iconAudio(){return h("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},h("path",{d:"M9.5 18.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V7.25a.5.5 0 0 1 .379-.485l9-2.25A.5.5 0 0 1 18.5 5v11.64c0 1.14-1.145 2-2.5 2s-2.5-.86-2.5-2c0-1.14 1.145-2 2.5-2 .557 0 1.079.145 1.5.396V8.67l-8 2v7.97zm8-11v-2l-8 2v2l8-2zM7 19.64c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1zm9-2c.855 0 1.5-.484 1.5-1s-.645-1-1.5-1-1.5.484-1.5 1 .645 1 1.5 1z",fill:"#049BCF","fill-rule":"nonzero"}))}function iconVideo(){return h("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},h("path",{d:"M16 11.834l4.486-2.691A1 1 0 0 1 22 10v6a1 1 0 0 1-1.514.857L16 14.167V17a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2.834zM15 9H5v8h10V9zm1 4l5 3v-6l-5 3z",fill:"#19AF67","fill-rule":"nonzero"}))}function iconPDF(){return h("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},h("path",{d:"M9.766 8.295c-.691-1.843-.539-3.401.747-3.726 1.643-.414 2.505.938 2.39 3.299-.039.79-.194 1.662-.537 3.148.324.49.66.967 1.055 1.51.17.231.382.488.629.757 1.866-.128 3.653.114 4.918.655 1.487.635 2.192 1.685 1.614 2.84-.566 1.133-1.839 1.084-3.416.249-1.141-.604-2.457-1.634-3.51-2.707a13.467 13.467 0 0 0-2.238.426c-1.392 4.051-4.534 6.453-5.707 4.572-.986-1.58 1.38-4.206 4.914-5.375.097-.322.185-.656.264-1.001.08-.353.306-1.31.407-1.737-.678-1.059-1.2-2.031-1.53-2.91zm2.098 4.87c-.033.144-.068.287-.104.427l.033-.01-.012.038a14.065 14.065 0 0 1 1.02-.197l-.032-.033.052-.004a7.902 7.902 0 0 1-.208-.271c-.197-.27-.38-.526-.555-.775l-.006.028-.002-.003c-.076.323-.148.632-.186.8zm5.77 2.978c1.143.605 1.832.632 2.054.187.26-.519-.087-1.034-1.113-1.473-.911-.39-2.175-.608-3.55-.608.845.766 1.787 1.459 2.609 1.894zM6.559 18.789c.14.223.693.16 1.425-.413.827-.648 1.61-1.747 2.208-3.206-2.563 1.064-4.102 2.867-3.633 3.62zm5.345-10.97c.088-1.793-.351-2.48-1.146-2.28-.473.119-.564 1.05-.056 2.405.213.566.52 1.188.908 1.859.18-.858.268-1.453.294-1.984z",fill:"#E2514A","fill-rule":"nonzero"}))}function iconArchive(){return h("svg",{"aria-hidden":"true",focusable:"false",width:"25",height:"25",viewBox:"0 0 25 25"},h("path",{d:"M10.45 2.05h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V2.55a.5.5 0 0 1 .5-.5zm2.05 1.024h1.05a.5.5 0 0 1 .5.5V3.6a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5v-.001zM10.45 0h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5V.5a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 3.074h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-2.05 1.024h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm-2.05 1.025h1.05a.5.5 0 0 1 .5.5v.025a.5.5 0 0 1-.5.5h-1.05a.5.5 0 0 1-.5-.5v-.025a.5.5 0 0 1 .5-.5zm2.05 1.025h1.05a.5.5 0 0 1 .5.5v.024a.5.5 0 0 1-.5.5H12.5a.5.5 0 0 1-.5-.5v-.024a.5.5 0 0 1 .5-.5zm-1.656 3.074l-.82 5.946c.52.302 1.174.458 1.976.458.803 0 1.455-.156 1.975-.458l-.82-5.946h-2.311zm0-1.025h2.312c.512 0 .946.378 1.015.885l.82 5.946c.056.412-.142.817-.501 1.026-.686.398-1.515.597-2.49.597-.974 0-1.804-.199-2.49-.597a1.025 1.025 0 0 1-.5-1.026l.819-5.946c.07-.507.503-.885 1.015-.885zm.545 6.6a.5.5 0 0 1-.397-.561l.143-.999a.5.5 0 0 1 .495-.429h.74a.5.5 0 0 1 .495.43l.143.998a.5.5 0 0 1-.397.561c-.404.08-.819.08-1.222 0z",fill:"#00C469","fill-rule":"nonzero"}))}function iconFile(){return h("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},h("g",{fill:"#A7AFB7","fill-rule":"nonzero"},h("path",{d:"M5.5 22a.5.5 0 0 1-.5-.5v-18a.5.5 0 0 1 .5-.5h10.719a.5.5 0 0 1 .367.16l3.281 3.556a.5.5 0 0 1 .133.339V21.5a.5.5 0 0 1-.5.5h-14zm.5-1h13V7.25L16 4H6v17z"}),h("path",{d:"M15 4v3a1 1 0 0 0 1 1h3V7h-3V4h-1z"})))}function iconText(){return h("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"25",height:"25",viewBox:"0 0 25 25"},h("path",{d:"M4.5 7h13a.5.5 0 1 1 0 1h-13a.5.5 0 0 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h15a.5.5 0 1 1 0 1h-15a.5.5 0 1 1 0-1zm0 3h10a.5.5 0 1 1 0 1h-10a.5.5 0 1 1 0-1z",fill:"#5A5E69","fill-rule":"nonzero"}))}module.exports=function getIconByMime(fileType){var defaultChoice={color:"#838999",icon:iconFile()};if(!fileType)return defaultChoice;var fileTypeGeneral=fileType.split("/")[0];var fileTypeSpecific=fileType.split("/")[1];if(fileTypeGeneral==="text"){return{color:"#5a5e69",icon:iconText()}}if(fileTypeGeneral==="image"){return{color:"#686de0",icon:iconImage()}}if(fileTypeGeneral==="audio"){return{color:"#068dbb",icon:iconAudio()}}if(fileTypeGeneral==="video"){return{color:"#19af67",icon:iconVideo()}}if(fileTypeGeneral==="application"&&fileTypeSpecific==="pdf"){return{color:"#e25149",icon:iconPDF()}}var archiveTypes=["zip","x-7z-compressed","x-rar-compressed","x-tar","x-gzip","x-apple-diskimage"];if(fileTypeGeneral==="application"&&archiveTypes.indexOf(fileTypeSpecific)!==-1){return{color:"#00C469",icon:iconArchive()}}return defaultChoice}},{preact:96}],39:[function(require,module,exports){function ignoreEvent(ev){var tagName=ev.target.tagName;if(tagName==="INPUT"||tagName==="TEXTAREA"){ev.stopPropagation();return}ev.preventDefault();ev.stopPropagation()}module.exports=ignoreEvent},{}],40:[function(require,module,exports){var toArray=require("@uppy/utils/lib/toArray");var getActiveOverlayEl=require("./getActiveOverlayEl");var FOCUSABLE_ELEMENTS=require("@uppy/utils/lib//FOCUSABLE_ELEMENTS");function focusOnFirstNode(event,nodes){var node=nodes[0];if(node){node.focus();event.preventDefault()}}function focusOnLastNode(event,nodes){var node=nodes[nodes.length-1];if(node){node.focus();event.preventDefault()}}function isFocusInOverlay(activeOverlayEl){return activeOverlayEl.contains(document.activeElement)}function trapFocus(event,activeOverlayType,dashboardEl){var activeOverlayEl=getActiveOverlayEl(dashboardEl,activeOverlayType);var focusableNodes=toArray(activeOverlayEl.querySelectorAll(FOCUSABLE_ELEMENTS));var focusedItemIndex=focusableNodes.indexOf(document.activeElement);if(!isFocusInOverlay(activeOverlayEl)){focusOnFirstNode(event,focusableNodes)}else if(event.shiftKey&&focusedItemIndex===0){focusOnLastNode(event,focusableNodes)}else if(!event.shiftKey&&focusedItemIndex===focusableNodes.length-1){focusOnFirstNode(event,focusableNodes)}}module.exports={forModal:function forModal(event,activeOverlayType,dashboardEl){trapFocus(event,activeOverlayType,dashboardEl)},forInline:function forInline(event,activeOverlayType,dashboardEl){if(activeOverlayType===null){}else{trapFocus(event,activeOverlayType,dashboardEl)}}}},{"./getActiveOverlayEl":37,"@uppy/utils/lib//FOCUSABLE_ELEMENTS":48,"@uppy/utils/lib/toArray":80}],41:[function(require,module,exports){var _class,_temp;function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}var _require=require("@uppy/core"),Plugin=_require.Plugin;var _require2=require("preact"),h=_require2.h;module.exports=(_temp=_class=function(_Plugin){_inheritsLoose(Informer,_Plugin);function Informer(uppy,opts){var _this;_this=_Plugin.call(this,uppy,opts)||this;_this.render=function(state){var _state$info=state.info,isHidden=_state$info.isHidden,message=_state$info.message,details=_state$info.details;function displayErrorAlert(){var errorMessage=message+" \n\n "+details;alert(errorMessage)}var handleMouseOver=function handleMouseOver(){clearTimeout(_this.uppy.infoTimeoutID)};var handleMouseLeave=function handleMouseLeave(){_this.uppy.infoTimeoutID=setTimeout(_this.uppy.hideInfo,2e3)};return h("div",{class:"uppy uppy-Informer","aria-hidden":isHidden},h("p",{role:"alert"},message," ",details&&h("span",{"aria-label":details,"data-microtip-position":"top-left","data-microtip-size":"medium",role:"tooltip",onclick:displayErrorAlert,onMouseOver:handleMouseOver,onMouseLeave:handleMouseLeave},"?")))};_this.type="progressindicator";_this.id=_this.opts.id||"Informer";_this.title="Informer";var defaultOptions={};_this.opts=_extends({},defaultOptions,opts);return _this}var _proto=Informer.prototype;_proto.install=function install(){var target=this.opts.target;if(target){this.mount(target,this)}};return Informer}(Plugin),_class.VERSION="1.5.14",_temp)},{"@uppy/core":15,preact:96}],42:[function(require,module,exports){function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var throttle=require("lodash.throttle");var classNames=require("classnames");var statusBarStates=require("./StatusBarStates");var prettierBytes=require("@transloadit/prettier-bytes");var prettyETA=require("@uppy/utils/lib/prettyETA");var _require=require("preact"),h=_require.h;function calculateProcessingProgress(files){var progresses=[];Object.keys(files).forEach(function(fileID){var progress=files[fileID].progress;if(progress.preprocess){progresses.push(progress.preprocess)}if(progress.postprocess){progresses.push(progress.postprocess)}});var _progresses$=progresses[0],mode=_progresses$.mode,message=_progresses$.message;var value=progresses.filter(isDeterminate).reduce(function(total,progress,index,all){return total+progress.value/all.length},0);function isDeterminate(progress){return progress.mode==="determinate"}return{mode:mode,message:message,value:value}}function togglePauseResume(props){if(props.isAllComplete)return;if(!props.resumableUploads){return props.cancelAll()}if(props.isAllPaused){return props.resumeAll()}return props.pauseAll()}module.exports=function(props){props=props||{};var _props=props,newFiles=_props.newFiles,allowNewUpload=_props.allowNewUpload,isUploadInProgress=_props.isUploadInProgress,isAllPaused=_props.isAllPaused,resumableUploads=_props.resumableUploads,error=_props.error,hideUploadButton=_props.hideUploadButton,hidePauseResumeButton=_props.hidePauseResumeButton,hideCancelButton=_props.hideCancelButton,hideRetryButton=_props.hideRetryButton;var uploadState=props.uploadState;var progressValue=props.totalProgress;var progressMode;var progressBarContent;if(uploadState===statusBarStates.STATE_PREPROCESSING||uploadState===statusBarStates.STATE_POSTPROCESSING){var progress=calculateProcessingProgress(props.files);progressMode=progress.mode;if(progressMode==="determinate"){progressValue=progress.value*100}progressBarContent=ProgressBarProcessing(progress)}else if(uploadState===statusBarStates.STATE_COMPLETE){progressBarContent=ProgressBarComplete(props)}else if(uploadState===statusBarStates.STATE_UPLOADING){if(!props.supportsUploadProgress){progressMode="indeterminate";progressValue=null}progressBarContent=ProgressBarUploading(props)}else if(uploadState===statusBarStates.STATE_ERROR){progressValue=undefined;progressBarContent=ProgressBarError(props)}var width=typeof progressValue==="number"?progressValue:100;var isHidden=uploadState===statusBarStates.STATE_WAITING&&props.hideUploadButton||uploadState===statusBarStates.STATE_WAITING&&!props.newFiles>0||uploadState===statusBarStates.STATE_COMPLETE&&props.hideAfterFinish;var showUploadBtn=!error&&newFiles&&!isUploadInProgress&&!isAllPaused&&allowNewUpload&&!hideUploadButton;var showCancelBtn=!hideCancelButton&&uploadState!==statusBarStates.STATE_WAITING&&uploadState!==statusBarStates.STATE_COMPLETE;var showPauseResumeBtn=resumableUploads&&!hidePauseResumeButton&&uploadState===statusBarStates.STATE_UPLOADING;var showRetryBtn=error&&!hideRetryButton;var showDoneBtn=props.doneButtonHandler&&uploadState===statusBarStates.STATE_COMPLETE;var progressClassNames="uppy-StatusBar-progress\n                           "+(progressMode?"is-"+progressMode:"");var statusBarClassNames=classNames({"uppy-Root":props.isTargetDOMEl},"uppy-StatusBar","is-"+uploadState);return h("div",{class:statusBarClassNames,"aria-hidden":isHidden},h("div",{class:progressClassNames,style:{width:width+"%"},role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":progressValue}),progressBarContent,h("div",{class:"uppy-StatusBar-actions"},showUploadBtn?h(UploadBtn,_extends({},props,{uploadState:uploadState})):null,showRetryBtn?h(RetryBtn,props):null,showPauseResumeBtn?h(PauseResumeButton,props):null,showCancelBtn?h(CancelBtn,props):null,showDoneBtn?h(DoneBtn,props):null))};var UploadBtn=function UploadBtn(props){var uploadBtnClassNames=classNames("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":props.uploadState===statusBarStates.STATE_WAITING});return h("button",{type:"button",class:uploadBtnClassNames,"aria-label":props.i18n("uploadXFiles",{smart_count:props.newFiles}),onclick:props.startUpload,"data-uppy-super-focusable":true},props.newFiles&&props.isUploadStarted?props.i18n("uploadXNewFiles",{smart_count:props.newFiles}):props.i18n("uploadXFiles",{smart_count:props.newFiles}))};var RetryBtn=function RetryBtn(props){return h("button",{type:"button",class:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":props.i18n("retryUpload"),onclick:props.retryAll,"data-uppy-super-focusable":true},h("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"8",height:"10",viewBox:"0 0 8 10"},h("path",{d:"M4 2.408a2.75 2.75 0 1 0 2.75 2.75.626.626 0 0 1 1.25.018v.023a4 4 0 1 1-4-4.041V.25a.25.25 0 0 1 .389-.208l2.299 1.533a.25.25 0 0 1 0 .416l-2.3 1.533A.25.25 0 0 1 4 3.316v-.908z"})),props.i18n("retry"))};var CancelBtn=function CancelBtn(props){return h("button",{type:"button",class:"uppy-u-reset uppy-StatusBar-actionCircleBtn",title:props.i18n("cancel"),"aria-label":props.i18n("cancel"),onclick:props.cancelAll,"data-uppy-super-focusable":true},h("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16"},h("g",{fill:"none","fill-rule":"evenodd"},h("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),h("path",{fill:"#FFF",d:"M9.283 8l2.567 2.567-1.283 1.283L8 9.283 5.433 11.85 4.15 10.567 6.717 8 4.15 5.433 5.433 4.15 8 6.717l2.567-2.567 1.283 1.283z"}))))};var PauseResumeButton=function PauseResumeButton(props){var isAllPaused=props.isAllPaused,i18n=props.i18n;var title=isAllPaused?i18n("resume"):i18n("pause");return h("button",{title:title,"aria-label":title,class:"uppy-u-reset uppy-StatusBar-actionCircleBtn",type:"button",onclick:function onclick(){return togglePauseResume(props)},"data-uppy-super-focusable":true},isAllPaused?h("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16"},h("g",{fill:"none","fill-rule":"evenodd"},h("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),h("path",{fill:"#FFF",d:"M6 4.25L11.5 8 6 11.75z"}))):h("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16"},h("g",{fill:"none","fill-rule":"evenodd"},h("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),h("path",{d:"M5 4.5h2v7H5v-7zm4 0h2v7H9v-7z",fill:"#FFF"}))))};var DoneBtn=function DoneBtn(props){var i18n=props.i18n;return h("button",{type:"button",class:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--done",onClick:props.doneButtonHandler,"data-uppy-super-focusable":true},i18n("done"))};var LoadingSpinner=function LoadingSpinner(){return h("svg",{class:"uppy-StatusBar-spinner","aria-hidden":"true",focusable:"false",width:"14",height:"14"},h("path",{d:"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0","fill-rule":"evenodd"}))};var ProgressBarProcessing=function ProgressBarProcessing(props){var value=Math.round(props.value*100);return h("div",{class:"uppy-StatusBar-content"},h(LoadingSpinner,null),props.mode==="determinate"?value+"% · ":"",props.message)};var renderDot=function renderDot(){return" · "};var ProgressDetails=function ProgressDetails(props){var ifShowFilesUploadedOfTotal=props.numUploads>1;return h("div",{class:"uppy-StatusBar-statusSecondary"},ifShowFilesUploadedOfTotal&&props.i18n("filesUploadedOfTotal",{complete:props.complete,smart_count:props.numUploads}),h("span",{class:"uppy-StatusBar-additionalInfo"},ifShowFilesUploadedOfTotal&&renderDot(),props.i18n("dataUploadedOfTotal",{complete:prettierBytes(props.totalUploadedSize),total:prettierBytes(props.totalSize)}),renderDot(),props.i18n("xTimeLeft",{time:prettyETA(props.totalETA)})))};var UnknownProgressDetails=function UnknownProgressDetails(props){return h("div",{class:"uppy-StatusBar-statusSecondary"},props.i18n("filesUploadedOfTotal",{complete:props.complete,smart_count:props.numUploads}))};var UploadNewlyAddedFiles=function UploadNewlyAddedFiles(props){var uploadBtnClassNames=classNames("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--uploadNewlyAdded");return h("div",{class:"uppy-StatusBar-statusSecondary"},h("div",{class:"uppy-StatusBar-statusSecondaryHint"},props.i18n("xMoreFilesAdded",{smart_count:props.newFiles})),h("button",{type:"button",class:uploadBtnClassNames,"aria-label":props.i18n("uploadXFiles",{smart_count:props.newFiles}),onclick:props.startUpload},props.i18n("upload")))};var ThrottledProgressDetails=throttle(ProgressDetails,500,{leading:true,trailing:true});var ProgressBarUploading=function ProgressBarUploading(props){if(!props.isUploadStarted||props.isAllComplete){return null}var title=props.isAllPaused?props.i18n("paused"):props.i18n("uploading");var showUploadNewlyAddedFiles=props.newFiles&&props.isUploadStarted;return h("div",{class:"uppy-StatusBar-content","aria-label":title,title:title},!props.isAllPaused?h(LoadingSpinner,null):null,h("div",{class:"uppy-StatusBar-status"},h("div",{class:"uppy-StatusBar-statusPrimary"},props.supportsUploadProgress?title+": "+props.totalProgress+"%":title),!props.isAllPaused&&!showUploadNewlyAddedFiles&&props.showProgressDetails?props.supportsUploadProgress?h(ThrottledProgressDetails,props):h(UnknownProgressDetails,props):null,showUploadNewlyAddedFiles?h(UploadNewlyAddedFiles,props):null))};var ProgressBarComplete=function ProgressBarComplete(_ref){var totalProgress=_ref.totalProgress,i18n=_ref.i18n;return h("div",{class:"uppy-StatusBar-content",role:"status",title:i18n("complete")},h("div",{class:"uppy-StatusBar-status"},h("div",{class:"uppy-StatusBar-statusPrimary"},h("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"15",height:"11",viewBox:"0 0 15 11"},h("path",{d:"M.414 5.843L1.627 4.63l3.472 3.472L13.202 0l1.212 1.213L5.1 10.528z"})),i18n("complete"))))};var ProgressBarError=function ProgressBarError(_ref2){var error=_ref2.error,retryAll=_ref2.retryAll,hideRetryButton=_ref2.hideRetryButton,i18n=_ref2.i18n;function displayErrorAlert(){var errorMessage=i18n("uploadFailed")+" \n\n "+error;alert(errorMessage)}return h("div",{class:"uppy-StatusBar-content",role:"alert",title:i18n("uploadFailed")},h("div",{class:"uppy-StatusBar-status"},h("div",{class:"uppy-StatusBar-statusPrimary"},h("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"11",height:"11",viewBox:"0 0 11 11"},h("path",{d:"M4.278 5.5L0 1.222 1.222 0 5.5 4.278 9.778 0 11 1.222 6.722 5.5 11 9.778 9.778 11 5.5 6.722 1.222 11 0 9.778z"})),i18n("uploadFailed"))),h("span",{class:"uppy-StatusBar-details","aria-label":error,"data-microtip-position":"top-right","data-microtip-size":"medium",role:"tooltip",onclick:displayErrorAlert},"?"))}},{"./StatusBarStates":43,"@transloadit/prettier-bytes":6,"@uppy/utils/lib/prettyETA":77,classnames:83,"lodash.throttle":91,preact:96}],43:[function(require,module,exports){module.exports={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete"}},{}],44:[function(require,module,exports){var _class,_temp;function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}var _require=require("@uppy/core"),Plugin=_require.Plugin;var Translator=require("@uppy/utils/lib/Translator");var StatusBarUI=require("./StatusBar");var statusBarStates=require("./StatusBarStates");var getSpeed=require("@uppy/utils/lib/getSpeed");var getBytesRemaining=require("@uppy/utils/lib/getBytesRemaining");module.exports=(_temp=_class=function(_Plugin){_inheritsLoose(StatusBar,_Plugin);function StatusBar(uppy,opts){var _this;_this=_Plugin.call(this,uppy,opts)||this;_this.startUpload=function(){return _this.uppy.upload().catch(function(){})};_this.id=_this.opts.id||"StatusBar";_this.title="StatusBar";_this.type="progressindicator";_this.defaultLocale={strings:{uploading:"Uploading",upload:"Upload",complete:"Complete",uploadFailed:"Upload failed",paused:"Paused",retry:"Retry",retryUpload:"Retry upload",cancel:"Cancel",pause:"Pause",resume:"Resume",done:"Done",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},xMoreFilesAdded:{0:"%{smart_count} more file added",1:"%{smart_count} more files added"}}};var defaultOptions={target:"body",hideUploadButton:false,hideRetryButton:false,hidePauseResumeButton:false,hideCancelButton:false,showProgressDetails:false,hideAfterFinish:true,doneButtonHandler:null};_this.opts=_extends({},defaultOptions,opts);_this.i18nInit();_this.render=_this.render.bind(_assertThisInitialized(_this));_this.install=_this.install.bind(_assertThisInitialized(_this));return _this}var _proto=StatusBar.prototype;_proto.setOptions=function setOptions(newOpts){_Plugin.prototype.setOptions.call(this,newOpts);this.i18nInit()};_proto.i18nInit=function i18nInit(){this.translator=new Translator([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=this.translator.translate.bind(this.translator);this.setPluginState()};_proto.getTotalSpeed=function getTotalSpeed(files){var totalSpeed=0;files.forEach(function(file){totalSpeed=totalSpeed+getSpeed(file.progress)});return totalSpeed};_proto.getTotalETA=function getTotalETA(files){var totalSpeed=this.getTotalSpeed(files);if(totalSpeed===0){return 0}var totalBytesRemaining=files.reduce(function(total,file){return total+getBytesRemaining(file.progress)},0);return Math.round(totalBytesRemaining/totalSpeed*10)/10};_proto.getUploadingState=function getUploadingState(isAllErrored,isAllComplete,files){if(isAllErrored){return statusBarStates.STATE_ERROR}if(isAllComplete){return statusBarStates.STATE_COMPLETE}var state=statusBarStates.STATE_WAITING;var fileIDs=Object.keys(files);for(var i=0;i<fileIDs.length;i++){var progress=files[fileIDs[i]].progress;if(progress.uploadStarted&&!progress.uploadComplete){return statusBarStates.STATE_UPLOADING}if(progress.preprocess&&state!==statusBarStates.STATE_UPLOADING){state=statusBarStates.STATE_PREPROCESSING}if(progress.postprocess&&state!==statusBarStates.STATE_UPLOADING&&state!==statusBarStates.STATE_PREPROCESSING){state=statusBarStates.STATE_POSTPROCESSING}}return state};_proto.render=function render(state){var capabilities=state.capabilities,files=state.files,allowNewUpload=state.allowNewUpload,totalProgress=state.totalProgress,error=state.error;var filesArray=Object.keys(files).map(function(file){return files[file]});var newFiles=filesArray.filter(function(file){return!file.progress.uploadStarted&&!file.progress.preprocess&&!file.progress.postprocess});var uploadStartedFiles=filesArray.filter(function(file){return file.progress.uploadStarted});var pausedFiles=uploadStartedFiles.filter(function(file){return file.isPaused});var completeFiles=filesArray.filter(function(file){return file.progress.uploadComplete});var erroredFiles=filesArray.filter(function(file){return file.error});var inProgressFiles=filesArray.filter(function(file){return!file.progress.uploadComplete&&file.progress.uploadStarted});var inProgressNotPausedFiles=inProgressFiles.filter(function(file){return!file.isPaused});var startedFiles=filesArray.filter(function(file){return file.progress.uploadStarted||file.progress.preprocess||file.progress.postprocess});var processingFiles=filesArray.filter(function(file){return file.progress.preprocess||file.progress.postprocess});var totalETA=this.getTotalETA(inProgressNotPausedFiles);var totalSize=0;var totalUploadedSize=0;startedFiles.forEach(function(file){totalSize=totalSize+(file.progress.bytesTotal||0);totalUploadedSize=totalUploadedSize+(file.progress.bytesUploaded||0)});var isUploadStarted=startedFiles.length>0;var isAllComplete=totalProgress===100&&completeFiles.length===Object.keys(files).length&&processingFiles.length===0;var isAllErrored=error&&erroredFiles.length===filesArray.length;var isAllPaused=inProgressFiles.length!==0&&pausedFiles.length===inProgressFiles.length;var isUploadInProgress=inProgressFiles.length>0;var resumableUploads=capabilities.resumableUploads||false;var supportsUploadProgress=capabilities.uploadProgress!==false;return StatusBarUI({error:error,uploadState:this.getUploadingState(isAllErrored,isAllComplete,state.files||{}),allowNewUpload:allowNewUpload,totalProgress:totalProgress,totalSize:totalSize,totalUploadedSize:totalUploadedSize,isAllComplete:isAllComplete,isAllPaused:isAllPaused,isAllErrored:isAllErrored,isUploadStarted:isUploadStarted,isUploadInProgress:isUploadInProgress,complete:completeFiles.length,newFiles:newFiles.length,numUploads:startedFiles.length,totalETA:totalETA,files:files,i18n:this.i18n,pauseAll:this.uppy.pauseAll,resumeAll:this.uppy.resumeAll,retryAll:this.uppy.retryAll,cancelAll:this.uppy.cancelAll,startUpload:this.startUpload,doneButtonHandler:this.opts.doneButtonHandler,resumableUploads:resumableUploads,supportsUploadProgress:supportsUploadProgress,showProgressDetails:this.opts.showProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideAfterFinish:this.opts.hideAfterFinish,isTargetDOMEl:this.isTargetDOMEl})};_proto.install=function install(){var target=this.opts.target;if(target){this.mount(target,this)}};_proto.uninstall=function uninstall(){this.unmount()};return StatusBar}(Plugin),_class.VERSION="1.8.1",_temp)},{"./StatusBar":42,"./StatusBarStates":43,"@uppy/core":15,"@uppy/utils/lib/Translator":52,"@uppy/utils/lib/getBytesRemaining":59,"@uppy/utils/lib/getSpeed":68}],45:[function(require,module,exports){function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var DefaultStore=function(){function DefaultStore(){this.state={};this.callbacks=[]}var _proto=DefaultStore.prototype;_proto.getState=function getState(){return this.state};_proto.setState=function setState(patch){var prevState=_extends({},this.state);var nextState=_extends({},this.state,patch);this.state=nextState;this._publish(prevState,nextState,patch)};_proto.subscribe=function subscribe(listener){var _this=this;this.callbacks.push(listener);return function(){_this.callbacks.splice(_this.callbacks.indexOf(listener),1)}};_proto._publish=function _publish(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}this.callbacks.forEach(function(listener){listener.apply(void 0,args)})};return DefaultStore}();DefaultStore.VERSION="1.2.4";module.exports=function defaultStore(){return new DefaultStore}},{}],46:[function(require,module,exports){var _class,_temp;function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}var _require=require("@uppy/core"),Plugin=_require.Plugin;var Translator=require("@uppy/utils/lib/Translator");var dataURItoBlob=require("@uppy/utils/lib/dataURItoBlob");var isObjectURL=require("@uppy/utils/lib/isObjectURL");var isPreviewSupported=require("@uppy/utils/lib/isPreviewSupported");var MathLog2=require("math-log2");var exifr=require("exifr/dist/mini.legacy.umd.js");module.exports=(_temp=_class=function(_Plugin){_inheritsLoose(ThumbnailGenerator,_Plugin);function ThumbnailGenerator(uppy,opts){var _this;_this=_Plugin.call(this,uppy,opts)||this;_this.onFileAdded=function(file){if(!file.preview&&isPreviewSupported(file.type)&&!file.isRemote){_this.addToQueue(file.id)}};_this.onCancelRequest=function(file){var index=_this.queue.indexOf(file.id);if(index!==-1){_this.queue.splice(index,1)}};_this.onFileRemoved=function(file){var index=_this.queue.indexOf(file.id);if(index!==-1){_this.queue.splice(index,1)}if(file.preview&&isObjectURL(file.preview)){URL.revokeObjectURL(file.preview)}};_this.onRestored=function(){var _this$uppy$getState=_this.uppy.getState(),files=_this$uppy$getState.files;var fileIDs=Object.keys(files);fileIDs.forEach(function(fileID){var file=_this.uppy.getFile(fileID);if(!file.isRestored)return;if(!file.preview||isObjectURL(file.preview)){_this.addToQueue(file.id)}})};_this.waitUntilAllProcessed=function(fileIDs){fileIDs.forEach(function(fileID){var file=_this.uppy.getFile(fileID);_this.uppy.emit("preprocess-progress",file,{mode:"indeterminate",message:_this.i18n("generatingThumbnails")})});var emitPreprocessCompleteForAll=function emitPreprocessCompleteForAll(){fileIDs.forEach(function(fileID){var file=_this.uppy.getFile(fileID);_this.uppy.emit("preprocess-complete",file)})};return new Promise(function(resolve,reject){if(_this.queueProcessing){_this.uppy.once("thumbnail:all-generated",function(){emitPreprocessCompleteForAll();resolve()})}else{emitPreprocessCompleteForAll();resolve()}})};_this.type="modifier";_this.id=_this.opts.id||"ThumbnailGenerator";_this.title="Thumbnail Generator";_this.queue=[];_this.queueProcessing=false;_this.defaultThumbnailDimension=200;_this.thumbnailType=_this.opts.thumbnailType||"image/jpeg";_this.defaultLocale={strings:{generatingThumbnails:"Generating thumbnails..."}};var defaultOptions={thumbnailWidth:null,thumbnailHeight:null,waitForThumbnailsBeforeUpload:false,lazy:false};_this.opts=_extends({},defaultOptions,opts);if(_this.opts.lazy&&_this.opts.waitForThumbnailsBeforeUpload){throw new Error("ThumbnailGenerator: The `lazy` and `waitForThumbnailsBeforeUpload` options are mutually exclusive. Please ensure at most one of them is set to `true`.")}_this.i18nInit();return _this}var _proto=ThumbnailGenerator.prototype;_proto.setOptions=function setOptions(newOpts){_Plugin.prototype.setOptions.call(this,newOpts);this.i18nInit()};_proto.i18nInit=function i18nInit(){this.translator=new Translator([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=this.translator.translate.bind(this.translator);this.setPluginState()};_proto.createThumbnail=function createThumbnail(file,targetWidth,targetHeight){var _this2=this;var originalUrl=URL.createObjectURL(file.data);var onload=new Promise(function(resolve,reject){var image=new Image;image.src=originalUrl;image.addEventListener("load",function(){URL.revokeObjectURL(originalUrl);resolve(image)});image.addEventListener("error",function(event){URL.revokeObjectURL(originalUrl);reject(event.error||new Error("Could not create thumbnail"))})});var orientationPromise=exifr.rotation(file.data).catch(function(_err){return 1});return Promise.all([onload,orientationPromise]).then(function(_ref){var image=_ref[0],orientation=_ref[1];var dimensions=_this2.getProportionalDimensions(image,targetWidth,targetHeight,orientation.deg);var rotatedImage=_this2.rotateImage(image,orientation);var resizedImage=_this2.resizeImage(rotatedImage,dimensions.width,dimensions.height);return _this2.canvasToBlob(resizedImage,_this2.thumbnailType,80)}).then(function(blob){return URL.createObjectURL(blob)})};_proto.getProportionalDimensions=function getProportionalDimensions(img,width,height,rotation){var aspect=img.width/img.height;if(rotation===90||rotation===270){aspect=img.height/img.width}if(width!=null){return{width:width,height:Math.round(width/aspect)}}if(height!=null){return{width:Math.round(height*aspect),height:height}}return{width:this.defaultThumbnailDimension,height:Math.round(this.defaultThumbnailDimension/aspect)}};_proto.protect=function protect(image){var ratio=image.width/image.height;var maxSquare=5e6;var maxSize=4096;var maxW=Math.floor(Math.sqrt(maxSquare*ratio));var maxH=Math.floor(maxSquare/Math.sqrt(maxSquare*ratio));if(maxW>maxSize){maxW=maxSize;maxH=Math.round(maxW/ratio)}if(maxH>maxSize){maxH=maxSize;maxW=Math.round(ratio*maxH)}if(image.width>maxW){var canvas=document.createElement("canvas");canvas.width=maxW;canvas.height=maxH;canvas.getContext("2d").drawImage(image,0,0,maxW,maxH);image=canvas}return image};_proto.resizeImage=function resizeImage(image,targetWidth,targetHeight){image=this.protect(image);var steps=Math.ceil(MathLog2(image.width/targetWidth));if(steps<1){steps=1}var sW=targetWidth*Math.pow(2,steps-1);var sH=targetHeight*Math.pow(2,steps-1);var x=2;while(steps--){var canvas=document.createElement("canvas");canvas.width=sW;canvas.height=sH;canvas.getContext("2d").drawImage(image,0,0,sW,sH);image=canvas;sW=Math.round(sW/x);sH=Math.round(sH/x)}return image};_proto.rotateImage=function rotateImage(image,translate){var w=image.width;var h=image.height;if(translate.deg===90||translate.deg===270){w=image.height;h=image.width}var canvas=document.createElement("canvas");canvas.width=w;canvas.height=h;var context=canvas.getContext("2d");context.translate(w/2,h/2);if(translate.canvas){context.rotate(translate.rad);context.scale(translate.scaleX,translate.scaleY)}context.drawImage(image,-image.width/2,-image.height/2,image.width,image.height);return canvas};_proto.canvasToBlob=function canvasToBlob(canvas,type,quality){try{canvas.getContext("2d").getImageData(0,0,1,1)}catch(err){if(err.code===18){return Promise.reject(new Error("cannot read image, probably an svg with external resources"))}}if(canvas.toBlob){return new Promise(function(resolve){canvas.toBlob(resolve,type,quality)}).then(function(blob){if(blob===null){throw new Error("cannot read image, probably an svg with external resources")}return blob})}return Promise.resolve().then(function(){return dataURItoBlob(canvas.toDataURL(type,quality),{})}).then(function(blob){if(blob===null){throw new Error("could not extract blob, probably an old browser")}return blob})};_proto.setPreviewURL=function setPreviewURL(fileID,preview){this.uppy.setFileState(fileID,{preview:preview})};_proto.addToQueue=function addToQueue(item){this.queue.push(item);if(this.queueProcessing===false){this.processQueue()}};_proto.processQueue=function processQueue(){var _this3=this;this.queueProcessing=true;if(this.queue.length>0){var current=this.uppy.getFile(this.queue.shift());if(!current){this.uppy.log("[ThumbnailGenerator] file was removed before a thumbnail could be generated, but not removed from the queue. This is probably a bug","error");return}return this.requestThumbnail(current).catch(function(err){}).then(function(){return _this3.processQueue()})}else{this.queueProcessing=false;this.uppy.log("[ThumbnailGenerator] Emptied thumbnail queue");this.uppy.emit("thumbnail:all-generated")}};_proto.requestThumbnail=function requestThumbnail(file){var _this4=this;if(isPreviewSupported(file.type)&&!file.isRemote){return this.createThumbnail(file,this.opts.thumbnailWidth,this.opts.thumbnailHeight).then(function(preview){_this4.setPreviewURL(file.id,preview);_this4.uppy.log("[ThumbnailGenerator] Generated thumbnail for "+file.id);_this4.uppy.emit("thumbnail:generated",_this4.uppy.getFile(file.id),preview)}).catch(function(err){_this4.uppy.log("[ThumbnailGenerator] Failed thumbnail for "+file.id+":","warning");_this4.uppy.log(err,"warning");_this4.uppy.emit("thumbnail:error",_this4.uppy.getFile(file.id),err)})}return Promise.resolve()};_proto.install=function install(){this.uppy.on("file-removed",this.onFileRemoved);if(this.opts.lazy){this.uppy.on("thumbnail:request",this.onFileAdded);this.uppy.on("thumbnail:cancel",this.onCancelRequest)}else{this.uppy.on("file-added",this.onFileAdded);this.uppy.on("restored",this.onRestored)}if(this.opts.waitForThumbnailsBeforeUpload){this.uppy.addPreProcessor(this.waitUntilAllProcessed)}};_proto.uninstall=function uninstall(){this.uppy.off("file-removed",this.onFileRemoved);if(this.opts.lazy){this.uppy.off("thumbnail:request",this.onFileAdded);this.uppy.off("thumbnail:cancel",this.onCancelRequest)}else{this.uppy.off("file-added",this.onFileAdded);this.uppy.off("restored",this.onRestored)}if(this.opts.waitForThumbnailsBeforeUpload){this.uppy.removePreProcessor(this.waitUntilAllProcessed)}};return ThumbnailGenerator}(Plugin),_class.VERSION="1.7.3",_temp)},{"@uppy/core":15,"@uppy/utils/lib/Translator":52,"@uppy/utils/lib/dataURItoBlob":53,"@uppy/utils/lib/isObjectURL":74,"@uppy/utils/lib/isPreviewSupported":75,"exifr/dist/mini.legacy.umd.js":88,"math-log2":92}],47:[function(require,module,exports){module.exports=function(){function EventTracker(emitter){this._events=[];this._emitter=emitter}var _proto=EventTracker.prototype;_proto.on=function on(event,fn){this._events.push([event,fn]);return this._emitter.on(event,fn)};_proto.remove=function remove(){var _this=this;this._events.forEach(function(_ref){var event=_ref[0],fn=_ref[1];_this._emitter.off(event,fn)})};return EventTracker}()},{}],48:[function(require,module,exports){module.exports=['a[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','area[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])',"input:not([disabled]):not([inert]):not([aria-hidden])","select:not([disabled]):not([inert]):not([aria-hidden])","textarea:not([disabled]):not([inert]):not([aria-hidden])","button:not([disabled]):not([inert]):not([aria-hidden])",'iframe:not([tabindex^="-"]):not([inert]):not([aria-hidden])','object:not([tabindex^="-"]):not([inert]):not([aria-hidden])','embed:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[contenteditable]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[tabindex]:not([tabindex^="-"]):not([inert]):not([aria-hidden])']},{}],49:[function(require,module,exports){function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}function _wrapNativeSuper(Class){var _cache=typeof Map==="function"?new Map:undefined;_wrapNativeSuper=function _wrapNativeSuper(Class){if(Class===null||!_isNativeFunction(Class))return Class;if(typeof Class!=="function"){throw new TypeError("Super expression must either be null or a function")}if(typeof _cache!=="undefined"){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:false,writable:true,configurable:true}});return _setPrototypeOf(Wrapper,Class)};return _wrapNativeSuper(Class)}function _construct(Parent,args,Class){if(_isNativeReflectConstruct()){_construct=Reflect.construct}else{_construct=function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var Constructor=Function.bind.apply(Parent,a);var instance=new Constructor;if(Class)_setPrototypeOf(instance,Class.prototype);return instance}}return _construct.apply(null,arguments)}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}function _isNativeFunction(fn){return Function.toString.call(fn).indexOf("[native code]")!==-1}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}var NetworkError=function(_Error){_inheritsLoose(NetworkError,_Error);function NetworkError(error,xhr){var _this;if(xhr===void 0){xhr=null}_this=_Error.call(this,"This looks like a network error, the endpoint might be blocked by an internet provider or a firewall.\n\nSource error: ["+error+"]")||this;_this.isNetworkError=true;_this.request=xhr;return _this}return NetworkError}(_wrapNativeSuper(Error));module.exports=NetworkError},{}],50:[function(require,module,exports){var ProgressTimeout=function(){function ProgressTimeout(timeout,timeoutHandler){this._timeout=timeout;this._onTimedOut=timeoutHandler;this._isDone=false;this._aliveTimer=null;this._onTimedOut=this._onTimedOut.bind(this)}var _proto=ProgressTimeout.prototype;_proto.progress=function progress(){if(this._isDone)return;if(this._timeout>0){if(this._aliveTimer)clearTimeout(this._aliveTimer);this._aliveTimer=setTimeout(this._onTimedOut,this._timeout)}};_proto.done=function done(){if(this._aliveTimer){clearTimeout(this._aliveTimer);this._aliveTimer=null}this._isDone=true};return ProgressTimeout}();module.exports=ProgressTimeout},{}],51:[function(require,module,exports){function findIndex(array,predicate){for(var i=0;i<array.length;i++){if(predicate(array[i]))return i}return-1}function createCancelError(){return new Error("Cancelled")}module.exports=function(){function RateLimitedQueue(limit){if(typeof limit!=="number"||limit===0){this.limit=Infinity}else{this.limit=limit}this.activeRequests=0;this.queuedHandlers=[]}var _proto=RateLimitedQueue.prototype;_proto._call=function _call(fn){var _this=this;this.activeRequests+=1;var _done=false;var cancelActive;try{cancelActive=fn()}catch(err){this.activeRequests-=1;throw err}return{abort:function abort(){if(_done)return;_done=true;_this.activeRequests-=1;cancelActive();_this._queueNext()},done:function done(){if(_done)return;_done=true;_this.activeRequests-=1;_this._queueNext()}}};_proto._queueNext=function _queueNext(){var _this2=this;Promise.resolve().then(function(){_this2._next()})};_proto._next=function _next(){if(this.activeRequests>=this.limit){return}if(this.queuedHandlers.length===0){return}var next=this.queuedHandlers.shift();var handler=this._call(next.fn);next.abort=handler.abort;next.done=handler.done};_proto._queue=function _queue(fn,options){var _this3=this;if(options===void 0){options={}}var handler={fn:fn,priority:options.priority||0,abort:function abort(){_this3._dequeue(handler)},done:function done(){throw new Error("Cannot mark a queued request as done: this indicates a bug")}};var index=findIndex(this.queuedHandlers,function(other){return handler.priority>other.priority});if(index===-1){this.queuedHandlers.push(handler)}else{this.queuedHandlers.splice(index,0,handler)}return handler};_proto._dequeue=function _dequeue(handler){var index=this.queuedHandlers.indexOf(handler);if(index!==-1){this.queuedHandlers.splice(index,1)}};_proto.run=function run(fn,queueOptions){if(this.activeRequests<this.limit){return this._call(fn)}return this._queue(fn,queueOptions)};_proto.wrapPromiseFunction=function wrapPromiseFunction(fn,queueOptions){var _this4=this;return function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}var queuedRequest;var outerPromise=new Promise(function(resolve,reject){queuedRequest=_this4.run(function(){var cancelError;var innerPromise;try{innerPromise=Promise.resolve(fn.apply(void 0,args))}catch(err){innerPromise=Promise.reject(err)}innerPromise.then(function(result){if(cancelError){reject(cancelError)}else{queuedRequest.done();resolve(result)}},function(err){if(cancelError){reject(cancelError)}else{queuedRequest.done();reject(err)}});return function(){cancelError=createCancelError()}},queueOptions)});outerPromise.abort=function(){queuedRequest.abort()};return outerPromise}};return RateLimitedQueue}()},{}],52:[function(require,module,exports){function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var has=require("./hasProperty");module.exports=function(){function Translator(locales){var _this=this;this.locale={strings:{},pluralize:function pluralize(n){if(n===1){return 0}return 1}};if(Array.isArray(locales)){locales.forEach(function(locale){return _this._apply(locale)})}else{this._apply(locales)}}var _proto=Translator.prototype;_proto._apply=function _apply(locale){if(!locale||!locale.strings){return}var prevLocale=this.locale;this.locale=_extends({},prevLocale,{strings:_extends({},prevLocale.strings,locale.strings)});this.locale.pluralize=locale.pluralize||prevLocale.pluralize};_proto.interpolate=function interpolate(phrase,options){var _String$prototype=String.prototype,split=_String$prototype.split,replace=_String$prototype.replace;var dollarRegex=/\$/g;var dollarBillsYall="$$$$";var interpolated=[phrase];for(var arg in options){if(arg!=="_"&&has(options,arg)){var replacement=options[arg];if(typeof replacement==="string"){replacement=replace.call(options[arg],dollarRegex,dollarBillsYall)}interpolated=insertReplacement(interpolated,new RegExp("%\\{"+arg+"\\}","g"),replacement)}}return interpolated;function insertReplacement(source,rx,replacement){var newParts=[];source.forEach(function(chunk){if(typeof chunk!=="string"){return newParts.push(chunk)}split.call(chunk,rx).forEach(function(raw,i,list){if(raw!==""){newParts.push(raw)}if(i<list.length-1){newParts.push(replacement)}})});return newParts}};_proto.translate=function translate(key,options){return this.translateArray(key,options).join("")};_proto.translateArray=function translateArray(key,options){if(!has(this.locale.strings,key)){throw new Error("missing string: "+key)}var string=this.locale.strings[key];var hasPluralForms=typeof string==="object";if(hasPluralForms){if(options&&typeof options.smart_count!=="undefined"){var plural=this.locale.pluralize(options.smart_count);return this.interpolate(string[plural],options)}else{throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}}return this.interpolate(string,options)};return Translator}()},{"./hasProperty":70}],53:[function(require,module,exports){module.exports=function dataURItoBlob(dataURI,opts,toFile){var data=dataURI.split(",")[1];var mimeType=opts.mimeType||dataURI.split(",")[0].split(":")[1].split(";")[0];if(mimeType==null){mimeType="plain/text"}var binary=atob(data);var array=[];for(var i=0;i<binary.length;i++){array.push(binary.charCodeAt(i))}var bytes;try{bytes=new Uint8Array(array)}catch(err){return null}if(toFile){return new File([bytes],opts.name||"",{type:mimeType})}return new Blob([bytes],{type:mimeType})}},{}],54:[function(require,module,exports){var throttle=require("lodash.throttle");function _emitSocketProgress(uploader,progressData,file){var progress=progressData.progress,bytesUploaded=progressData.bytesUploaded,bytesTotal=progressData.bytesTotal;if(progress){uploader.uppy.log("Upload progress: "+progress);uploader.uppy.emit("upload-progress",file,{uploader:uploader,bytesUploaded:bytesUploaded,bytesTotal:bytesTotal})}}module.exports=throttle(_emitSocketProgress,300,{leading:true,trailing:true})},{"lodash.throttle":91}],55:[function(require,module,exports){var NetworkError=require("@uppy/utils/lib/NetworkError");module.exports=function fetchWithNetworkError(){return fetch.apply(void 0,arguments).catch(function(err){if(err.name==="AbortError"){throw err}else{throw new NetworkError(err)}})}},{"@uppy/utils/lib/NetworkError":49}],56:[function(require,module,exports){var isDOMElement=require("./isDOMElement");module.exports=function findAllDOMElements(element){if(typeof element==="string"){var elements=[].slice.call(document.querySelectorAll(element));return elements.length>0?elements:null}if(typeof element==="object"&&isDOMElement(element)){return[element]}}},{"./isDOMElement":71}],57:[function(require,module,exports){var isDOMElement=require("./isDOMElement");module.exports=function findDOMElement(element,context){if(context===void 0){context=document}if(typeof element==="string"){return context.querySelector(element)}if(isDOMElement(element)){return element}}},{"./isDOMElement":71}],58:[function(require,module,exports){module.exports=function generateFileID(file){var id="uppy";if(typeof file.name==="string"){id+="-"+encodeFilename(file.name.toLowerCase())}if(file.type!==undefined){id+="-"+file.type}if(file.meta&&typeof file.meta.relativePath==="string"){id+="-"+encodeFilename(file.meta.relativePath.toLowerCase())}if(file.data.size!==undefined){id+="-"+file.data.size}if(file.data.lastModified!==undefined){id+="-"+file.data.lastModified}return id};function encodeFilename(name){var suffix="";return name.replace(/[^A-Z0-9]/gi,function(character){suffix+="-"+encodeCharacter(character);return"/"})+suffix}function encodeCharacter(character){return character.charCodeAt(0).toString(32)}},{}],59:[function(require,module,exports){module.exports=function getBytesRemaining(fileProgress){return fileProgress.bytesTotal-fileProgress.bytesUploaded}},{}],60:[function(require,module,exports){var webkitGetAsEntryApi=require("./utils/webkitGetAsEntryApi/index");var fallbackApi=require("./utils/fallbackApi");module.exports=function getDroppedFiles(dataTransfer,_temp){var _ref=_temp===void 0?{}:_temp,_ref$logDropError=_ref.logDropError,logDropError=_ref$logDropError===void 0?function(){}:_ref$logDropError;if(dataTransfer.items&&dataTransfer.items[0]&&"webkitGetAsEntry"in dataTransfer.items[0]){return webkitGetAsEntryApi(dataTransfer,logDropError)}else{return fallbackApi(dataTransfer)}}},{"./utils/fallbackApi":61,"./utils/webkitGetAsEntryApi/index":64}],61:[function(require,module,exports){var toArray=require("../../toArray");module.exports=function fallbackApi(dataTransfer){var files=toArray(dataTransfer.files);return Promise.resolve(files)}},{"../../toArray":80}],62:[function(require,module,exports){module.exports=function getFilesAndDirectoriesFromDirectory(directoryReader,oldEntries,logDropError,_ref){var onSuccess=_ref.onSuccess;directoryReader.readEntries(function(entries){var newEntries=[].concat(oldEntries,entries);if(entries.length){setTimeout(function(){getFilesAndDirectoriesFromDirectory(directoryReader,newEntries,logDropError,{onSuccess:onSuccess})},0)}else{onSuccess(newEntries)}},function(error){logDropError(error);onSuccess(oldEntries)})}},{}],63:[function(require,module,exports){module.exports=function getRelativePath(fileEntry){if(!fileEntry.fullPath||fileEntry.fullPath==="/"+fileEntry.name){return null}else{return fileEntry.fullPath}}},{}],64:[function(require,module,exports){var toArray=require("../../../toArray");var getRelativePath=require("./getRelativePath");var getFilesAndDirectoriesFromDirectory=require("./getFilesAndDirectoriesFromDirectory");module.exports=function webkitGetAsEntryApi(dataTransfer,logDropError){var files=[];var rootPromises=[];var createPromiseToAddFileOrParseDirectory=function createPromiseToAddFileOrParseDirectory(entry){return new Promise(function(resolve){if(entry.isFile){entry.file(function(file){file.relativePath=getRelativePath(entry);files.push(file);resolve()},function(error){logDropError(error);resolve()})}else if(entry.isDirectory){var directoryReader=entry.createReader();getFilesAndDirectoriesFromDirectory(directoryReader,[],logDropError,{onSuccess:function onSuccess(entries){var promises=entries.map(function(entry){return createPromiseToAddFileOrParseDirectory(entry)});Promise.all(promises).then(function(){return resolve()})}})}})};toArray(dataTransfer.items).forEach(function(item){var entry=item.webkitGetAsEntry();if(entry){rootPromises.push(createPromiseToAddFileOrParseDirectory(entry))}});return Promise.all(rootPromises).then(function(){return files})}},{"../../../toArray":80,"./getFilesAndDirectoriesFromDirectory":62,"./getRelativePath":63}],65:[function(require,module,exports){module.exports=function getFileNameAndExtension(fullFileName){var lastDot=fullFileName.lastIndexOf(".");if(lastDot===-1||lastDot===fullFileName.length-1){return{name:fullFileName,extension:undefined}}else{return{name:fullFileName.slice(0,lastDot),extension:fullFileName.slice(lastDot+1)}}}},{}],66:[function(require,module,exports){var getFileNameAndExtension=require("./getFileNameAndExtension");var mimeTypes=require("./mimeTypes");module.exports=function getFileType(file){var fileExtension=file.name?getFileNameAndExtension(file.name).extension:null;fileExtension=fileExtension?fileExtension.toLowerCase():null;if(file.type){return file.type}else if(fileExtension&&mimeTypes[fileExtension]){return mimeTypes[fileExtension]}else{return"application/octet-stream"}}},{"./getFileNameAndExtension":65,"./mimeTypes":76}],67:[function(require,module,exports){module.exports=function getSocketHost(url){var regex=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?(?:www\.)?([^\n]+)/i;var host=regex.exec(url)[1];var socketProtocol=/^http:\/\//i.test(url)?"ws":"wss";return socketProtocol+"://"+host}},{}],68:[function(require,module,exports){module.exports=function getSpeed(fileProgress){if(!fileProgress.bytesUploaded)return 0;var timeElapsed=new Date-fileProgress.uploadStarted;var uploadSpeed=fileProgress.bytesUploaded/(timeElapsed/1e3);return uploadSpeed}},{}],69:[function(require,module,exports){module.exports=function getTimeStamp(){var date=new Date;var hours=pad(date.getHours().toString());var minutes=pad(date.getMinutes().toString());var seconds=pad(date.getSeconds().toString());return hours+":"+minutes+":"+seconds};function pad(str){return str.length!==2?0+str:str}},{}],70:[function(require,module,exports){module.exports=function has(object,key){return Object.prototype.hasOwnProperty.call(object,key)}},{}],71:[function(require,module,exports){module.exports=function isDOMElement(obj){return obj&&typeof obj==="object"&&obj.nodeType===Node.ELEMENT_NODE}},{}],72:[function(require,module,exports){module.exports=function isDragDropSupported(){var div=document.createElement("div");if(!("draggable"in div)||!("ondragstart"in div&&"ondrop"in div)){return false}if(!("FormData"in window)){return false}if(!("FileReader"in window)){return false}return true}},{}],73:[function(require,module,exports){function isNetworkError(xhr){if(!xhr){return false}return xhr.readyState!==0&&xhr.readyState!==4||xhr.status===0}module.exports=isNetworkError},{}],74:[function(require,module,exports){module.exports=function isObjectURL(url){return url.indexOf("blob:")===0}},{}],75:[function(require,module,exports){module.exports=function isPreviewSupported(fileType){if(!fileType)return false;var fileTypeSpecific=fileType.split("/")[1];if(/^(jpe?g|gif|png|svg|svg\+xml|bmp|webp|avif)$/.test(fileTypeSpecific)){return true}return false}},{}],76:[function(require,module,exports){module.exports={md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",doc:"application/msword",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"}},{}],77:[function(require,module,exports){var secondsToTime=require("./secondsToTime");module.exports=function prettyETA(seconds){var time=secondsToTime(seconds);var hoursStr=time.hours?time.hours+"h ":"";var minutesVal=time.hours?("0"+time.minutes).substr(-2):time.minutes;var minutesStr=minutesVal?minutesVal+"m":"";var secondsVal=minutesVal?("0"+time.seconds).substr(-2):time.seconds;var secondsStr=time.hours?"":minutesVal?" "+secondsVal+"s":secondsVal+"s";return""+hoursStr+minutesStr+secondsStr}},{"./secondsToTime":78}],78:[function(require,module,exports){module.exports=function secondsToTime(rawSeconds){var hours=Math.floor(rawSeconds/3600)%24;var minutes=Math.floor(rawSeconds/60)%60;var seconds=Math.floor(rawSeconds%60);return{hours:hours,minutes:minutes,seconds:seconds}}},{}],79:[function(require,module,exports){module.exports=function settle(promises){var resolutions=[];var rejections=[];function resolved(value){resolutions.push(value)}function rejected(error){rejections.push(error)}var wait=Promise.all(promises.map(function(promise){return promise.then(resolved,rejected)}));return wait.then(function(){return{successful:resolutions,failed:rejections}})}},{}],80:[function(require,module,exports){module.exports=function toArray(list){return Array.prototype.slice.call(list||[],0)}},{}],81:[function(require,module,exports){module.exports=function truncateString(string,maxLength){var separator="...";if(string.length<=maxLength){return string}else if(maxLength<=separator.length){return string.substr(0,maxLength)}else{var charsToShow=maxLength-separator.length;var frontChars=Math.ceil(charsToShow/2);var backChars=Math.floor(charsToShow/2);return string.substr(0,frontChars)+separator+string.substr(string.length-backChars)}}},{}],82:[function(require,module,exports){var _class,_temp;function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=subClass;subClass.__proto__=superClass}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}var _require=require("@uppy/core"),Plugin=_require.Plugin;var cuid=require("cuid");var Translator=require("@uppy/utils/lib/Translator");var _require2=require("@uppy/companion-client"),Provider=_require2.Provider,RequestClient=_require2.RequestClient,Socket=_require2.Socket;var emitSocketProgress=require("@uppy/utils/lib/emitSocketProgress");var getSocketHost=require("@uppy/utils/lib/getSocketHost");var settle=require("@uppy/utils/lib/settle");var EventTracker=require("@uppy/utils/lib/EventTracker");var ProgressTimeout=require("@uppy/utils/lib/ProgressTimeout");var RateLimitedQueue=require("@uppy/utils/lib/RateLimitedQueue");var NetworkError=require("@uppy/utils/lib/NetworkError");var isNetworkError=require("@uppy/utils/lib/isNetworkError");function buildResponseError(xhr,error){if(!error)error=new Error("Upload error");if(typeof error==="string")error=new Error(error);if(!(error instanceof Error)){error=_extends(new Error("Upload error"),{data:error})}if(isNetworkError(xhr)){error=new NetworkError(error,xhr);return error}error.request=xhr;return error}function setTypeInBlob(file){var dataWithUpdatedType=file.data.slice(0,file.data.size,file.meta.type);return dataWithUpdatedType}module.exports=(_temp=_class=function(_Plugin){_inheritsLoose(XHRUpload,_Plugin);function XHRUpload(uppy,opts){var _this;_this=_Plugin.call(this,uppy,opts)||this;_this.type="uploader";_this.id=_this.opts.id||"XHRUpload";_this.title="XHRUpload";_this.defaultLocale={strings:{timedOut:"Upload stalled for %{seconds} seconds, aborting."}};var defaultOptions={formData:true,fieldName:"files[]",method:"post",metaFields:null,responseUrlFieldName:"url",bundle:false,headers:{},timeout:30*1e3,limit:0,withCredentials:false,responseType:"",getResponseData:function getResponseData(responseText,response){var parsedResponse={};try{parsedResponse=JSON.parse(responseText)}catch(err){console.log(err)}return parsedResponse},getResponseError:function getResponseError(responseText,response){var error=new Error("Upload error");if(isNetworkError(response)){error=new NetworkError(error,response)}return error},validateStatus:function validateStatus(status,responseText,response){return status>=200&&status<300}};_this.opts=_extends({},defaultOptions,opts);_this.i18nInit();_this.handleUpload=_this.handleUpload.bind(_assertThisInitialized(_this));if(_this.opts.__queue instanceof RateLimitedQueue){_this.requests=_this.opts.__queue}else{_this.requests=new RateLimitedQueue(_this.opts.limit)}if(_this.opts.bundle&&!_this.opts.formData){throw new Error("`opts.formData` must be true when `opts.bundle` is enabled.")}_this.uploaderEvents=Object.create(null);return _this}var _proto=XHRUpload.prototype;_proto.setOptions=function setOptions(newOpts){_Plugin.prototype.setOptions.call(this,newOpts);this.i18nInit()};_proto.i18nInit=function i18nInit(){this.translator=new Translator([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=this.translator.translate.bind(this.translator);this.setPluginState()};_proto.getOptions=function getOptions(file){var overrides=this.uppy.getState().xhrUpload;var opts=_extends({},this.opts,overrides||{},file.xhrUpload||{},{headers:{}});_extends(opts.headers,this.opts.headers);if(overrides){_extends(opts.headers,overrides.headers)}if(file.xhrUpload){_extends(opts.headers,file.xhrUpload.headers)}return opts};_proto.addMetadata=function addMetadata(formData,meta,opts){var metaFields=Array.isArray(opts.metaFields)?opts.metaFields:Object.keys(meta);metaFields.forEach(function(item){formData.append(item,meta[item])})};_proto.createFormDataUpload=function createFormDataUpload(file,opts){var formPost=new FormData;this.addMetadata(formPost,file.meta,opts);var dataWithUpdatedType=setTypeInBlob(file);if(file.name){formPost.append(opts.fieldName,dataWithUpdatedType,file.meta.name)}else{formPost.append(opts.fieldName,dataWithUpdatedType)}return formPost};_proto.createBundledUpload=function createBundledUpload(files,opts){var _this2=this;var formPost=new FormData;var _this$uppy$getState=this.uppy.getState(),meta=_this$uppy$getState.meta;this.addMetadata(formPost,meta,opts);files.forEach(function(file){var opts=_this2.getOptions(file);var dataWithUpdatedType=setTypeInBlob(file);if(file.name){formPost.append(opts.fieldName,dataWithUpdatedType,file.name)}else{formPost.append(opts.fieldName,dataWithUpdatedType)}});return formPost};_proto.createBareUpload=function createBareUpload(file,opts){return file.data};_proto.upload=function upload(file,current,total){var _this3=this;var opts=this.getOptions(file);this.uppy.log("uploading "+current+" of "+total);return new Promise(function(resolve,reject){_this3.uppy.emit("upload-started",file);var data=opts.formData?_this3.createFormDataUpload(file,opts):_this3.createBareUpload(file,opts);var xhr=new XMLHttpRequest;_this3.uploaderEvents[file.id]=new EventTracker(_this3.uppy);var timer=new ProgressTimeout(opts.timeout,function(){xhr.abort();queuedRequest.done();var error=new Error(_this3.i18n("timedOut",{seconds:Math.ceil(opts.timeout/1e3)}));_this3.uppy.emit("upload-error",file,error);reject(error)});var id=cuid();xhr.upload.addEventListener("loadstart",function(ev){_this3.uppy.log("[XHRUpload] "+id+" started")});xhr.upload.addEventListener("progress",function(ev){_this3.uppy.log("[XHRUpload] "+id+" progress: "+ev.loaded+" / "+ev.total);timer.progress();if(ev.lengthComputable){_this3.uppy.emit("upload-progress",file,{uploader:_this3,bytesUploaded:ev.loaded,bytesTotal:ev.total})}});xhr.addEventListener("load",function(ev){_this3.uppy.log("[XHRUpload] "+id+" finished");timer.done();queuedRequest.done();if(_this3.uploaderEvents[file.id]){_this3.uploaderEvents[file.id].remove();_this3.uploaderEvents[file.id]=null}if(opts.validateStatus(ev.target.status,xhr.responseText,xhr)){var body=opts.getResponseData(xhr.responseText,xhr);var uploadURL=body[opts.responseUrlFieldName];var uploadResp={status:ev.target.status,body:body,uploadURL:uploadURL};_this3.uppy.emit("upload-success",file,uploadResp);if(uploadURL){_this3.uppy.log("Download "+file.name+" from "+uploadURL)}return resolve(file)}else{var _body=opts.getResponseData(xhr.responseText,xhr);var error=buildResponseError(xhr,opts.getResponseError(xhr.responseText,xhr));var response={status:ev.target.status,body:_body};_this3.uppy.emit("upload-error",file,error,response);return reject(error)}});xhr.addEventListener("error",function(ev){_this3.uppy.log("[XHRUpload] "+id+" errored");timer.done();queuedRequest.done();if(_this3.uploaderEvents[file.id]){_this3.uploaderEvents[file.id].remove();_this3.uploaderEvents[file.id]=null}var error=buildResponseError(xhr,opts.getResponseError(xhr.responseText,xhr));_this3.uppy.emit("upload-error",file,error);return reject(error)});xhr.open(opts.method.toUpperCase(),opts.endpoint,true);xhr.withCredentials=opts.withCredentials;if(opts.responseType!==""){xhr.responseType=opts.responseType}Object.keys(opts.headers).forEach(function(header){xhr.setRequestHeader(header,opts.headers[header])});var queuedRequest=_this3.requests.run(function(){xhr.send(data);return function(){timer.done();xhr.abort()}});_this3.onFileRemove(file.id,function(){queuedRequest.abort();reject(new Error("File removed"))});_this3.onCancelAll(file.id,function(){queuedRequest.abort();reject(new Error("Upload cancelled"))})})};_proto.uploadRemote=function uploadRemote(file,current,total){var _this4=this;var opts=this.getOptions(file);return new Promise(function(resolve,reject){_this4.uppy.emit("upload-started",file);var fields={};var metaFields=Array.isArray(opts.metaFields)?opts.metaFields:Object.keys(file.meta);metaFields.forEach(function(name){fields[name]=file.meta[name]});var Client=file.remote.providerOptions.provider?Provider:RequestClient;var client=new Client(_this4.uppy,file.remote.providerOptions);client.post(file.remote.url,_extends({},file.remote.body,{endpoint:opts.endpoint,size:file.data.size,fieldname:opts.fieldName,metadata:fields,httpMethod:opts.method,useFormData:opts.formData,headers:opts.headers})).then(function(res){var token=res.token;var host=getSocketHost(file.remote.companionUrl);var socket=new Socket({target:host+"/api/"+token,autoOpen:false});_this4.uploaderEvents[file.id]=new EventTracker(_this4.uppy);_this4.onFileRemove(file.id,function(){socket.send("pause",{});queuedRequest.abort();resolve("upload "+file.id+" was removed")});_this4.onCancelAll(file.id,function(){socket.send("pause",{});queuedRequest.abort();resolve("upload "+file.id+" was canceled")});_this4.onRetry(file.id,function(){socket.send("pause",{});socket.send("resume",{})});_this4.onRetryAll(file.id,function(){socket.send("pause",{});socket.send("resume",{})});socket.on("progress",function(progressData){return emitSocketProgress(_this4,progressData,file)});socket.on("success",function(data){var body=opts.getResponseData(data.response.responseText,data.response);var uploadURL=body[opts.responseUrlFieldName];var uploadResp={status:data.response.status,body:body,uploadURL:uploadURL};_this4.uppy.emit("upload-success",file,uploadResp);queuedRequest.done();if(_this4.uploaderEvents[file.id]){_this4.uploaderEvents[file.id].remove();_this4.uploaderEvents[file.id]=null}return resolve()});socket.on("error",function(errData){var resp=errData.response;var error=resp?opts.getResponseError(resp.responseText,resp):_extends(new Error(errData.error.message),{cause:errData.error});_this4.uppy.emit("upload-error",file,error);queuedRequest.done();if(_this4.uploaderEvents[file.id]){_this4.uploaderEvents[file.id].remove();_this4.uploaderEvents[file.id]=null}reject(error)});var queuedRequest=_this4.requests.run(function(){socket.open();if(file.isPaused){socket.send("pause",{})}return function(){return socket.close()}})}).catch(function(err){_this4.uppy.emit("upload-error",file,err);reject(err)})})};_proto.uploadBundle=function uploadBundle(files){var _this5=this;return new Promise(function(resolve,reject){var endpoint=_this5.opts.endpoint;var method=_this5.opts.method;var optsFromState=_this5.uppy.getState().xhrUpload;var formData=_this5.createBundledUpload(files,_extends({},_this5.opts,optsFromState||{}));var xhr=new XMLHttpRequest;var timer=new ProgressTimeout(_this5.opts.timeout,function(){xhr.abort();var error=new Error(_this5.i18n("timedOut",{seconds:Math.ceil(_this5.opts.timeout/1e3)}));emitError(error);reject(error)});var emitError=function emitError(error){files.forEach(function(file){_this5.uppy.emit("upload-error",file,error)})};xhr.upload.addEventListener("loadstart",function(ev){_this5.uppy.log("[XHRUpload] started uploading bundle");timer.progress()});xhr.upload.addEventListener("progress",function(ev){timer.progress();if(!ev.lengthComputable)return;files.forEach(function(file){_this5.uppy.emit("upload-progress",file,{uploader:_this5,bytesUploaded:ev.loaded/ev.total*file.size,bytesTotal:file.size})})});xhr.addEventListener("load",function(ev){timer.done();if(_this5.opts.validateStatus(ev.target.status,xhr.responseText,xhr)){var body=_this5.opts.getResponseData(xhr.responseText,xhr);var uploadResp={status:ev.target.status,body:body};files.forEach(function(file){_this5.uppy.emit("upload-success",file,uploadResp)});return resolve()}var error=_this5.opts.getResponseError(xhr.responseText,xhr)||new Error("Upload error");error.request=xhr;emitError(error);return reject(error)});xhr.addEventListener("error",function(ev){timer.done();var error=_this5.opts.getResponseError(xhr.responseText,xhr)||new Error("Upload error");emitError(error);return reject(error)});_this5.uppy.on("cancel-all",function(){timer.done();xhr.abort()});xhr.open(method.toUpperCase(),endpoint,true);xhr.withCredentials=_this5.opts.withCredentials;if(_this5.opts.responseType!==""){xhr.responseType=_this5.opts.responseType}Object.keys(_this5.opts.headers).forEach(function(header){xhr.setRequestHeader(header,_this5.opts.headers[header])});xhr.send(formData);files.forEach(function(file){_this5.uppy.emit("upload-started",file)})})};_proto.uploadFiles=function uploadFiles(files){var _this6=this;var promises=files.map(function(file,i){var current=parseInt(i,10)+1;var total=files.length;if(file.error){return Promise.reject(new Error(file.error))}else if(file.isRemote){return _this6.uploadRemote(file,current,total)}else{return _this6.upload(file,current,total)}});return settle(promises)};_proto.onFileRemove=function onFileRemove(fileID,cb){this.uploaderEvents[fileID].on("file-removed",function(file){if(fileID===file.id)cb(file.id)})};_proto.onRetry=function onRetry(fileID,cb){this.uploaderEvents[fileID].on("upload-retry",function(targetFileID){if(fileID===targetFileID){cb()}})};_proto.onRetryAll=function onRetryAll(fileID,cb){var _this7=this;this.uploaderEvents[fileID].on("retry-all",function(filesToRetry){if(!_this7.uppy.getFile(fileID))return;cb()})};_proto.onCancelAll=function onCancelAll(fileID,cb){var _this8=this;this.uploaderEvents[fileID].on("cancel-all",function(){if(!_this8.uppy.getFile(fileID))return;cb()})};_proto.handleUpload=function handleUpload(fileIDs){var _this9=this;if(fileIDs.length===0){this.uppy.log("[XHRUpload] No files to upload!");return Promise.resolve()}if(this.opts.limit===0&&!this.opts.__queue){this.uppy.log("[XHRUpload] When uploading multiple files at once, consider setting the `limit` option (to `10` for example), to limit the number of concurrent uploads, which helps prevent memory and network issues: https://uppy.io/docs/xhr-upload/#limit-0","warning")}this.uppy.log("[XHRUpload] Uploading...");var files=fileIDs.map(function(fileID){return _this9.uppy.getFile(fileID)});if(this.opts.bundle){var isSomeFileRemote=files.some(function(file){return file.isRemote});if(isSomeFileRemote){throw new Error("Can’t upload remote files when bundle: true option is set")}return this.uploadBundle(files)}return this.uploadFiles(files).then(function(){return null})};_proto.install=function install(){if(this.opts.bundle){var _this$uppy$getState2=this.uppy.getState(),capabilities=_this$uppy$getState2.capabilities;this.uppy.setState({capabilities:_extends({},capabilities,{individualCancellation:false})})}this.uppy.addUploader(this.handleUpload)};_proto.uninstall=function uninstall(){if(this.opts.bundle){var _this$uppy$getState3=this.uppy.getState(),capabilities=_this$uppy$getState3.capabilities;this.uppy.setState({capabilities:_extends({},capabilities,{individualCancellation:true})})}this.uppy.removeUploader(this.handleUpload)};return XHRUpload}(Plugin),_class.VERSION="1.6.8",_temp)},{"@uppy/companion-client":12,"@uppy/core":15,"@uppy/utils/lib/EventTracker":47,"@uppy/utils/lib/NetworkError":49,"@uppy/utils/lib/ProgressTimeout":50,"@uppy/utils/lib/RateLimitedQueue":51,"@uppy/utils/lib/Translator":52,"@uppy/utils/lib/emitSocketProgress":54,"@uppy/utils/lib/getSocketHost":67,"@uppy/utils/lib/isNetworkError":73,"@uppy/utils/lib/settle":79,cuid:84}],83:[function(require,module,exports){(function(){"use strict";var hasOwn={}.hasOwnProperty;function classNames(){var classes=[];for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(!arg)continue;var argType=typeof arg;if(argType==="string"||argType==="number"){classes.push(arg)}else if(Array.isArray(arg)&&arg.length){var inner=classNames.apply(null,arg);if(inner){classes.push(inner)}}else if(argType==="object"){for(var key in arg){if(hasOwn.call(arg,key)&&arg[key]){classes.push(key)}}}}return classes.join(" ")}if(typeof module!=="undefined"&&module.exports){classNames.default=classNames;module.exports=classNames}else if(typeof define==="function"&&typeof define.amd==="object"&&define.amd){define("classnames",[],function(){return classNames})}else{window.classNames=classNames}})()},{}],84:[function(require,module,exports){var fingerprint=require("./lib/fingerprint.js");var pad=require("./lib/pad.js");var getRandomValue=require("./lib/getRandomValue.js");var c=0,blockSize=4,base=36,discreteValues=Math.pow(base,blockSize);function randomBlock(){return pad((getRandomValue()*discreteValues<<0).toString(base),blockSize)}function safeCounter(){c=c<discreteValues?c:0;c++;return c-1}function cuid(){var letter="c",timestamp=(new Date).getTime().toString(base),counter=pad(safeCounter().toString(base),blockSize),print=fingerprint(),random=randomBlock()+randomBlock();return letter+timestamp+counter+print+random}cuid.slug=function slug(){var date=(new Date).getTime().toString(36),counter=safeCounter().toString(36).slice(-4),print=fingerprint().slice(0,1)+fingerprint().slice(-1),random=randomBlock().slice(-2);return date.slice(-2)+counter+print+random};cuid.isCuid=function isCuid(stringToCheck){if(typeof stringToCheck!=="string")return false;if(stringToCheck.startsWith("c"))return true;return false};cuid.isSlug=function isSlug(stringToCheck){if(typeof stringToCheck!=="string")return false;var stringLength=stringToCheck.length;if(stringLength>=7&&stringLength<=10)return true;return false};cuid.fingerprint=fingerprint;module.exports=cuid},{"./lib/fingerprint.js":85,"./lib/getRandomValue.js":86,"./lib/pad.js":87}],85:[function(require,module,exports){var pad=require("./pad.js");var env=typeof window==="object"?window:self;var globalCount=Object.keys(env).length;var mimeTypesLength=navigator.mimeTypes?navigator.mimeTypes.length:0;var clientId=pad((mimeTypesLength+navigator.userAgent.length).toString(36)+globalCount.toString(36),4);module.exports=function fingerprint(){return clientId}},{"./pad.js":87}],86:[function(require,module,exports){var getRandomValue;var crypto=typeof window!=="undefined"&&(window.crypto||window.msCrypto)||typeof self!=="undefined"&&self.crypto;if(crypto){var lim=Math.pow(2,32)-1;getRandomValue=function(){return Math.abs(crypto.getRandomValues(new Uint32Array(1))[0]/lim)}}else{getRandomValue=Math.random}module.exports=getRandomValue},{}],87:[function(require,module,exports){module.exports=function pad(num,size){var s="000000000"+num;return s.substr(s.length-size)}},{}],88:[function(require,module,exports){(function(process,global,Buffer){(function(){!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define("exifr",["exports"],t):t((e=e||self).exifr={})}(this,function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}});var n=["prototype","__proto__","caller","arguments","length","name"];Object.getOwnPropertyNames(t).forEach(function(r){-1===n.indexOf(r)&&e[r]!==t[r]&&(e[r]=t[r])}),t&&u(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function f(e,t,n){return(f=o()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&u(i,n.prototype),i}).apply(null,arguments)}function c(e){var t="function"==typeof Map?new Map:void 0;return(c=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return f(e,arguments,s(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),u(r,e)})(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?h(e):t}function d(e,t,n){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}var v=Object.values||function(e){var t=[];for(var n in e)t.push(e[n]);return t},p=Object.entries||function(e){var t=[];for(var n in e)t.push([n,e[n]]);return t},y=Object.assign||function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.forEach(function(t){for(var n in t)e[n]=t[n]}),e},g=Object.fromEntries||function(e){var t={};return k(e).forEach(function(e){var n=e[0],r=e[1];t[n]=r}),t},k=Array.from||function(e){if(e instanceof P){var t=[];return e.forEach(function(e,n){return t.push([n,e])}),t}return Array.prototype.slice.call(e)};function m(e){return-1!==this.indexOf(e)}Array.prototype.includes||(Array.prototype.includes=m),String.prototype.includes||(String.prototype.includes=m),String.prototype.startsWith||(String.prototype.startsWith=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.substring(t,t+e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return this.substring(t-e.length,t)===e});var b="undefined"!=typeof self?self:global,A=b.fetch||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,r){var i=new XMLHttpRequest;if(i.open("get",e,!0),i.responseType="arraybuffer",i.onerror=r,t.headers)for(var a in t.headers)i.setRequestHeader(a,t.headers[a]);i.onload=function(){n({ok:i.status>=200&&i.status<300,status:i.status,arrayBuffer:function(){return Promise.resolve(i.response)}})},i.send(null)})},w=function(e){var t=[];if(Object.defineProperties(t,{size:{get:function(){return this.length}},has:{value:function(e){return-1!==this.indexOf(e)}},add:{value:function(e){this.has(e)||this.push(e)}},delete:{value:function(e){if(this.has(e)){var t=this.indexOf(e);this.splice(t,1)}}}}),Array.isArray(e))for(var n=0;n<e.length;n++)t.add(e[n]);return t},O=function(e){return new P(e)},P=void 0!==b.Map&&void 0!==b.Map.prototype.keys?b.Map:function(){function e(n){if(t(this,e),this.clear(),n)for(var r=0;r<n.length;r++)this.set(n[r][0],n[r][1])}return r(e,[{key:"clear",value:function(){this._map={},this._keys=[]}},{key:"get",value:function(e){return this._map["map_"+e]}},{key:"set",value:function(e,t){return this._map["map_"+e]=t,this._keys.indexOf(e)<0&&this._keys.push(e),this}},{key:"has",value:function(e){return this._keys.indexOf(e)>=0}},{key:"delete",value:function(e){var t=this._keys.indexOf(e);return!(t<0)&&(delete this._map["map_"+e],this._keys.splice(t,1),!0)}},{key:"keys",value:function(){return this._keys.slice(0)}},{key:"values",value:function(){var e=this;return this._keys.map(function(t){return e.get(t)})}},{key:"entries",value:function(){var e=this;return this._keys.map(function(t){return[t,e.get(t)]})}},{key:"forEach",value:function(e,t){for(var n=0;n<this._keys.length;n++)e.call(t,this._map["map_"+this._keys[n]],this._keys[n],this)}},{key:"size",get:function(){return this._keys.length}}]),e}(),S="undefined"!=typeof self?self:global,U="undefined"!=typeof navigator,x=U&&"undefined"==typeof HTMLImageElement,C=!("undefined"==typeof global||"undefined"==typeof process||!process.versions||!process.versions.node),j=S.Buffer,B=!!j;var _=function(e){return void 0!==e};function V(e){return void 0===e||(e instanceof P?0===e.size:0===v(e).filter(_).length)}function I(e){var t=new Error(e);throw delete t.stack,t}function L(e){var t=function(e){var t=0;return e.ifd0.enabled&&(t+=1024),e.exif.enabled&&(t+=2048),e.makerNote&&(t+=2048),e.userComment&&(t+=1024),e.gps.enabled&&(t+=512),e.interop.enabled&&(t+=100),e.ifd1.enabled&&(t+=1024),t+2048}(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}var T="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):void 0;function z(e){return T?T.decode(e):B?Buffer.from(e).toString("utf8"):decodeURIComponent(escape(String.fromCharCode.apply(null,e)))}var F=function(){function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;if(t(this,e),"boolean"==typeof a&&(this.le=a),Array.isArray(n)&&(n=new Uint8Array(n)),0===n)this.byteOffset=0,this.byteLength=0;else if(n instanceof ArrayBuffer){void 0===i&&(i=n.byteLength-r);var s=new DataView(n,r,i);this._swapDataView(s)}else if(n instanceof Uint8Array||n instanceof DataView||n instanceof e){void 0===i&&(i=n.byteLength-r),(r+=n.byteOffset)+i>n.byteOffset+n.byteLength&&I("Creating view outside of available memory in ArrayBuffer");var u=new DataView(n.buffer,r,i);this._swapDataView(u)}else if("number"==typeof n){var o=new DataView(new ArrayBuffer(n));this._swapDataView(o)}else I("Invalid input argument for BufferView: "+n)}return r(e,null,[{key:"from",value:function(t,n){return t instanceof this&&t.le===n?t:new e(t,void 0,void 0,n)}}]),r(e,[{key:"_swapArrayBuffer",value:function(e){this._swapDataView(new DataView(e))}},{key:"_swapBuffer",value:function(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}},{key:"_swapDataView",value:function(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}},{key:"_lengthToEnd",value:function(e){return this.byteLength-e}},{key:"set",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;t instanceof DataView||t instanceof e?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer&&(t=new Uint8Array(t)),t instanceof Uint8Array||I("BufferView.set(): Invalid data argument.");var i=this.toUint8();return i.set(t,n),new r(this,n,t.byteLength)}},{key:"subarray",value:function(t,n){return new e(this,t,n=n||this._lengthToEnd(t))}},{key:"toUint8",value:function(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}},{key:"getUint8Array",value:function(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}},{key:"getString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength,n=this.getUint8Array(e,t);return z(n)}},{key:"getUnicodeString",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength,n=[],r=0;r<t&&e+r<this.byteLength;r+=2)n.push(this.getUint16(e+r));return n.map(function(e){return String.fromCharCode(e)}).join("")}},{key:"getInt8",value:function(e){return this.dataView.getInt8(e)}},{key:"getUint8",value:function(e){return this.dataView.getUint8(e)}},{key:"getInt16",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getInt16(e,t)}},{key:"getInt32",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getInt32(e,t)}},{key:"getUint16",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getUint16(e,t)}},{key:"getUint32",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getUint32(e,t)}},{key:"getFloat32",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat32(e,t)}},{key:"getFloat64",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat64(e,t)}},{key:"getFloat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat32(e,t)}},{key:"getDouble",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat64(e,t)}},{key:"getUintBytes",value:function(e,t,n){switch(t){case 1:return this.getUint8(e,n);case 2:return this.getUint16(e,n);case 4:return this.getUint32(e,n);case 8:return this.getUint64&&this.getUint64(e,n)}}},{key:"getUint",value:function(e,t,n){switch(t){case 8:return this.getUint8(e,n);case 16:return this.getUint16(e,n);case 32:return this.getUint32(e,n);case 64:return this.getUint64&&this.getUint64(e,n)}}},{key:"toString",value:function(e){return this.dataView.toString(e,this.constructor.name)}},{key:"ensureChunk",value:function(){}}]),e}();function E(e,t){I("".concat(e," '").concat(t,"' was not loaded, try using full build of exifr."))}var D=function(e){function n(e){var r;return t(this,n),(r=l(this,s(n).call(this))).kind=e,r}return a(n,e),r(n,[{key:"get",value:function(e,t){return this.has(e)||E(this.kind,e),t&&(e in t||function(e,t){I("Unknown ".concat(e," '").concat(t,"'."))}(this.kind,e),t[e].enabled||E(this.kind,e)),d(s(n.prototype),"get",this).call(this,e)}},{key:"keyList",value:function(){return k(this.keys())}}]),n}(c(P)),R=new D("file parser"),M=new D("segment parser"),N=new D("file reader");function W(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}function K(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var H=W(function(e){return new Promise(function(t,n){var r=new FileReader;r.onloadend=function(){return t(r.result||new ArrayBuffer)},r.onerror=n,r.readAsArrayBuffer(e)})}),X=W(function(e){return A(e).then(function(e){return e.arrayBuffer()})}),Y=W(function(e,t){return K(t(e),function(e){return new F(e)})}),G=W(function(e,t,n){var r=new(N.get(n))(e,t);return K(r.read(),function(){return r})}),J=W(function(e,t,n,r){return N.has(n)?G(e,t,n):r?Y(e,r):(I("Parser ".concat(n," is not loaded")),K())});function q(e,t){return(n=e).startsWith("data:")||n.length>1e4?G(e,t,"base64"):U?J(e,t,"url",X):C?G(e,t,"fs"):void I("Invalid input argument");var n}var Q=function(e){function n(){return t(this,n),l(this,s(n).apply(this,arguments))}return a(n,e),r(n,[{key:"tagKeys",get:function(){return this.allKeys||(this.allKeys=k(this.keys())),this.allKeys}},{key:"tagValues",get:function(){return this.allValues||(this.allValues=k(this.values())),this.allValues}}]),n}(c(P));function Z(e,t,n){var r=new Q,i=n;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=k(i));for(var a=0;a<i.length;a++){var s=i[a],u=s[0],o=s[1];r.set(u,o)}if(Array.isArray(t)){var f=t;Array.isArray(f)||("function"==typeof f.entries&&(f=f.entries()),f=k(f));for(var c=0;c<f.length;c++){var h=f[c];e.set(h,r)}}else e.set(t,r);return r}function $(e,t,n){var r,i=e.get(t),a=n;Array.isArray(a)||("function"==typeof a.entries&&(a=a.entries()),a=k(a));for(var s=0;s<a.length;s++)r=a[s],i.set(r[0],r[1])}var ee=O(),te=O(),ne=O(),re=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],ie=["jfif","xmp","icc","iptc","ihdr"],ae=["tiff"].concat(ie),se=["ifd0","ifd1","exif","gps","interop"],ue=[].concat(ae,se),oe=["makerNote","userComment"],fe=["translateKeys","translateValues","reviveValues","multiSegment"],ce=[].concat(fe,["sanitize","mergeOutput","silentErrors"]),he=function(){function e(){t(this,e)}return r(e,[{key:"translate",get:function(){return this.translateKeys||this.translateValues||this.reviveValues}}]),e}(),le=function(e){function n(e,r,a,u){var o;if(t(this,n),i(h(o=l(this,s(n).call(this))),"enabled",!1),i(h(o),"skip",w()),i(h(o),"pick",w()),i(h(o),"deps",w()),i(h(o),"translateKeys",!1),i(h(o),"translateValues",!1),i(h(o),"reviveValues",!1),o.key=e,o.enabled=r,o.parse=o.enabled,o.applyInheritables(u),o.canBeFiltered=se.includes(e),o.canBeFiltered&&(o.dict=ee.get(e)),void 0!==a)if(Array.isArray(a))o.parse=o.enabled=!0,o.canBeFiltered&&a.length>0&&o.translateTagSet(a,o.pick);else if("object"==typeof a){if(o.enabled=!0,o.parse=!1!==a.parse,o.canBeFiltered){var f=a.pick,c=a.skip;f&&f.length>0&&o.translateTagSet(f,o.pick),c&&c.length>0&&o.translateTagSet(c,o.skip)}o.applyInheritables(a)}else!0===a||!1===a?o.parse=o.enabled=a:I("Invalid options argument: ".concat(a));return o}return a(n,e),r(n,[{key:"needed",get:function(){return this.enabled||this.deps.size>0}}]),r(n,[{key:"applyInheritables",value:function(e){var t,n,r=fe;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=k(r));for(var i=0;i<r.length;i++)void 0!==(n=e[t=r[i]])&&(this[t]=n)}},{key:"translateTagSet",value:function(e,t){if(this.dict){var n,r,i=this.dict,a=i.tagKeys,s=i.tagValues,u=e;Array.isArray(u)||("function"==typeof u.entries&&(u=u.entries()),u=k(u));for(var o=0;o<u.length;o++)"string"==typeof(n=u[o])?(-1===(r=s.indexOf(n))&&(r=a.indexOf(Number(n))),-1!==r&&t.add(Number(a[r]))):t.add(n)}else{var f=e;Array.isArray(f)||("function"==typeof f.entries&&(f=f.entries()),f=k(f));for(var c=0;c<f.length;c++){var h=f[c];t.add(h)}}}},{key:"finalizeFilters",value:function(){!this.enabled&&this.deps.size>0?(this.enabled=!0,ke(this.pick,this.deps)):this.enabled&&this.pick.size>0&&ke(this.pick,this.deps)}}]),n}(he),de={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},ve=O(),pe=function(e){function n(e){var r;return t(this,n),r=l(this,s(n).call(this)),!0===e?r.setupFromTrue():void 0===e?r.setupFromUndefined():Array.isArray(e)?r.setupFromArray(e):"object"==typeof e?r.setupFromObject(e):I("Invalid options argument ".concat(e)),void 0===r.firstChunkSize&&(r.firstChunkSize=U?r.firstChunkSizeBrowser:r.firstChunkSizeNode),r.mergeOutput&&(r.ifd1.enabled=!1),r.filterNestedSegmentTags(),r.traverseTiffDependencyTree(),r.checkLoadedPlugins(),r}return a(n,e),r(n,null,[{key:"useCached",value:function(e){var t=ve.get(e);return void 0!==t?t:(t=new this(e),ve.set(e,t),t)}}]),r(n,[{key:"setupFromUndefined",value:function(){var e,t=re;Array.isArray(t)||("function"==typeof t.entries&&(t=t.entries()),t=k(t));for(var n=0;n<t.length;n++)this[e=t[n]]=de[e];var r=ce;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=k(r));for(var i=0;i<r.length;i++)this[e=r[i]]=de[e];var a=oe;Array.isArray(a)||("function"==typeof a.entries&&(a=a.entries()),a=k(a));for(var s=0;s<a.length;s++)this[e=a[s]]=de[e];var u=ue;Array.isArray(u)||("function"==typeof u.entries&&(u=u.entries()),u=k(u));for(var o=0;o<u.length;o++)this[e=u[o]]=new le(e,de[e],void 0,this)}},{key:"setupFromTrue",value:function(){var e,t=re;Array.isArray(t)||("function"==typeof t.entries&&(t=t.entries()),t=k(t));for(var n=0;n<t.length;n++)this[e=t[n]]=de[e];var r=ce;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=k(r));for(var i=0;i<r.length;i++)this[e=r[i]]=de[e];var a=oe;Array.isArray(a)||("function"==typeof a.entries&&(a=a.entries()),a=k(a));for(var s=0;s<a.length;s++)this[e=a[s]]=!0;var u=ue;Array.isArray(u)||("function"==typeof u.entries&&(u=u.entries()),u=k(u));for(var o=0;o<u.length;o++)this[e=u[o]]=new le(e,!0,void 0,this)}},{key:"setupFromArray",value:function(e){var t,n=re;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=k(n));for(var r=0;r<n.length;r++)this[t=n[r]]=de[t];var i=ce;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=k(i));for(var a=0;a<i.length;a++)this[t=i[a]]=de[t];var s=oe;Array.isArray(s)||("function"==typeof s.entries&&(s=s.entries()),s=k(s));for(var u=0;u<s.length;u++)this[t=s[u]]=de[t];var o=ue;Array.isArray(o)||("function"==typeof o.entries&&(o=o.entries()),o=k(o));for(var f=0;f<o.length;f++)this[t=o[f]]=new le(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,se)}},{key:"setupFromObject",value:function(e){var t;se.ifd0=se.ifd0||se.image,se.ifd1=se.ifd1||se.thumbnail,y(this,e);var n=re;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=k(n));for(var r=0;r<n.length;r++)this[t=n[r]]=ge(e[t],de[t]);var i=ce;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=k(i));for(var a=0;a<i.length;a++)this[t=i[a]]=ge(e[t],de[t]);var s=oe;Array.isArray(s)||("function"==typeof s.entries&&(s=s.entries()),s=k(s));for(var u=0;u<s.length;u++)this[t=s[u]]=ge(e[t],de[t]);var o=ae;Array.isArray(o)||("function"==typeof o.entries&&(o=o.entries()),o=k(o));for(var f=0;f<o.length;f++)this[t=o[f]]=new le(t,de[t],e[t],this);var c=se;Array.isArray(c)||("function"==typeof c.entries&&(c=c.entries()),c=k(c));for(var h=0;h<c.length;h++)this[t=c[h]]=new le(t,de[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,se,ue),!0===e.tiff?this.batchEnableWithBool(se,!0):!1===e.tiff?this.batchEnableWithUserValue(se,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,se):"object"==typeof e.tiff&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,se)}},{key:"batchEnableWithBool",value:function(e,t){var n=e;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=k(n));for(var r=0;r<n.length;r++){this[n[r]].enabled=t}}},{key:"batchEnableWithUserValue",value:function(e,t){var n=e;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=k(n));for(var r=0;r<n.length;r++){var i=n[r],a=t[i];this[i].enabled=!1!==a&&void 0!==a}}},{key:"setupGlobalFilters",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;if(e&&e.length){var i=r;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=k(i));for(var a=0;a<i.length;a++){var s=i[a];this[s].enabled=!1}var u=ye(e,n),o=u;Array.isArray(o)||("function"==typeof o.entries&&(o=o.entries()),o=k(o));for(var f=0;f<o.length;f++){var c=o[f],h=c[0],l=c[1];ke(this[h].pick,l),this[h].enabled=!0}}else if(t&&t.length){var d=ye(t,n),v=d;Array.isArray(v)||("function"==typeof v.entries&&(v=v.entries()),v=k(v));for(var p=0;p<v.length;p++){var y=v[p],g=y[0],m=y[1];ke(this[g].skip,m)}}}},{key:"filterNestedSegmentTags",value:function(){var e=this.ifd0,t=this.exif,n=this.xmp,r=this.iptc,i=this.icc;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),n.enabled||e.skip.add(700),r.enabled||e.skip.add(33723),i.enabled||e.skip.add(34675)}},{key:"traverseTiffDependencyTree",value:function(){var e=this,t=this.ifd0,n=this.exif,r=this.gps;this.interop.needed&&(n.deps.add(40965),t.deps.add(40965)),n.needed&&t.deps.add(34665),r.needed&&t.deps.add(34853),this.tiff.enabled=se.some(function(t){return!0===e[t].enabled})||this.makerNote||this.userComment;var i=se;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=k(i));for(var a=0;a<i.length;a++){this[i[a]].finalizeFilters()}}},{key:"checkLoadedPlugins",value:function(){var e=ae;Array.isArray(e)||("function"==typeof e.entries&&(e=e.entries()),e=k(e));for(var t=0;t<e.length;t++){var n=e[t];this[n].enabled&&!M.has(n)&&E("segment parser",n)}}},{key:"onlyTiff",get:function(){var e=this;return!ie.map(function(t){return e[t].enabled}).some(function(e){return!0===e})&&this.tiff.enabled}}]),n}(he);function ye(e,t){var n,r,i,a=[],s=t;Array.isArray(s)||("function"==typeof s.entries&&(s=s.entries()),s=k(s));for(var u=0;u<s.length;u++){r=s[u],n=[];var o=ee.get(r);Array.isArray(o)||("function"==typeof o.entries&&(o=o.entries()),o=k(o));for(var f=0;f<o.length;f++)i=o[f],(e.includes(i[0])||e.includes(i[1]))&&n.push(i[0]);n.length&&a.push([r,n])}return a}function ge(e,t){return void 0!==e?e:void 0!==t?t:void 0}function ke(e,t){var n=t;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=k(n));for(var r=0;r<n.length;r++){var i=n[r];e.add(i)}}function me(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function be(){}function Ae(e,t){if(!t)return e&&e.then?e.then(be):Promise.resolve()}function we(e,t){var n=e();return n&&n.then?n.then(t):t(n)}i(pe,"default",de);var Oe=function(){function e(n){t(this,e),i(this,"parsers",{}),this.options=pe.useCached(n)}return r(e,[{key:"setup",value:function(){if(!this.fileParser){var e=this.file,t=e.getUint16(0),n=R;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=k(n));for(var r=0;r<n.length;r++){var i=n[r],a=i[0],s=i[1];if(s.canHandle(e,t))return this.fileParser=new s(this.options,this.file,this.parsers),e[a]=!0}I("Unknown file format")}}},{key:"read",value:function(e){try{var t=this;return me(function(e,t){return"string"==typeof e?q(e,t):U&&!x&&e instanceof HTMLImageElement?q(e.src,t):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new F(e):U&&e instanceof Blob?J(e,t,"blob",H):void I("Invalid input argument")}(e,t.options),function(e){t.file=e})}catch(e){return Promise.reject(e)}}},{key:"parse",value:function(){try{var e=this;e.setup();var t={},n=[];return we(function(){return e.options.silentErrors?me(e.doParse(t,n).catch(function(e){return n.push(e)}),function(){n.push.apply(n,e.fileParser.errors)}):Ae(e.doParse(t,n))},function(){return e.file.close&&e.file.close(),e.options.silentErrors&&n.length>0&&(t.errors=n),V(r=t)?void 0:r;var r})}catch(e){return Promise.reject(e)}}},{key:"doParse",value:function(e,t){try{var n=this;return me(n.fileParser.parse(),function(){var r,i=v(n.parsers).map((r=function(t){return me(t.parse(),function(n){t.assignToOutput(e,n)})},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(r.apply(this,e))}catch(e){return Promise.reject(e)}}));if(n.options.silentErrors){var a=function(e){return t.push(e)};i=i.map(function(e){return e.catch(a)})}return Ae(Promise.all(i))})}catch(e){return Promise.reject(e)}}},{key:"extractThumbnail",value:function(){try{var e=this;e.setup();var t,n=e.options,r=e.file,i=M.get("tiff",n);return we(function(){if(!r.tiff)return function(e){var t=e();if(t&&t.then)return t.then(be)}(function(){if(r.jpeg)return me(e.fileParser.getOrFindSegment("tiff"),function(e){t=e})});t={start:0,type:"tiff"}},function(){if(void 0!==t)return me(e.fileParser.ensureSegmentChunk(t),function(t){return me((e.parsers.tiff=new i(t,n,r)).extractThumbnail(),function(e){return r.close&&r.close(),e})})})}catch(e){return Promise.reject(e)}}}]),e}();var Pe,Se=(Pe=function(e,t){var n,r,i,a=new Oe(t);return n=a.read(e),r=function(){return a.parse()},i?r?r(n):n:(n&&n.then||(n=Promise.resolve(n)),r?n.then(r):n)},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(Pe.apply(this,e))}catch(e){return Promise.reject(e)}}),Ue=Object.freeze({__proto__:null,parse:Se,Exifr:Oe,fileParsers:R,segmentParsers:M,fileReaders:N,tagKeys:ee,tagValues:te,tagRevivers:ne,createDictionary:Z,extendDictionary:$,fetchUrlAsArrayBuffer:X,readBlobAsArrayBuffer:H,chunkedProps:re,otherSegments:ie,segments:ae,tiffBlocks:se,segmentsAndBlocks:ue,tiffExtractables:oe,inheritables:fe,allFormatters:ce,Options:pe});function xe(){}var Ce=function(){function e(n,r,a){var s=this;t(this,e),i(this,"errors",[]),i(this,"ensureSegmentChunk",function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}(function(e){var t,n,r,i=e.start,a=e.size||65536;return t=function(){if(s.file.chunked)return function(e){var t=e();if(t&&t.then)return t.then(xe)}(function(){if(!s.file.available(i,a))return function(e){if(e&&e.then)return e.then(xe)}(function(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}(function(){return t=s.file.readChunk(i,a),n=function(t){e.chunk=t},r?n?n(t):t:(t&&t.then||(t=Promise.resolve(t)),n?t.then(n):t);var t,n,r},function(t){I("Couldn't read segment: ".concat(JSON.stringify(e),". ").concat(t.message))}));e.chunk=s.file.subarray(i,a)});s.file.byteLength>i+a?e.chunk=s.file.subarray(i,a):void 0===e.size?e.chunk=s.file.subarray(i):I("Segment unreachable: "+JSON.stringify(e))},n=function(){return e.chunk},(r=t())&&r.then?r.then(n):n(r)})),this.extendOptions&&this.extendOptions(n),this.options=n,this.file=r,this.parsers=a}return r(e,[{key:"injectSegment",value:function(e,t){this.options[e].enabled&&this.createParser(e,t)}},{key:"createParser",value:function(e,t){var n=new(M.get(e))(t,this.options,this.file);return this.parsers[e]=n}},{key:"createParsers",value:function(e){var t=e;Array.isArray(t)||("function"==typeof t.entries&&(t=t.entries()),t=k(t));for(var n=0;n<t.length;n++){var r=t[n],i=r.type,a=r.chunk,s=this.options[i];if(s&&s.enabled){var u=this.parsers[i];u&&u.append||u||this.createParser(i,a)}}}},{key:"readSegments",value:function(e){try{var t=e.map(this.ensureSegmentChunk);return function(e,t){if(!t)return e&&e.then?e.then(xe):Promise.resolve()}(Promise.all(t))}catch(e){return Promise.reject(e)}}}]),e}(),je=function(){function e(n){var r=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;t(this,e),i(this,"errors",[]),i(this,"raw",O()),i(this,"handleError",function(e){if(!r.options.silentErrors)throw e;r.errors.push(e.message)}),this.chunk=this.normalizeInput(n),this.file=s,this.type=this.constructor.type,this.globalOptions=this.options=a,this.localOptions=a[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}return r(e,[{key:"normalizeInput",value:function(e){return e instanceof F?e:new F(e)}}],[{key:"findPosition",value:function(e,t){var n=e.getUint16(t+2)+2,r="function"==typeof this.headerLength?this.headerLength(e,t,n):this.headerLength,i=t+r,a=n-r;return{offset:t,length:n,headerLength:r,start:i,size:a,end:i+a}}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new pe(i({},this.type,t)),r=new this(e,n);return r.parse()}}]),r(e,[{key:"translate",value:function(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}},{key:"translateBlock",value:function(e,t){var n=ne.get(t),r=te.get(t),i=ee.get(t),a=this.options[t],s=a.reviveValues&&!!n,u=a.translateValues&&!!r,o=a.translateKeys&&!!i,f={},c=e;Array.isArray(c)||("function"==typeof c.entries&&(c=c.entries()),c=k(c));for(var h=0;h<c.length;h++){var l=c[h],d=l[0],v=l[1];s&&n.has(d)?v=n.get(d)(v):u&&r.has(d)&&(v=this.translateValue(v,r.get(d))),o&&i.has(d)&&(d=i.get(d)||d),f[d]=v}return f}},{key:"translateValue",value:function(e,t){return t[e]||t.DEFAULT||e}},{key:"assignToOutput",value:function(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}},{key:"assignObjectToOutput",value:function(e,t,n){if(this.globalOptions.mergeOutput)return y(e,n);e[t]?y(e[t],n):e[t]=n}},{key:"output",get:function(){return this.translated?this.translated:this.raw?g(this.raw):void 0}}]),e}();function Be(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}i(je,"headerLength",4),i(je,"type",void 0),i(je,"multiSegment",!1),i(je,"canHandle",function(){return!1});function _e(){}function Ve(e,t){if(!t)return e&&e.then?e.then(_e):Promise.resolve()}function Ie(e){var t=e();if(t&&t.then)return t.then(_e)}function Le(e,t){var n=e();return n&&n.then?n.then(t):t(n)}function Te(e,t,n){if(!e.s){if(n instanceof ze){if(!n.s)return void(n.o=Te.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(Te.bind(null,e,t),Te.bind(null,e,2));e.s=t,e.v=n;var r=e.o;r&&r(e)}}var ze=function(){function e(){}return e.prototype.then=function(t,n){var r=new e,i=this.s;if(i){var a=1&i?t:n;if(a){try{Te(r,1,a(this.v))}catch(e){Te(r,2,e)}return r}return this}return this.o=function(e){try{var i=e.v;1&e.s?Te(r,1,t?t(i):i):n?Te(r,1,n(i)):Te(r,2,i)}catch(e){Te(r,2,e)}},r},e}();function Fe(e){return e instanceof ze&&1&e.s}function Ee(e,t,n){for(var r;;){var i=e();if(Fe(i)&&(i=i.v),!i)return a;if(i.then){r=0;break}var a=n();if(a&&a.then){if(!Fe(a)){r=1;break}a=a.s}if(t){var s=t();if(s&&s.then&&!Fe(s)){r=2;break}}}var u=new ze,o=Te.bind(null,u,2);return(0===r?i.then(c):1===r?a.then(f):s.then(h)).then(void 0,o),u;function f(r){a=r;do{if(t&&(s=t())&&s.then&&!Fe(s))return void s.then(h).then(void 0,o);if(!(i=e())||Fe(i)&&!i.v)return void Te(u,1,a);if(i.then)return void i.then(c).then(void 0,o);Fe(a=n())&&(a=a.v)}while(!a||!a.then);a.then(f).then(void 0,o)}function c(e){e?(a=n())&&a.then?a.then(f).then(void 0,o):f(a):Te(u,1,a)}function h(){(i=e())?i.then?i.then(c).then(void 0,o):c(i):Te(u,1,a)}}function De(e){return 192===e||194===e||196===e||219===e||221===e||218===e||254===e}function Re(e){return e>=224&&e<=239}function Me(e,t,n){var r=M;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=k(r));for(var i=0;i<r.length;i++){var a=r[i],s=a[0];if(a[1].canHandle(e,t,n))return s}}var Ne=function(e){function n(){var e,r;t(this,n);for(var a=arguments.length,u=new Array(a),o=0;o<a;o++)u[o]=arguments[o];return i(h(r=l(this,(e=s(n)).call.apply(e,[this].concat(u)))),"appSegments",[]),i(h(r),"jpegSegments",[]),i(h(r),"unknownSegments",[]),r}return a(n,e),r(n,[{key:"parse",value:function(){try{var e=this;return Be(e.findAppSegments(),function(){return Be(e.readSegments(e.appSegments),function(){e.mergeMultiSegments(),e.createParsers(e.mergedAppSegments||e.appSegments)})})}catch(e){return Promise.reject(e)}}},{key:"setupSegmentFinderArgs",value:function(e){var t=this;!0===e?(this.findAll=!0,this.wanted=w(M.keyList())):(e=void 0===e?M.keyList().filter(function(e){return t.options[e].enabled}):e.filter(function(e){return t.options[e].enabled&&M.has(e)}),this.findAll=!1,this.remaining=w(e),this.wanted=w(e)),this.unfinishedMultiSegment=!1}},{key:"findAppSegments",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;try{var n=this;n.setupSegmentFinderArgs(t);var r=n.file,i=n.findAll,a=n.wanted,s=n.remaining;return Le(function(){if(!i&&n.file.chunked)return i=k(a).some(function(e){var t=M.get(e),r=n.options[e];return t.multiSegment&&r.multiSegment}),Ie(function(){if(i)return Ve(n.file.readWhole())})},function(){var t=!1;if(e=n.findAppSegmentsInRange(e,r.byteLength),!n.options.onlyTiff)return function(){if(r.chunked){var i=!1;return Ee(function(){return!t&&s.size>0&&!i&&(!!r.canReadNextChunk||!!n.unfinishedMultiSegment)},void 0,function(){var a=r.nextChunkOffset,s=n.appSegments.some(function(e){return!n.file.available(e.offset||e.start,e.length||e.size)});return Le(function(){return e>a&&!s?Be(r.readNextChunk(e),function(e){i=!e}):Be(r.readNextChunk(a),function(e){i=!e})},function(){void 0===(e=n.findAppSegmentsInRange(e,r.byteLength))&&(t=!0)})})}}()})}catch(e){return Promise.reject(e)}}},{key:"findAppSegmentsInRange",value:function(e,t){t-=2;for(var n,r,i,a,s,u,o=this.file,f=this.findAll,c=this.wanted,h=this.remaining,l=this.options;e<t;e++)if(255===o.getUint8(e))if(Re(n=o.getUint8(e+1))){if(r=o.getUint16(e+2),(i=Me(o,e,r))&&c.has(i)&&(s=(a=M.get(i)).findPosition(o,e),u=l[i],s.type=i,this.appSegments.push(s),!f&&(a.multiSegment&&u.multiSegment?(this.unfinishedMultiSegment=s.chunkNumber<s.chunkCount,this.unfinishedMultiSegment||h.delete(i)):h.delete(i),0===h.size)))break;l.recordUnknownSegments&&((s=je.findPosition(o,e)).marker=n,this.unknownSegments.push(s)),e+=r+1}else if(De(n)){if(r=o.getUint16(e+2),218===n&&!1!==l.stopAfterSos)return;l.recordJpegSegments&&this.jpegSegments.push({offset:e,length:r,marker:n}),e+=r+1}return e}},{key:"mergeMultiSegments",value:function(){var e=this;if(this.appSegments.some(function(e){return e.multiSegment})){var t=function(e,t){for(var n,r,i,a=O(),s=0;s<e.length;s++)n=e[s],r=n[t],a.has(r)?i=a.get(r):a.set(r,i=[]),i.push(n);return k(a)}(this.appSegments,"type");this.mergedAppSegments=t.map(function(t){var n=t[0],r=t[1],i=M.get(n,e.options);return i.handleMultiSegments?{type:n,chunk:i.handleMultiSegments(r)}:r[0]})}}},{key:"getSegment",value:function(e){return this.appSegments.find(function(t){return t.type===e})}},{key:"getOrFindSegment",value:function(e){try{var t=this,n=t.getSegment(e);return Le(function(){if(void 0===n)return Be(t.findAppSegments(0,[e]),function(){n=t.getSegment(e)})},function(){return n})}catch(e){return Promise.reject(e)}}}],[{key:"canHandle",value:function(e,t){return 65496===t}}]),n}(Ce);function We(){}i(Ne,"type","jpeg"),R.set("jpeg",Ne);function Ke(e,t){if(!t)return e&&e.then?e.then(We):Promise.resolve()}function He(e,t){var n=e();return n&&n.then?n.then(t):t(n)}var Xe=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];var Ye=function(e){function n(){return t(this,n),l(this,s(n).apply(this,arguments))}return a(n,e),r(n,[{key:"parse",value:function(){try{var e=this;e.parseHeader();var t=e.options;return He(function(){if(t.ifd0.enabled)return Ke(e.parseIfd0Block())},function(){return He(function(){if(t.exif.enabled)return Ke(e.safeParse("parseExifBlock"))},function(){return He(function(){if(t.gps.enabled)return Ke(e.safeParse("parseGpsBlock"))},function(){return He(function(){if(t.interop.enabled)return Ke(e.safeParse("parseInteropBlock"))},function(){return He(function(){if(t.ifd1.enabled)return Ke(e.safeParse("parseThumbnailBlock"))},function(){return e.createOutput()})})})})})}catch(e){return Promise.reject(e)}}},{key:"safeParse",value:function(e){var t=this[e]();return void 0!==t.catch&&(t=t.catch(this.handleError)),t}},{key:"findIfd0Offset",value:function(){void 0===this.ifd0Offset&&(this.ifd0Offset=this.chunk.getUint32(4))}},{key:"findIfd1Offset",value:function(){if(void 0===this.ifd1Offset){this.findIfd0Offset();var e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}},{key:"parseBlock",value:function(e,t){var n=O();return this[t]=n,this.parseTags(e,t,n),n}},{key:"parseIfd0Block",value:function(){try{var e=this;if(e.ifd0)return;var t=e.file;return e.findIfd0Offset(),e.ifd0Offset<8&&I("Malformed EXIF data"),!t.chunked&&e.ifd0Offset>t.byteLength&&I("IFD0 offset points to outside of file.\nthis.ifd0Offset: ".concat(e.ifd0Offset,", file.byteLength: ").concat(t.byteLength)),He(function(){if(t.tiff)return Ke(t.ensureChunk(e.ifd0Offset,L(e.options)))},function(){var t=e.parseBlock(e.ifd0Offset,"ifd0");if(0!==t.size)return e.exifOffset=t.get(34665),e.interopOffset=t.get(40965),e.gpsOffset=t.get(34853),e.xmp=t.get(700),e.iptc=t.get(33723),e.icc=t.get(34675),e.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t})}catch(e){return Promise.reject(e)}}},{key:"parseExifBlock",value:function(){try{var e=this;if(e.exif)return;return He(function(){if(!e.ifd0)return Ke(e.parseIfd0Block())},function(){if(void 0!==e.exifOffset)return He(function(){if(e.file.tiff)return Ke(e.file.ensureChunk(e.exifOffset,L(e.options)))},function(){var t=e.parseBlock(e.exifOffset,"exif");return e.interopOffset||(e.interopOffset=t.get(40965)),e.makerNote=t.get(37500),e.userComment=t.get(37510),e.options.sanitize&&(t.delete(40965),t.delete(37500),t.delete(37510)),e.unpack(t,41728),e.unpack(t,41729),t})})}catch(e){return Promise.reject(e)}}},{key:"unpack",value:function(e,t){var n=e.get(t);n&&1===n.length&&e.set(t,n[0])}},{key:"parseGpsBlock",value:function(){try{var e=this;if(e.gps)return;return He(function(){if(!e.ifd0)return Ke(e.parseIfd0Block())},function(){if(void 0!==e.gpsOffset){var t=e.parseBlock(e.gpsOffset,"gps");return t&&t.has(2)&&t.has(4)&&(t.set("latitude",Ge.apply(void 0,t.get(2).concat([t.get(1)]))),t.set("longitude",Ge.apply(void 0,t.get(4).concat([t.get(3)])))),t}})}catch(e){return Promise.reject(e)}}},{key:"parseInteropBlock",value:function(){try{var e=this;if(e.interop)return;return He(function(){if(!e.ifd0)return Ke(e.parseIfd0Block())},function(){return He(function(){if(void 0===e.interopOffset&&!e.exif)return Ke(e.parseExifBlock())},function(){if(void 0!==e.interopOffset)return e.parseBlock(e.interopOffset,"interop")})})}catch(e){return Promise.reject(e)}}},{key:"parseThumbnailBlock",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{var t=this;if(t.ifd1||t.ifd1Parsed)return;if(t.options.mergeOutput&&!e)return;return t.findIfd1Offset(),t.ifd1Offset>0&&(t.parseBlock(t.ifd1Offset,"ifd1"),t.ifd1Parsed=!0),t.ifd1}catch(e){return Promise.reject(e)}}},{key:"extractThumbnail",value:function(){try{var e=this;return e.headerParsed||e.parseHeader(),He(function(){if(!e.ifd1Parsed)return Ke(e.parseThumbnailBlock(!0))},function(){if(void 0!==e.ifd1){var t=e.ifd1.get(513),n=e.ifd1.get(514);return e.chunk.getUint8Array(t,n)}})}catch(e){return Promise.reject(e)}}},{key:"createOutput",value:function(){var e,t,n,r={},i=se;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=k(i));for(var a=0;a<i.length;a++)if(!V(e=this[t=i[a]]))if(n=this.canTranslate?this.translateBlock(e,t):g(e),this.options.mergeOutput){if("ifd1"===t)continue;y(r,n)}else r[t]=n;return this.makerNote&&(r.makerNote=this.makerNote),this.userComment&&(r.userComment=this.userComment),r}},{key:"assignToOutput",value:function(e,t){if(this.globalOptions.mergeOutput)y(e,t);else{var n=p(t);Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=k(n));for(var r=0;r<n.length;r++){var i=n[r],a=i[0],s=i[1];this.assignObjectToOutput(e,a,s)}}}},{key:"image",get:function(){return this.ifd0}},{key:"thumbnail",get:function(){return this.ifd1}}],[{key:"canHandle",value:function(e,t){return 225===e.getUint8(t+1)&&1165519206===e.getUint32(t+4)&&0===e.getUint16(t+8)}}]),n}(function(e){function n(){return t(this,n),l(this,s(n).apply(this,arguments))}return a(n,e),r(n,[{key:"parseHeader",value:function(){var e=this.chunk.getUint16();18761===e?this.le=!0:19789===e&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}},{key:"parseTags",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:O(),r=this.options[t],i=r.pick,a=r.skip,s=(i=w(i)).size>0,u=0===a.size,o=this.chunk.getUint16(e);e+=2;for(var f=0;f<o;f++){var c=this.chunk.getUint16(e);if(s){if(i.has(c)&&(n.set(c,this.parseTag(e,c,t)),i.delete(c),0===i.size))break}else!u&&a.has(c)||n.set(c,this.parseTag(e,c,t));e+=12}return n}},{key:"parseTag",value:function(e,t,n){var r,i=this.chunk,a=i.getUint16(e+2),s=i.getUint32(e+4),u=Xe[a];if(u*s<=4?e+=8:e=i.getUint32(e+8),(a<1||a>13)&&I("Invalid TIFF value type. block: ".concat(n.toUpperCase(),", tag: ").concat(t.toString(16),", type: ").concat(a,", offset ").concat(e)),e>i.byteLength&&I("Invalid TIFF value offset. block: ".concat(n.toUpperCase(),", tag: ").concat(t.toString(16),", type: ").concat(a,", offset ").concat(e," is outside of chunk size ").concat(i.byteLength)),1===a)return i.getUint8Array(e,s);if(2===a)return""===(r=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(r=i.getString(e,s)).trim())?void 0:r;if(7===a)return i.getUint8Array(e,s);if(1===s)return this.parseTagValue(a,e);for(var o=new(function(e){switch(e){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(a))(s),f=u,c=0;c<s;c++)o[c]=this.parseTagValue(a,e),e+=f;return o}},{key:"parseTagValue",value:function(e,t){var n=this.chunk;switch(e){case 1:return n.getUint8(t);case 3:return n.getUint16(t);case 4:return n.getUint32(t);case 5:return n.getUint32(t)/n.getUint32(t+4);case 6:return n.getInt8(t);case 8:return n.getInt16(t);case 9:return n.getInt32(t);case 10:return n.getInt32(t)/n.getInt32(t+4);case 11:return n.getFloat(t);case 12:return n.getDouble(t);case 13:return n.getUint32(t);default:I("Invalid tiff type ".concat(e))}}}]),n}(je));function Ge(e,t,n,r){var i=e+t/60+n/3600;return"S"!==r&&"W"!==r||(i*=-1),i}i(Ye,"type","tiff"),i(Ye,"headerLength",10),M.set("tiff",Ye);var Je=Object.freeze({__proto__:null,default:Ue,parse:Se,Exifr:Oe,fileParsers:R,segmentParsers:M,fileReaders:N,tagKeys:ee,tagValues:te,tagRevivers:ne,createDictionary:Z,extendDictionary:$,fetchUrlAsArrayBuffer:X,readBlobAsArrayBuffer:H,chunkedProps:re,otherSegments:ie,segments:ae,tiffBlocks:se,segmentsAndBlocks:ue,tiffExtractables:oe,inheritables:fe,allFormatters:ce,Options:pe});function qe(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Qe(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var Ze=Qe(function(e){var t=new Oe(it);return qe(t.read(e),function(){return qe(t.parse(),function(e){if(e&&e.ifd0)return e.ifd0[274]})})}),$e=Qe(function(e){var t=new Oe(rt);return qe(t.read(e),function(){return qe(t.parse(),function(e){if(e&&e.gps){var t=e.gps;return{latitude:t.latitude,longitude:t.longitude}}})})}),et=Qe(function(e){return qe(this.thumbnail(e),function(e){if(void 0!==e){var t=new Blob([e]);return URL.createObjectURL(t)}})}),tt=Qe(function(e){var t=new Oe(at);return qe(t.read(e),function(){return qe(t.extractThumbnail(),function(e){return e&&B?j.from(e):e})})}),nt={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},rt=y({},nt,{firstChunkSize:4e4,gps:[1,2,3,4]}),it=y({},nt,{firstChunkSize:4e4,ifd0:[274]}),at=y({},nt,{tiff:!1,ifd1:!0,mergeOutput:!1}),st={1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}};if(e.rotateCanvas=!0,e.rotateCss=!0,"object"==typeof navigator){var ut=navigator.userAgent;if(ut.includes("iPad")||ut.includes("iPhone")){var ot=ut.match(/OS (\d+)_(\d+)/);if(ot){ot[0];var ft=ot[1],ct=ot[2],ht=Number(ft)+.1*Number(ct);e.rotateCanvas=ht<13.4,e.rotateCss=!1}}if(ut.includes("Chrome/")){var lt=ut.match(/Chrome\/(\d+)/),dt=(lt[0],lt[1]);Number(dt)>=81&&(e.rotateCanvas=e.rotateCss=!1)}else if(ut.includes("Firefox/")){var vt=ut.match(/Firefox\/(\d+)/),pt=(vt[0],vt[1]);Number(pt)>=77&&(e.rotateCanvas=e.rotateCss=!1)}}function yt(){}var gt=function(e){function n(){var e,r;t(this,n);for(var a=arguments.length,u=new Array(a),o=0;o<a;o++)u[o]=arguments[o];return i(h(r=l(this,(e=s(n)).call.apply(e,[this].concat(u)))),"ranges",new kt),0!==r.byteLength&&r.ranges.add(0,r.byteLength),r}return a(n,e),r(n,[{key:"_tryExtend",value:function(e,t,n){if(0===e&&0===this.byteLength&&n){var r=new DataView(n.buffer||n,n.byteOffset,n.byteLength);this._swapDataView(r)}else{var i=e+t;if(i>this.byteLength){var a=this._extend(i).dataView;this._swapDataView(a)}}}},{key:"_extend",value:function(e){var t;t=B?j.allocUnsafe(e):new Uint8Array(e);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:n}}},{key:"subarray",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t=t||this._lengthToEnd(e),r&&this._tryExtend(e,t),this.ranges.add(e,t),d(s(n.prototype),"subarray",this).call(this,e,t)}},{key:"set",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r&&this._tryExtend(t,e.byteLength,e);var i=d(s(n.prototype),"set",this).call(this,e,t);return this.ranges.add(t,i.byteLength),i}},{key:"ensureChunk",value:function(e,t){try{if(!this.chunked)return;if(this.ranges.available(e,t))return;return function(e,t){if(!t)return e&&e.then?e.then(yt):Promise.resolve()}(this.readChunk(e,t))}catch(e){return Promise.reject(e)}}},{key:"available",value:function(e,t){return this.ranges.available(e,t)}}]),n}(F),kt=function(){function e(){t(this,e),i(this,"list",[])}return r(e,[{key:"add",value:function(e,t){var n=e+t,r=this.list.filter(function(t){return mt(e,t.offset,n)||mt(e,t.end,n)});if(r.length>0){e=Math.min.apply(Math,[e].concat(r.map(function(e){return e.offset}))),t=(n=Math.max.apply(Math,[n].concat(r.map(function(e){return e.end}))))-e;var i=r.shift();i.offset=e,i.length=t,i.end=n,this.list=this.list.filter(function(e){return!r.includes(e)})}else this.list.push({offset:e,length:t,end:n})}},{key:"available",value:function(e,t){var n=e+t;return this.list.some(function(t){return t.offset<=e&&n<=t.end})}},{key:"length",get:function(){return this.list.length}}]),e}();function mt(e,t,n){return e<=t&&t<=n}function bt(){}function At(e,t){if(!t)return e&&e.then?e.then(bt):Promise.resolve()}function wt(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var Ot=function(e){function n(){return t(this,n),l(this,s(n).apply(this,arguments))}return a(n,e),r(n,[{key:"readWhole",value:function(){try{var e=this;return e.chunked=!1,wt(H(e.input),function(t){e._swapArrayBuffer(t)})}catch(e){return Promise.reject(e)}}},{key:"readChunked",value:function(){return this.chunked=!0,this.size=this.input.size,d(s(n.prototype),"readChunked",this).call(this)}},{key:"_readChunk",value:function(e,t){try{var n=this,r=t?e+t:void 0,i=n.input.slice(e,r);return wt(H(i),function(t){return n.set(t,e,!0)})}catch(e){return Promise.reject(e)}}}]),n}(function(e){function n(e,r){var a;return t(this,n),i(h(a=l(this,s(n).call(this,0))),"chunksRead",0),a.input=e,a.options=r,a}return a(n,e),r(n,[{key:"readWhole",value:function(){try{return this.chunked=!1,At(this.readChunk(this.nextChunkOffset))}catch(e){return Promise.reject(e)}}},{key:"readChunked",value:function(){try{return this.chunked=!0,At(this.readChunk(0,this.options.firstChunkSize))}catch(e){return Promise.reject(e)}}},{key:"readNextChunk",value:function(e){try{if(void 0===e&&(e=this.nextChunkOffset),this.fullyRead)return this.chunksRead++,!1;var t=this.options.chunkSize;return n=this.readChunk(e,t),r=function(e){return!!e&&e.byteLength===t},i?r?r(n):n:(n&&n.then||(n=Promise.resolve(n)),r?n.then(r):n)}catch(e){return Promise.reject(e)}var n,r,i}},{key:"readChunk",value:function(e,t){try{if(this.chunksRead++,0===(t=this.safeWrapAddress(e,t)))return;return this._readChunk(e,t)}catch(e){return Promise.reject(e)}}},{key:"safeWrapAddress",value:function(e,t){return void 0!==this.size&&e+t>this.size?Math.max(0,this.size-e):t}},{key:"read",value:function(){return this.options.chunked?this.readChunked():this.readWhole()}},{key:"close",value:function(){}},{key:"nextChunkOffset",get:function(){if(0!==this.ranges.list.length)return this.ranges.list[0].length}},{key:"canReadNextChunk",get:function(){return this.chunksRead<this.options.chunkLimit}},{key:"fullyRead",get:function(){return void 0!==this.size&&this.nextChunkOffset===this.size}}]),n}(gt));N.set("blob",Ot),e.Exifr=Oe,e.Options=pe,e.allFormatters=ce,e.chunkedProps=re,e.createDictionary=Z,e.default=Je,e.disableAllOptions=nt,e.extendDictionary=$,e.fetchUrlAsArrayBuffer=X,e.fileParsers=R,e.fileReaders=N,e.gps=$e,e.gpsOnlyOptions=rt,e.inheritables=fe,e.orientation=Ze,e.orientationOnlyOptions=it,e.otherSegments=ie,e.parse=Se,e.readBlobAsArrayBuffer=H,e.rotation=function(t){return qe(Ze(t),function(t){return y({canvas:e.rotateCanvas,css:e.rotateCss},st[t])})},e.rotations=st,e.segmentParsers=M,e.segments=ae,e.segmentsAndBlocks=ue,e.tagKeys=ee,e.tagRevivers=ne,e.tagValues=te,e.thumbnail=tt,e.thumbnailOnlyOptions=at,e.thumbnailUrl=et,e.tiffBlocks=se,e.tiffExtractables=oe,Object.defineProperty(e,"__esModule",{value:!0})})}).call(this)}).call(this,require("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},require("buffer").Buffer)},{_process:4,buffer:2}],89:[function(require,module,exports){module.exports=function isShallowEqual(a,b){if(a===b)return true;for(var i in a)if(!(i in b))return false;for(var i in b)if(a[i]!==b[i])return false;return true}},{}],90:[function(require,module,exports){(function(global){(function(){var FUNC_ERROR_TEXT="Expected a function";var NAN=0/0;var symbolTag="[object Symbol]";var reTrim=/^\s+|\s+$/g;var reIsBadHex=/^[-+]0x[0-9a-f]+$/i;var reIsBinary=/^0b[01]+$/i;var reIsOctal=/^0o[0-7]+$/i;var freeParseInt=parseInt;var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global;var freeSelf=typeof self=="object"&&self&&self.Object===Object&&self;var root=freeGlobal||freeSelf||Function("return this")();var objectProto=Object.prototype;var objectToString=objectProto.toString;var nativeMax=Math.max,nativeMin=Math.min;var now=function(){return root.Date.now()};function debounce(func,wait,options){var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=false,maxing=false,trailing=true;if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}wait=toNumber(wait)||0;if(isObject(options)){leading=!!options.leading;maxing="maxWait"in options;maxWait=maxing?nativeMax(toNumber(options.maxWait)||0,wait):maxWait;trailing="trailing"in options?!!options.trailing:trailing}function invokeFunc(time){var args=lastArgs,thisArg=lastThis;lastArgs=lastThis=undefined;lastInvokeTime=time;result=func.apply(thisArg,args);return result}function leadingEdge(time){lastInvokeTime=time;timerId=setTimeout(timerExpired,wait);return leading?invokeFunc(time):result}function remainingWait(time){var timeSinceLastCall=time-lastCallTime,timeSinceLastInvoke=time-lastInvokeTime,result=wait-timeSinceLastCall;return maxing?nativeMin(result,maxWait-timeSinceLastInvoke):result}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime,timeSinceLastInvoke=time-lastInvokeTime;return lastCallTime===undefined||timeSinceLastCall>=wait||timeSinceLastCall<0||maxing&&timeSinceLastInvoke>=maxWait}function timerExpired(){var time=now();if(shouldInvoke(time)){return trailingEdge(time)}timerId=setTimeout(timerExpired,remainingWait(time))}function trailingEdge(time){timerId=undefined;if(trailing&&lastArgs){return invokeFunc(time)}lastArgs=lastThis=undefined;return result}function cancel(){if(timerId!==undefined){clearTimeout(timerId)}lastInvokeTime=0;lastArgs=lastCallTime=lastThis=timerId=undefined}function flush(){return timerId===undefined?result:trailingEdge(now())}function debounced(){var time=now(),isInvoking=shouldInvoke(time);lastArgs=arguments;lastThis=this;lastCallTime=time;if(isInvoking){if(timerId===undefined){return leadingEdge(lastCallTime)}if(maxing){timerId=setTimeout(timerExpired,wait);return invokeFunc(lastCallTime)}}if(timerId===undefined){timerId=setTimeout(timerExpired,wait)}return result}debounced.cancel=cancel;debounced.flush=flush;return debounced}function isObject(value){var type=typeof value;return!!value&&(type=="object"||type=="function")}function isObjectLike(value){return!!value&&typeof value=="object"}function isSymbol(value){return typeof value=="symbol"||isObjectLike(value)&&objectToString.call(value)==symbolTag}function toNumber(value){if(typeof value=="number"){return value}if(isSymbol(value)){return NAN}if(isObject(value)){var other=typeof value.valueOf=="function"?value.valueOf():value;value=isObject(other)?other+"":other}if(typeof value!="string"){return value===0?value:+value}value=value.replace(reTrim,"");var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NAN:+value}module.exports=debounce}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],91:[function(require,module,exports){(function(global){(function(){var FUNC_ERROR_TEXT="Expected a function";var NAN=0/0;var symbolTag="[object Symbol]";var reTrim=/^\s+|\s+$/g;var reIsBadHex=/^[-+]0x[0-9a-f]+$/i;var reIsBinary=/^0b[01]+$/i;var reIsOctal=/^0o[0-7]+$/i;var freeParseInt=parseInt;var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global;var freeSelf=typeof self=="object"&&self&&self.Object===Object&&self;var root=freeGlobal||freeSelf||Function("return this")();var objectProto=Object.prototype;var objectToString=objectProto.toString;var nativeMax=Math.max,nativeMin=Math.min;var now=function(){return root.Date.now()};function debounce(func,wait,options){var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=false,maxing=false,trailing=true;if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}wait=toNumber(wait)||0;if(isObject(options)){leading=!!options.leading;maxing="maxWait"in options;maxWait=maxing?nativeMax(toNumber(options.maxWait)||0,wait):maxWait;trailing="trailing"in options?!!options.trailing:trailing}function invokeFunc(time){var args=lastArgs,thisArg=lastThis;lastArgs=lastThis=undefined;lastInvokeTime=time;result=func.apply(thisArg,args);return result}function leadingEdge(time){lastInvokeTime=time;timerId=setTimeout(timerExpired,wait);return leading?invokeFunc(time):result}function remainingWait(time){var timeSinceLastCall=time-lastCallTime,timeSinceLastInvoke=time-lastInvokeTime,result=wait-timeSinceLastCall;return maxing?nativeMin(result,maxWait-timeSinceLastInvoke):result}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime,timeSinceLastInvoke=time-lastInvokeTime;return lastCallTime===undefined||timeSinceLastCall>=wait||timeSinceLastCall<0||maxing&&timeSinceLastInvoke>=maxWait}function timerExpired(){var time=now();if(shouldInvoke(time)){return trailingEdge(time)}timerId=setTimeout(timerExpired,remainingWait(time))}function trailingEdge(time){timerId=undefined;if(trailing&&lastArgs){return invokeFunc(time)}lastArgs=lastThis=undefined;return result}function cancel(){if(timerId!==undefined){clearTimeout(timerId)}lastInvokeTime=0;lastArgs=lastCallTime=lastThis=timerId=undefined}function flush(){return timerId===undefined?result:trailingEdge(now())}function debounced(){var time=now(),isInvoking=shouldInvoke(time);lastArgs=arguments;lastThis=this;lastCallTime=time;if(isInvoking){if(timerId===undefined){return leadingEdge(lastCallTime)}if(maxing){timerId=setTimeout(timerExpired,wait);return invokeFunc(lastCallTime)}}if(timerId===undefined){timerId=setTimeout(timerExpired,wait)}return result}debounced.cancel=cancel;debounced.flush=flush;return debounced}function throttle(func,wait,options){var leading=true,trailing=true;if(typeof func!="function"){throw new TypeError(FUNC_ERROR_TEXT)}if(isObject(options)){leading="leading"in options?!!options.leading:leading;trailing="trailing"in options?!!options.trailing:trailing}return debounce(func,wait,{leading:leading,maxWait:wait,trailing:trailing})}function isObject(value){var type=typeof value;return!!value&&(type=="object"||type=="function")}function isObjectLike(value){return!!value&&typeof value=="object"}function isSymbol(value){return typeof value=="symbol"||isObjectLike(value)&&objectToString.call(value)==symbolTag}function toNumber(value){if(typeof value=="number"){return value}if(isSymbol(value)){return NAN}if(isObject(value)){var other=typeof value.valueOf=="function"?value.valueOf():value;value=isObject(other)?other+"":other}if(typeof value!="string"){return value===0?value:+value}value=value.replace(reTrim,"");var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NAN:+value}module.exports=throttle}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],92:[function(require,module,exports){"use strict";module.exports=Math.log2||function(x){return Math.log(x)*Math.LOG2E}},{}],93:[function(require,module,exports){"use strict";function areInputsEqual(newInputs,lastInputs){if(newInputs.length!==lastInputs.length){return false}for(var i=0;i<newInputs.length;i++){if(newInputs[i]!==lastInputs[i]){return false}}return true}function memoizeOne(resultFn,isEqual){if(isEqual===void 0){isEqual=areInputsEqual}var lastThis;var lastArgs=[];var lastResult;var calledOnce=false;function memoized(){var newArgs=[];for(var _i=0;_i<arguments.length;_i++){newArgs[_i]=arguments[_i]}if(calledOnce&&lastThis===this&&isEqual(newArgs,lastArgs)){return lastResult}lastResult=resultFn.apply(this,newArgs);calledOnce=true;lastThis=this;lastArgs=newArgs;return lastResult}return memoized}module.exports=memoizeOne},{}],94:[function(require,module,exports){var wildcard=require("wildcard");var reMimePartSplit=/[\/\+\.]/;module.exports=function(target,pattern){function test(pattern){var result=wildcard(pattern,target,reMimePartSplit);return result&&result.length>=2}return pattern?test(pattern.split(";")[0]):test}},{wildcard:98}],95:[function(require,module,exports){module.exports=function createNamespaceEmitter(){var emitter={};var _fns=emitter._fns={};emitter.emit=function emit(event,arg1,arg2,arg3,arg4,arg5,arg6){var toEmit=getListeners(event);if(toEmit.length){emitAll(event,toEmit,[arg1,arg2,arg3,arg4,arg5,arg6])}};emitter.on=function on(event,fn){if(!_fns[event]){_fns[event]=[]}_fns[event].push(fn)};emitter.once=function once(event,fn){function one(){fn.apply(this,arguments);emitter.off(event,one)}this.on(event,one)};emitter.off=function off(event,fn){var keep=[];if(event&&fn){var fns=this._fns[event];var i=0;var l=fns?fns.length:0;for(i;i<l;i++){if(fns[i]!==fn){keep.push(fns[i])}}}keep.length?this._fns[event]=keep:delete this._fns[event]};function getListeners(e){var out=_fns[e]?_fns[e]:[];var idx=e.indexOf(":");var args=idx===-1?[e]:[e.substring(0,idx),e.substring(idx+1)];var keys=Object.keys(_fns);var i=0;var l=keys.length;for(i;i<l;i++){var key=keys[i];if(key==="*"){out=out.concat(_fns[key])}if(args.length===2&&args[0]===key){out=out.concat(_fns[key]);break}}return out}function emitAll(e,fns,args){var i=0;var l=fns.length;for(i;i<l;i++){if(!fns[i])break;fns[i].event=e;fns[i].apply(fns[i],args)}}return emitter}},{}],96:[function(require,module,exports){!function(){"use strict";function VNode(){}function h(nodeName,attributes){var lastSimple,child,simple,i,children=EMPTY_CHILDREN;for(i=arguments.length;i-- >2;)stack.push(arguments[i]);if(attributes&&null!=attributes.children){if(!stack.length)stack.push(attributes.children);delete attributes.children}while(stack.length)if((child=stack.pop())&&void 0!==child.pop)for(i=child.length;i--;)stack.push(child[i]);else{if("boolean"==typeof child)child=null;if(simple="function"!=typeof nodeName)if(null==child)child="";else if("number"==typeof child)child=String(child);else if("string"!=typeof child)simple=!1;if(simple&&lastSimple)children[children.length-1]+=child;else if(children===EMPTY_CHILDREN)children=[child];else children.push(child);lastSimple=simple}var p=new VNode;p.nodeName=nodeName;p.children=children;p.attributes=null==attributes?void 0:attributes;p.key=null==attributes?void 0:attributes.key;if(void 0!==options.vnode)options.vnode(p);return p}function extend(obj,props){for(var i in props)obj[i]=props[i];return obj}function cloneElement(vnode,props){return h(vnode.nodeName,extend(extend({},vnode.attributes),props),arguments.length>2?[].slice.call(arguments,2):vnode.children)}function enqueueRender(component){if(!component.__d&&(component.__d=!0)&&1==items.push(component))(options.debounceRendering||defer)(rerender)}function rerender(){var p,list=items;items=[];while(p=list.pop())if(p.__d)renderComponent(p)}function isSameNodeType(node,vnode,hydrating){if("string"==typeof vnode||"number"==typeof vnode)return void 0!==node.splitText;if("string"==typeof vnode.nodeName)return!node._componentConstructor&&isNamedNode(node,vnode.nodeName);else return hydrating||node._componentConstructor===vnode.nodeName}function isNamedNode(node,nodeName){return node.__n===nodeName||node.nodeName.toLowerCase()===nodeName.toLowerCase()}function getNodeProps(vnode){var props=extend({},vnode.attributes);props.children=vnode.children;var defaultProps=vnode.nodeName.defaultProps;if(void 0!==defaultProps)for(var i in defaultProps)if(void 0===props[i])props[i]=defaultProps[i];return props}function createNode(nodeName,isSvg){var node=isSvg?document.createElementNS("http://www.w3.org/2000/svg",nodeName):document.createElement(nodeName);node.__n=nodeName;return node}function removeNode(node){var parentNode=node.parentNode;if(parentNode)parentNode.removeChild(node)}function setAccessor(node,name,old,value,isSvg){if("className"===name)name="class";if("key"===name);else if("ref"===name){if(old)old(null);if(value)value(node)}else if("class"===name&&!isSvg)node.className=value||"";else if("style"===name){if(!value||"string"==typeof value||"string"==typeof old)node.style.cssText=value||"";if(value&&"object"==typeof value){if("string"!=typeof old)for(var i in old)if(!(i in value))node.style[i]="";for(var i in value)node.style[i]="number"==typeof value[i]&&!1===IS_NON_DIMENSIONAL.test(i)?value[i]+"px":value[i]}}else if("dangerouslySetInnerHTML"===name){if(value)node.innerHTML=value.__html||""}else if("o"==name[0]&&"n"==name[1]){var useCapture=name!==(name=name.replace(/Capture$/,""));name=name.toLowerCase().substring(2);if(value){if(!old)node.addEventListener(name,eventProxy,useCapture)}else node.removeEventListener(name,eventProxy,useCapture);(node.__l||(node.__l={}))[name]=value}else if("list"!==name&&"type"!==name&&!isSvg&&name in node){setProperty(node,name,null==value?"":value);if(null==value||!1===value)node.removeAttribute(name)}else{var ns=isSvg&&name!==(name=name.replace(/^xlink:?/,""));if(null==value||!1===value)if(ns)node.removeAttributeNS("http://www.w3.org/1999/xlink",name.toLowerCase());else node.removeAttribute(name);else if("function"!=typeof value)if(ns)node.setAttributeNS("http://www.w3.org/1999/xlink",name.toLowerCase(),value);else node.setAttribute(name,value)}}function setProperty(node,name,value){try{node[name]=value}catch(e){}}function eventProxy(e){return this.__l[e.type](options.event&&options.event(e)||e)}function flushMounts(){var c;while(c=mounts.pop()){if(options.afterMount)options.afterMount(c);if(c.componentDidMount)c.componentDidMount()}}function diff(dom,vnode,context,mountAll,parent,componentRoot){if(!diffLevel++){isSvgMode=null!=parent&&void 0!==parent.ownerSVGElement;hydrating=null!=dom&&!("__preactattr_"in dom)}var ret=idiff(dom,vnode,context,mountAll,componentRoot);if(parent&&ret.parentNode!==parent)parent.appendChild(ret);if(!--diffLevel){hydrating=!1;if(!componentRoot)flushMounts()}return ret}function idiff(dom,vnode,context,mountAll,componentRoot){var out=dom,prevSvgMode=isSvgMode;if(null==vnode||"boolean"==typeof vnode)vnode="";if("string"==typeof vnode||"number"==typeof vnode){if(dom&&void 0!==dom.splitText&&dom.parentNode&&(!dom._component||componentRoot)){if(dom.nodeValue!=vnode)dom.nodeValue=vnode}else{out=document.createTextNode(vnode);if(dom){if(dom.parentNode)dom.parentNode.replaceChild(out,dom);recollectNodeTree(dom,!0)}}out.__preactattr_=!0;return out}var vnodeName=vnode.nodeName;if("function"==typeof vnodeName)return buildComponentFromVNode(dom,vnode,context,mountAll);isSvgMode="svg"===vnodeName?!0:"foreignObject"===vnodeName?!1:isSvgMode;vnodeName=String(vnodeName);if(!dom||!isNamedNode(dom,vnodeName)){out=createNode(vnodeName,isSvgMode);if(dom){while(dom.firstChild)out.appendChild(dom.firstChild);if(dom.parentNode)dom.parentNode.replaceChild(out,dom);recollectNodeTree(dom,!0)}}var fc=out.firstChild,props=out.__preactattr_,vchildren=vnode.children;if(null==props){props=out.__preactattr_={};for(var a=out.attributes,i=a.length;i--;)props[a[i].name]=a[i].value}if(!hydrating&&vchildren&&1===vchildren.length&&"string"==typeof vchildren[0]&&null!=fc&&void 0!==fc.splitText&&null==fc.nextSibling){if(fc.nodeValue!=vchildren[0])fc.nodeValue=vchildren[0]}else if(vchildren&&vchildren.length||null!=fc)innerDiffNode(out,vchildren,context,mountAll,hydrating||null!=props.dangerouslySetInnerHTML);diffAttributes(out,vnode.attributes,props);isSvgMode=prevSvgMode;return out}function innerDiffNode(dom,vchildren,context,mountAll,isHydrating){var j,c,f,vchild,child,originalChildren=dom.childNodes,children=[],keyed={},keyedLen=0,min=0,len=originalChildren.length,childrenLen=0,vlen=vchildren?vchildren.length:0;if(0!==len)for(var i=0;i<len;i++){var _child=originalChildren[i],props=_child.__preactattr_,key=vlen&&props?_child._component?_child._component.__k:props.key:null;if(null!=key){keyedLen++;keyed[key]=_child}else if(props||(void 0!==_child.splitText?isHydrating?_child.nodeValue.trim():!0:isHydrating))children[childrenLen++]=_child}if(0!==vlen)for(var i=0;i<vlen;i++){vchild=vchildren[i];child=null;var key=vchild.key;if(null!=key){if(keyedLen&&void 0!==keyed[key]){child=keyed[key];keyed[key]=void 0;keyedLen--}}else if(!child&&min<childrenLen)for(j=min;j<childrenLen;j++)if(void 0!==children[j]&&isSameNodeType(c=children[j],vchild,isHydrating)){child=c;children[j]=void 0;if(j===childrenLen-1)childrenLen--;if(j===min)min++;break}child=idiff(child,vchild,context,mountAll);f=originalChildren[i];if(child&&child!==dom&&child!==f)if(null==f)dom.appendChild(child);else if(child===f.nextSibling)removeNode(f);else dom.insertBefore(child,f)}if(keyedLen)for(var i in keyed)if(void 0!==keyed[i])recollectNodeTree(keyed[i],!1);while(min<=childrenLen)if(void 0!==(child=children[childrenLen--]))recollectNodeTree(child,!1)}function recollectNodeTree(node,unmountOnly){var component=node._component;if(component)unmountComponent(component);else{if(null!=node.__preactattr_&&node.__preactattr_.ref)node.__preactattr_.ref(null);if(!1===unmountOnly||null==node.__preactattr_)removeNode(node);removeChildren(node)}}function removeChildren(node){node=node.lastChild;while(node){var next=node.previousSibling;recollectNodeTree(node,!0);node=next}}function diffAttributes(dom,attrs,old){var name;for(name in old)if((!attrs||null==attrs[name])&&null!=old[name])setAccessor(dom,name,old[name],old[name]=void 0,isSvgMode);for(name in attrs)if(!("children"===name||"innerHTML"===name||name in old&&attrs[name]===("value"===name||"checked"===name?dom[name]:old[name])))setAccessor(dom,name,old[name],old[name]=attrs[name],isSvgMode)}function collectComponent(component){var name=component.constructor.name;(components[name]||(components[name]=[])).push(component)}function createComponent(Ctor,props,context){var inst,list=components[Ctor.name];if(Ctor.prototype&&Ctor.prototype.render){inst=new Ctor(props,context);Component.call(inst,props,context)}else{inst=new Component(props,context);inst.constructor=Ctor;inst.render=doRender}if(list)for(var i=list.length;i--;)if(list[i].constructor===Ctor){inst.__b=list[i].__b;list.splice(i,1);break}return inst}function doRender(props,state,context){return this.constructor(props,context)}function setComponentProps(component,props,opts,context,mountAll){if(!component.__x){component.__x=!0;if(component.__r=props.ref)delete props.ref;if(component.__k=props.key)delete props.key;if(!component.base||mountAll){if(component.componentWillMount)component.componentWillMount()}else if(component.componentWillReceiveProps)component.componentWillReceiveProps(props,context);if(context&&context!==component.context){if(!component.__c)component.__c=component.context;component.context=context}if(!component.__p)component.__p=component.props;component.props=props;component.__x=!1;if(0!==opts)if(1===opts||!1!==options.syncComponentUpdates||!component.base)renderComponent(component,1,mountAll);else enqueueRender(component);if(component.__r)component.__r(component)}}function renderComponent(component,opts,mountAll,isChild){if(!component.__x){var rendered,inst,cbase,props=component.props,state=component.state,context=component.context,previousProps=component.__p||props,previousState=component.__s||state,previousContext=component.__c||context,isUpdate=component.base,nextBase=component.__b,initialBase=isUpdate||nextBase,initialChildComponent=component._component,skip=!1;if(isUpdate){component.props=previousProps;component.state=previousState;component.context=previousContext;if(2!==opts&&component.shouldComponentUpdate&&!1===component.shouldComponentUpdate(props,state,context))skip=!0;else if(component.componentWillUpdate)component.componentWillUpdate(props,state,context);component.props=props;component.state=state;component.context=context}component.__p=component.__s=component.__c=component.__b=null;component.__d=!1;if(!skip){rendered=component.render(props,state,context);if(component.getChildContext)context=extend(extend({},context),component.getChildContext());var toUnmount,base,childComponent=rendered&&rendered.nodeName;if("function"==typeof childComponent){var childProps=getNodeProps(rendered);inst=initialChildComponent;if(inst&&inst.constructor===childComponent&&childProps.key==inst.__k)setComponentProps(inst,childProps,1,context,!1);else{toUnmount=inst;component._component=inst=createComponent(childComponent,childProps,context);inst.__b=inst.__b||nextBase;inst.__u=component;setComponentProps(inst,childProps,0,context,!1);renderComponent(inst,1,mountAll,!0)}base=inst.base}else{cbase=initialBase;toUnmount=initialChildComponent;if(toUnmount)cbase=component._component=null;if(initialBase||1===opts){if(cbase)cbase._component=null;base=diff(cbase,rendered,context,mountAll||!isUpdate,initialBase&&initialBase.parentNode,!0)}}if(initialBase&&base!==initialBase&&inst!==initialChildComponent){var baseParent=initialBase.parentNode;if(baseParent&&base!==baseParent){baseParent.replaceChild(base,initialBase);if(!toUnmount){initialBase._component=null;recollectNodeTree(initialBase,!1)}}}if(toUnmount)unmountComponent(toUnmount);component.base=base;if(base&&!isChild){var componentRef=component,t=component;while(t=t.__u)(componentRef=t).base=base;base._component=componentRef;base._componentConstructor=componentRef.constructor}}if(!isUpdate||mountAll)mounts.unshift(component);else if(!skip){if(component.componentDidUpdate)component.componentDidUpdate(previousProps,previousState,previousContext);if(options.afterUpdate)options.afterUpdate(component)}if(null!=component.__h)while(component.__h.length)component.__h.pop().call(component);if(!diffLevel&&!isChild)flushMounts()}}function buildComponentFromVNode(dom,vnode,context,mountAll){var c=dom&&dom._component,originalComponent=c,oldDom=dom,isDirectOwner=c&&dom._componentConstructor===vnode.nodeName,isOwner=isDirectOwner,props=getNodeProps(vnode);while(c&&!isOwner&&(c=c.__u))isOwner=c.constructor===vnode.nodeName;if(c&&isOwner&&(!mountAll||c._component)){setComponentProps(c,props,3,context,mountAll);dom=c.base}else{if(originalComponent&&!isDirectOwner){unmountComponent(originalComponent);dom=oldDom=null}c=createComponent(vnode.nodeName,props,context);if(dom&&!c.__b){c.__b=dom;oldDom=null}setComponentProps(c,props,1,context,mountAll);dom=c.base;if(oldDom&&dom!==oldDom){oldDom._component=null;recollectNodeTree(oldDom,!1)}}return dom}function unmountComponent(component){if(options.beforeUnmount)options.beforeUnmount(component);var base=component.base;component.__x=!0;if(component.componentWillUnmount)component.componentWillUnmount();component.base=null;var inner=component._component;if(inner)unmountComponent(inner);else if(base){if(base.__preactattr_&&base.__preactattr_.ref)base.__preactattr_.ref(null);component.__b=base;removeNode(base);collectComponent(component);removeChildren(base)}if(component.__r)component.__r(null)}function Component(props,context){this.__d=!0;this.context=context;this.props=props;this.state=this.state||{}}function render(vnode,parent,merge){return diff(merge,vnode,{},!1,parent,!1)}var options={};var stack=[];var EMPTY_CHILDREN=[];var defer="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;var IS_NON_DIMENSIONAL=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i;var items=[];var mounts=[];var diffLevel=0;var isSvgMode=!1;var hydrating=!1;var components={};extend(Component.prototype,{setState:function(state,callback){var s=this.state;if(!this.__s)this.__s=extend({},s);extend(s,"function"==typeof state?state(s,this.props):state);if(callback)(this.__h=this.__h||[]).push(callback);enqueueRender(this)},forceUpdate:function(callback){if(callback)(this.__h=this.__h||[]).push(callback);renderComponent(this,2)},render:function(){}});var preact={h:h,createElement:h,cloneElement:cloneElement,Component:Component,render:render,rerender:rerender,options:options};if("undefined"!=typeof module)module.exports=preact;else self.preact=preact}()},{}],97:[function(require,module,exports){(function(global){(function(){(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):global.ResizeObserver=factory()})(this,function(){"use strict";var MapShim=function(){if(typeof Map!=="undefined"){return Map}function getIndex(arr,key){var result=-1;arr.some(function(entry,index){if(entry[0]===key){result=index;return true}return false});return result}return function(){function class_1(){this.__entries__=[]}Object.defineProperty(class_1.prototype,"size",{get:function(){return this.__entries__.length},enumerable:true,configurable:true});class_1.prototype.get=function(key){var index=getIndex(this.__entries__,key);var entry=this.__entries__[index];return entry&&entry[1]};class_1.prototype.set=function(key,value){var index=getIndex(this.__entries__,key);if(~index){this.__entries__[index][1]=value}else{this.__entries__.push([key,value])}};class_1.prototype.delete=function(key){var entries=this.__entries__;var index=getIndex(entries,key);if(~index){entries.splice(index,1)}};class_1.prototype.has=function(key){return!!~getIndex(this.__entries__,key)};class_1.prototype.clear=function(){this.__entries__.splice(0)};class_1.prototype.forEach=function(callback,ctx){if(ctx===void 0){ctx=null}for(var _i=0,_a=this.__entries__;_i<_a.length;_i++){var entry=_a[_i];callback.call(ctx,entry[1],entry[0])}};return class_1}()}();var isBrowser=typeof window!=="undefined"&&typeof document!=="undefined"&&window.document===document;var global$1=function(){if(typeof global!=="undefined"&&global.Math===Math){return global}if(typeof self!=="undefined"&&self.Math===Math){return self}if(typeof window!=="undefined"&&window.Math===Math){return window}return Function("return this")()}();var requestAnimationFrame$1=function(){if(typeof requestAnimationFrame==="function"){return requestAnimationFrame.bind(global$1)}return function(callback){return setTimeout(function(){return callback(Date.now())},1e3/60)}}();var trailingTimeout=2;function throttle(callback,delay){var leadingCall=false,trailingCall=false,lastCallTime=0;function resolvePending(){if(leadingCall){leadingCall=false;callback()}if(trailingCall){proxy()}}function timeoutCallback(){requestAnimationFrame$1(resolvePending)}function proxy(){var timeStamp=Date.now();if(leadingCall){if(timeStamp-lastCallTime<trailingTimeout){return}trailingCall=true}else{leadingCall=true;trailingCall=false;setTimeout(timeoutCallback,delay)}lastCallTime=timeStamp}return proxy}var REFRESH_DELAY=20;var transitionKeys=["top","right","bottom","left","width","height","size","weight"];var mutationObserverSupported=typeof MutationObserver!=="undefined";var ResizeObserverController=function(){function ResizeObserverController(){this.connected_=false;this.mutationEventsAdded_=false;this.mutationsObserver_=null;this.observers_=[];this.onTransitionEnd_=this.onTransitionEnd_.bind(this);this.refresh=throttle(this.refresh.bind(this),REFRESH_DELAY)}ResizeObserverController.prototype.addObserver=function(observer){if(!~this.observers_.indexOf(observer)){this.observers_.push(observer)}if(!this.connected_){this.connect_()}};ResizeObserverController.prototype.removeObserver=function(observer){var observers=this.observers_;var index=observers.indexOf(observer);if(~index){observers.splice(index,1)}if(!observers.length&&this.connected_){this.disconnect_()}};ResizeObserverController.prototype.refresh=function(){var changesDetected=this.updateObservers_();if(changesDetected){this.refresh()}};ResizeObserverController.prototype.updateObservers_=function(){var activeObservers=this.observers_.filter(function(observer){return observer.gatherActive(),observer.hasActive()});activeObservers.forEach(function(observer){return observer.broadcastActive()});return activeObservers.length>0};ResizeObserverController.prototype.connect_=function(){if(!isBrowser||this.connected_){return}document.addEventListener("transitionend",this.onTransitionEnd_);window.addEventListener("resize",this.refresh);if(mutationObserverSupported){this.mutationsObserver_=new MutationObserver(this.refresh);this.mutationsObserver_.observe(document,{attributes:true,childList:true,characterData:true,subtree:true})}else{document.addEventListener("DOMSubtreeModified",this.refresh);this.mutationEventsAdded_=true}this.connected_=true};ResizeObserverController.prototype.disconnect_=function(){if(!isBrowser||!this.connected_){return}document.removeEventListener("transitionend",this.onTransitionEnd_);window.removeEventListener("resize",this.refresh);if(this.mutationsObserver_){this.mutationsObserver_.disconnect()}if(this.mutationEventsAdded_){document.removeEventListener("DOMSubtreeModified",this.refresh)}this.mutationsObserver_=null;this.mutationEventsAdded_=false;this.connected_=false};ResizeObserverController.prototype.onTransitionEnd_=function(_a){var _b=_a.propertyName,propertyName=_b===void 0?"":_b;var isReflowProperty=transitionKeys.some(function(key){return!!~propertyName.indexOf(key)});if(isReflowProperty){this.refresh()}};ResizeObserverController.getInstance=function(){if(!this.instance_){this.instance_=new ResizeObserverController}return this.instance_};ResizeObserverController.instance_=null;return ResizeObserverController}();var defineConfigurable=function(target,props){for(var _i=0,_a=Object.keys(props);_i<_a.length;_i++){var key=_a[_i];Object.defineProperty(target,key,{value:props[key],enumerable:false,writable:false,configurable:true})}return target};var getWindowOf=function(target){var ownerGlobal=target&&target.ownerDocument&&target.ownerDocument.defaultView;return ownerGlobal||global$1};var emptyRect=createRectInit(0,0,0,0);function toFloat(value){return parseFloat(value)||0}function getBordersSize(styles){var positions=[];for(var _i=1;_i<arguments.length;_i++){positions[_i-1]=arguments[_i]}return positions.reduce(function(size,position){var value=styles["border-"+position+"-width"];return size+toFloat(value)},0)}function getPaddings(styles){var positions=["top","right","bottom","left"];var paddings={};for(var _i=0,positions_1=positions;_i<positions_1.length;_i++){var position=positions_1[_i];var value=styles["padding-"+position];paddings[position]=toFloat(value)}return paddings}function getSVGContentRect(target){var bbox=target.getBBox();return createRectInit(0,0,bbox.width,bbox.height)}function getHTMLElementContentRect(target){var clientWidth=target.clientWidth,clientHeight=target.clientHeight;if(!clientWidth&&!clientHeight){return emptyRect}var styles=getWindowOf(target).getComputedStyle(target);var paddings=getPaddings(styles);var horizPad=paddings.left+paddings.right;var vertPad=paddings.top+paddings.bottom;var width=toFloat(styles.width),height=toFloat(styles.height);if(styles.boxSizing==="border-box"){if(Math.round(width+horizPad)!==clientWidth){width-=getBordersSize(styles,"left","right")+horizPad}if(Math.round(height+vertPad)!==clientHeight){height-=getBordersSize(styles,"top","bottom")+vertPad}}if(!isDocumentElement(target)){var vertScrollbar=Math.round(width+horizPad)-clientWidth;var horizScrollbar=Math.round(height+vertPad)-clientHeight;if(Math.abs(vertScrollbar)!==1){width-=vertScrollbar}if(Math.abs(horizScrollbar)!==1){height-=horizScrollbar}}return createRectInit(paddings.left,paddings.top,width,height)}var isSVGGraphicsElement=function(){if(typeof SVGGraphicsElement!=="undefined"){return function(target){return target instanceof getWindowOf(target).SVGGraphicsElement}}return function(target){return target instanceof getWindowOf(target).SVGElement&&typeof target.getBBox==="function"}}();function isDocumentElement(target){return target===getWindowOf(target).document.documentElement}function getContentRect(target){if(!isBrowser){return emptyRect}if(isSVGGraphicsElement(target)){return getSVGContentRect(target)}return getHTMLElementContentRect(target)}function createReadOnlyRect(_a){var x=_a.x,y=_a.y,width=_a.width,height=_a.height;var Constr=typeof DOMRectReadOnly!=="undefined"?DOMRectReadOnly:Object;var rect=Object.create(Constr.prototype);defineConfigurable(rect,{x:x,y:y,width:width,height:height,top:y,right:x+width,bottom:height+y,left:x});return rect}function createRectInit(x,y,width,height){return{x:x,y:y,width:width,height:height}}var ResizeObservation=function(){function ResizeObservation(target){this.broadcastWidth=0;this.broadcastHeight=0;this.contentRect_=createRectInit(0,0,0,0);this.target=target}ResizeObservation.prototype.isActive=function(){var rect=getContentRect(this.target);this.contentRect_=rect;return rect.width!==this.broadcastWidth||rect.height!==this.broadcastHeight};ResizeObservation.prototype.broadcastRect=function(){var rect=this.contentRect_;this.broadcastWidth=rect.width;this.broadcastHeight=rect.height;return rect};return ResizeObservation}();var ResizeObserverEntry=function(){function ResizeObserverEntry(target,rectInit){var contentRect=createReadOnlyRect(rectInit);defineConfigurable(this,{target:target,contentRect:contentRect})}return ResizeObserverEntry}();var ResizeObserverSPI=function(){function ResizeObserverSPI(callback,controller,callbackCtx){this.activeObservations_=[];this.observations_=new MapShim;if(typeof callback!=="function"){throw new TypeError("The callback provided as parameter 1 is not a function.")}this.callback_=callback;this.controller_=controller;this.callbackCtx_=callbackCtx}ResizeObserverSPI.prototype.observe=function(target){if(!arguments.length){throw new TypeError("1 argument required, but only 0 present.")}if(typeof Element==="undefined"||!(Element instanceof Object)){return}if(!(target instanceof getWindowOf(target).Element)){throw new TypeError('parameter 1 is not of type "Element".')}var observations=this.observations_;if(observations.has(target)){return}observations.set(target,new ResizeObservation(target));this.controller_.addObserver(this);this.controller_.refresh()};ResizeObserverSPI.prototype.unobserve=function(target){if(!arguments.length){throw new TypeError("1 argument required, but only 0 present.")}if(typeof Element==="undefined"||!(Element instanceof Object)){return}if(!(target instanceof getWindowOf(target).Element)){throw new TypeError('parameter 1 is not of type "Element".')}var observations=this.observations_;if(!observations.has(target)){return}observations.delete(target);if(!observations.size){this.controller_.removeObserver(this)}};ResizeObserverSPI.prototype.disconnect=function(){this.clearActive();this.observations_.clear();this.controller_.removeObserver(this)};ResizeObserverSPI.prototype.gatherActive=function(){var _this=this;this.clearActive();this.observations_.forEach(function(observation){if(observation.isActive()){_this.activeObservations_.push(observation)}})};ResizeObserverSPI.prototype.broadcastActive=function(){if(!this.hasActive()){return}var ctx=this.callbackCtx_;var entries=this.activeObservations_.map(function(observation){return new ResizeObserverEntry(observation.target,observation.broadcastRect())});this.callback_.call(ctx,entries,ctx);this.clearActive()};ResizeObserverSPI.prototype.clearActive=function(){this.activeObservations_.splice(0)};ResizeObserverSPI.prototype.hasActive=function(){return this.activeObservations_.length>0};return ResizeObserverSPI}();var observers=typeof WeakMap!=="undefined"?new WeakMap:new MapShim;var ResizeObserver=function(){function ResizeObserver(callback){if(!(this instanceof ResizeObserver)){throw new TypeError("Cannot call a class as a function.")}if(!arguments.length){throw new TypeError("1 argument required, but only 0 present.")}var controller=ResizeObserverController.getInstance();var observer=new ResizeObserverSPI(callback,controller,this);observers.set(this,observer)}return ResizeObserver}();["observe","unobserve","disconnect"].forEach(function(method){ResizeObserver.prototype[method]=function(){var _a;return(_a=observers.get(this))[method].apply(_a,arguments)}});var index=function(){if(typeof global$1.ResizeObserver!=="undefined"){return global$1.ResizeObserver}return ResizeObserver}();return index})}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],98:[function(require,module,exports){"use strict";function WildcardMatcher(text,separator){this.text=text=text||"";this.hasWild=~text.indexOf("*");this.separator=separator;this.parts=text.split(separator)}WildcardMatcher.prototype.match=function(input){var matches=true;var parts=this.parts;var ii;var partsCount=parts.length;var testParts;if(typeof input=="string"||input instanceof String){if(!this.hasWild&&this.text!=input){matches=false}else{testParts=(input||"").split(this.separator);for(ii=0;matches&&ii<partsCount;ii++){if(parts[ii]==="*"){continue}else if(ii<testParts.length){matches=parts[ii]===testParts[ii]}else{matches=false}}matches=matches&&testParts}}else if(typeof input.splice=="function"){matches=[];for(ii=input.length;ii--;){if(this.match(input[ii])){matches[matches.length]=input[ii]}}}else if(typeof input=="object"){matches={};for(var key in input){if(this.match(key)){matches[key]=input[key]}}}return matches};module.exports=function(text,test,separator){var matcher=new WildcardMatcher(text,separator||/[\/\.]/);if(typeof test!="undefined"){return matcher.match(test)}return matcher}},{}]},{},[5]);
